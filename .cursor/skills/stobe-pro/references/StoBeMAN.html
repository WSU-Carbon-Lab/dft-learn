<html><head>
<title> StoBe2014 Manual, Table of Contents</title>
</head>
<body bgcolor="white">
<pre>
<a name="top"><h5>Manual update as of 5/30/2014 5:10PM</h5></a>
(Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)



<h3>DOCUMENTATION FOR  StoBe2014  (Version 3.3)</h3>

            K. Hermann (Fritz-Haber-Institut der MPG, Berlin, Germany)
            L. G. M. Pettersson (University of Stockholm, Stockholm, Sweden)




 This manual is prepared by Klaus Hermann and Lars G.M. Pettersson using
 an original version prepared by Mark E. Casida, Annick Goursot, Emil
 Proynov, and Alain St-Amant. For questions and comments contact

   Klaus Hermann  (hermann@fhi-berlin.mpg.de)
   Lars G.M. Pettersson  (lgm@physto.se)



The following header is included at the beginning of each StoBe output :

*******************************************************************************
 StoBe-deMon SOFTWARE
 Stockholm-Berlin version 3.3 of deMon  (StoBe2014 dated May 2014)
 Copyright 1996-2014 by the authors.
 All rights reserved.
*******************************************************************************

 The deMon software is based on programs originally written under the direction
 of Professor Dennis R. Salahub of the University of Montreal.
 The codes are being developed and extended through an international
 collaborative effort.

 CITE THIS PROGRAM AS:
     StoBe-deMon version 3.3 (2014), K. Hermann and L.G.M. Pettersson,
     M.E. Casida, C. Daul, A. Goursot, A. Koester, E. Proynov,
     A. St-Amant, and D.R. Salahub. Contributing authors:
     V. Carravetta, H. Duarte, C. Friedrich, N. Godbout, M. Gruber, J. Guan,
     C. Jamorski, M. Leboeuf, M. Leetmaa, M. Nyberg, S. Patchkovskii,
     L. Pedocchi, F. Sim, L. Triguero, and A. Vela.
*******************************************************************************
*******************************************************************************






<a name="toc">(Goto</a> <a href="#top">TOP</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

<h3>TABLE OF CONTENTS</h3>

<a href="#1.">1.</a>     Introduction and general description
<a href="#1.1.">1.1.</a>     Some history
<a href="#2.">2.</a>     Users guide
<a href="#2.1.">2.1.</a>     Introduction
<a href="#2.1.1.">2.1.1.</a>      Tables of keywords
<a href="#2.1.1.1.">2.1.1.1.</a>       Logical grouping
<a href="#2.1.1.2.">2.1.1.2.</a>       Alphabetic order
<a href="#2.2.">2.2.</a>     Detailed description of keywords
<a href="#2.2.1.">2.2.1.</a>      Keywords for geometry basics
<a href="#2.2.2.">2.2.2.</a>      Keywords for electronic states
<a href="#2.2.3.">2.2.3.</a>      Keywords for scf iteration part
<a href="#2.2.4.">2.2.4.</a>      Keywords for geometry optimization
<a href="#2.2.5.">2.2.5.</a>      Keywords for properties
<a href="#2.2.6.">2.2.6.</a>      Miscellaneous keywords
<a href="#2.2.7.">2.2.7.</a>      Untested / obsolete keywords
<a href="#2.3.">2.3.</a>     Basis set input
<a href="#2.3.1.">2.3.1.</a>      Global basis set definitions
<a href="#2.4.">2.4.</a>     Symmetry basis set input
<a href="#2.4.1.">2.4.1.</a>      Format of symmetry group file
<a href="#2.5.">2.5.</a>     Format of restart file
<a href="#2.5.1.">2.5.1.</a>      Previous restart file formats
<a href="#2.6.">2.6.</a>     Input/output file units
<a href="#2.7.">2.7.</a>     Utilities
<a href="#2.7.1.">2.7.1.</a>      Analyze restart files (anlyz)
<a href="#2.7.2.">2.7.2.</a>      Convert/copy/compare restart files (transf)
<a href="#2.7.3.">2.7.3.</a>      Plotting utility (khpltps)
<a href="#2.7.4.">2.7.4.</a>      Doing RIXS analysis
<a href="#2.7.5.">2.7.5.</a>      Total/partial densities-of-states (doscalc)
<a href="#2.7.6.">2.7.6.</a>      Total/angle-resolved Xray spectra (xrayspec)
<a href="#2.7.7.">2.7.7.</a>      Total/angle-resolved Infrared spectra (irspec)
<a href="#2.7.8.">2.7.8.</a>      Symmetry operations (symfind, symgen)
<a href="#2.7.9.">2.7.9.</a>      Combine restart files (combine)
<a href="#2.7.10.">2.7.10.</a>     Expand molecular orbitals (expand)
<a href="#2.7.11.">2.7.11.</a>     Remove symmetry in restart file (desymm)
<a href="#2.7.12.">2.7.12.</a>     Generate point charge sets (latsph, pcfilt)
<a href="#2.7.13.">2.7.13.</a>     Linear paths between images (linpath)
<a href="#2.8.">2.8.</a>     Program structure and dimensions
<a href="#2.9.">2.9.</a>     Compilation and error handling
<a href="#3.">3.</a>     Bibliography



<a name="1."><b>1.</a>  INTRODUCTION AND GENERAL DESCRIPTION</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

<a name="1.1."><b>1.1.</a>  SOME HISTORY</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The first version of deMon, deMon0, was described in Alain St-Amant's thesis
[A92]. deMon0 was subsequently substantially modified for commercialization by
BIOSYM Technologies Inc. The beta-release of this modified version became the
basis of the deMon1 series. Meanwhile deMon0 was also undergoing modification
by Annick Goursot (deMon3) in Montpellier and, later, by Lars G.M. Pettersson
(deMon2) in Stockholm. deMon-KS3 represents the fusion of deMon2 and deMon3.
deMon-KS3p0 permitted the use of symmetry in the parts of the program involving
the grid, an aspect which can lead to a considerable saving of time. In
addition, deMon-KS3p1 permits the use of symmetry to block-diagonalize the
KS-Fock matrices, which can aid both convergence and the interpretation of the
MOs. Particular emphasis was put on both computational efficiency and
SCF convergence to allow very large computational models to be treated.



<a name="2."><b>2.</a>  USERS GUIDE</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The present manual describes the most recent StoBe version of the deMon package
which is developed and maintained by Lars G.M. Pettersson (Stockholm
University, Sweden) and Klaus E. Hermann (Fritz-Haber-Institut,
Berlin, Germany) to deal with very large molecules and surface clusters with
specific implementations for inner-shell spectroscopies,
see http://www.fhi-berlin.mpg.de/KHsoftware/StoBe/index.html.



<a name="2.1."><b>2.1.</a>  INTRODUCTION</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The program StoBe is a realization of the Linear Combination of Gaussian Type
Orbitals - MO solution of the Kohn-Sham DFT equations. The theory and numerical
details of this realization can be found in refs.[SCP93,SCF+95].

The StoBe input file consists of a series of keywords. By calling a keyword,
the user can activate or deactivate the option(s) associated with that keyword.
For certain options, the user must also assign numbers, such as the convergence
criteria for an SCF procedure. To make the input as simple as possible, the
input is almost everywhere in free fortran format and each keyword or option
may be truncated to four letters (both upper and lower case characters are
allowed). In addition, a default value is assigned to each option, so at a
minimum, it suffices to specify the molecular geometry and the basis sets to be
used (please never do!). The input file may contain lines between keyword lines
starting with '#' which are interpreted as comment lines and ignored in the
input processing. In the following all input options to StoBe are described in
detail including a brief introduction to the theory behind these options.



<a name="2.1.1."><b>2.1.1.</a>  TABLES OF KEYWORDS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

There are currently about 60 keywords to control a StoBe calculation. The
keywords together with their numerical parameters are explained in Sec. 2.2.
The following two tables list all keywords (a) by logical grouping and (b) in
alphabetical order. All keyword input is handled in subroutine DECODE called
from the main CRAYCP driver. The list of keywords is contained in the character
array OPT in the DECODE routine.

-----------------------------------------------------------------------------
<a name="2.1.1.1."><b>2.1.1.1.</a>  Keywords by logical grouping</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
-----------------------------------------------------------------------------
*** a. Geometry basics ***
<a href="#a.1)">a.1)</a>  CARTesian - geometry input in cartesian coordinates
<a href="#a.2)">a.2)</a>  ZMATrix - geometry input in internal coordinates
<a href="#a.3)">a.3)</a>  NOSYmmetry - do not use symmetry
<a href="#a.4)">a.4)</a>  SYMMetry - use of spatial symmetry and unrestricted calculations

*** b. Electronic state ***
<a href="#b.1)">b.1)</a>  MULTiplicity - spin multiplicity of N-electron state
<a href="#b.2)">b.2)</a>  CHARge - total charge of the system
<a href="#b.3)">b.3)</a>  POTEntial - type of Exc functional to be used
<a href="#b.4)">b.4)</a>  NOFSsymmetry - do not symmetry block the KS matrix
<a href="#b.5)">b.5)</a>  FSYMmetry - use symmetry blocking of KS matrix
<a href="#b.6)">b.6)</a>  SMEAr - level occupation smearing
<a href="#b.7)">b.7)</a>  CONF - define shell configuration in atom calculations
<a href="#b.8)">b.8)</a>  EXCI - define excited hole states
<a href="#b.9)">b.9)</a>  FIELd - apply external electric field
<a href="#b.10)">b.10)</a> SPINcontamination - calculate spin contamination
<a href="#b.11)">b.11)</a> REORder - reorder orbitals in restart
<a href="#b.12)">b.12)</a> LOCAlize - localize orbitals at specific atom centers

*** c. SCF iteration ***
<a href="#c.1)">c.1)</a>  RUNType - type of calculation
<a href="#c.2)">c.2)</a>  SCFType - type of SCF algorithms (disk, memory, direct)
<a href="#c.3)">c.3)</a>  MAXCycles - maximum number of SCF cycles
<a href="#c.4)">c.4)</a>  ECONvergence - SCF energy convergence parameter
<a href="#c.5)">c.5)</a>  DCONvergence - SCF electron density convergence parameter
<a href="#c.6)">c.6)</a>  DMIXing - mixing scheme in extrapolation between SCF steps
<a href="#c.7)">c.7)</a>  DIIS - direct iterative inversion (SCF extrapolation)
<a href="#c.8)">c.8)</a>  LEVElshift - level shifting for improving SCF convergence
<a href="#c.9)">c.9)</a>  MAXOverlap - maximum overlap orbital selection
<a href="#c.10)">c.10)</a> INTEgration - method for angular grid integration
<a href="#c.11)">c.11)</a> GRID - choice of grid for integration and fitting
<a href="#c.12)">c.12)</a> WEDGe - restrict angular grid of Gauss-Legendre integration
<a href="#c.13)">c.13)</a> SLATer - modify Slater radii used in numerical integration
<a href="#c.14)">c.14)</a> PTCHarges - include external point charges (no basis functions)
<a href="#c.15)">c.15)</a> BSSError - select centers without nucleus for BSSE evaluation
<a href="#c.16)">c.16)</a> SUPSym - restrict orbital mixings in SCF
<a href="#c.17)">c.17)</a> TRRH - trust-region Roothan-Hall extrapolation


*** d. Geometry optimization ***
<a href="#d.1)">d.1)</a>  GCONvergence - energy gradient convergence (geometry opt.)
<a href="#d.2)">d.2)</a>  GSTEpsize - maximum step size (geometry optimizations)
<a href="#d.3)">d.3)</a>  MAXGeometries - maximum number of geometry steps (optimization)
<a href="#d.4)">d.4)</a>  COORdinate - constrain atoms in geometry optimization
<a href="#d.5)">d.5)</a>  ATOM - constrain atoms in geometry opt. (fix, free, dir. move)
<a href="#d.6)">d.6)</a>  GROUp - constrain groups of atoms in geometry opt.
<a href="#d.7)">d.7)</a>  HESSian - method of Hessian matrix update (geometry optimization)
<a href="#d.8)">d.8)</a>  GRADients - use Versluis correction in energy gradients
<a href="#d.9)">d.9)</a>  STRBalsac - BALSAC structure plot at each geometry step

*** e. Properties ***
<a href="#e.1)">e.1)</a>  MULLiken - include Mulliken population analysis
<a href="#e.2)">e.2)</a>  LOEWdin - include Loewdin population analysis
<a href="#e.3)">e.3)</a>  MEPFit - calculate eff. atomic charges from MEPS fitting (n.a.)
<a href="#e.4)">e.4)</a>  BALPopulation - orbital, Fukui, population output (BALSAC format)
<a href="#e.5)">e.5)</a>  DRAW - output data for plotting MOs, MEPS, or other properties
<a href="#e.6)">e.6)</a>  PSCRatch - evaluate polarizabilities by SCF scratch runs
<a href="#e.7)">e.7)</a>  XRAYspectra - compute X-ray spectra (absorption, emission, RIXS)
<a href="#e.8)">e.8)</a>  TOPOlogical - Topological charge/orbital analysis (Bader, etc.)
<a href="#e.9)">e.9)</a>  NMROut - output for subsequent NMR calculations
<a href="#e.10)">e.10)</a> EPROut - output for subsequent EPR calculations
<a href="#e.11)">e.11)</a> VIBRations - vibrational analysis details
<a href="#e.12)">e.12)</a> NEBparameters - compute NEB paths
<a href="#e.13)">e.13)</a> RESInput - redirect restart input file units
<a href="#e.14)">e.14)</a> RESOutput - redirect restart output file units

*** f. Miscellaneous keywords ***
<a href="#f.1)">f.1)</a>  TITLe - title line of StoBe run
<a href="#f.2)">f.2)</a>  PRINtout - extended print output
<a href="#f.3)">f.3)</a>  SAVE - save restart file periodically
<a href="#f.4)">f.4)</a>  ORBItalchoice - choice of orbital representation (d functions)
<a href="#f.5)">f.5)</a>  ECPRead - use alternative one-electron hamiltonian
<a href="#f.6)">f.6)</a>  PNTGenerator - gridpoint generator for angular integration
<a href="#f.7)">f.7)</a>  ALCHem - geometry, basis, orbital output to ALCHEM format files
<a href="#f.8)">f.8)</a>  FILEoutput - analysis file output, used for Molden, Molekel
<a href="#f.9)">f.9)</a>  VIRTuals - include virtual orbitals in print output
<a href="#f.10)">f.10)</a> CTRLoption - interactive control parameter in/output (unit 7)
<a href="#f.11)">f.11)</a> DOSOutput - file output for DOS calculations (units 96/97)
<a href="#f.12)">f.12)</a> SHoRTrestartfile - short StoBe restart file output (unit 2)
<a href="#f.13)">f.13)</a> FORCes - evaluate atom forces after single point SCF run
<a href="#f.14)">f.14)</a> DYNAmics - short-time dynamics simulation
<a href="#f.15)">f.15)</a> GEOFormat - set format for geometry output files


-----------------------------------------------------------------------------


-----------------------------------------------------------------------------
<a name="2.1.1.2."><b>2.1.1.2.</a>  Keywords in alphabetical order</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
-----------------------------------------------------------------------------
 ALCHem - geometry, basis, orbital output to ALCHEM format files ..... <a href="#f.7)">f.7)</a>
 ATOM - constrain atoms in geometry opt. (fix, free, dir. move) ...... <a href="#d.5)">d.5)</a>
 BALPopulation - orbital, Fukui, population output (BALSAC format) ... <a href="#e.4)">e.4)</a>
 BSSError - select centers without nucleus for BSSE evaluation ....... <a href="#c.15)">c.15)</a>
 CARTesian - geometry input in cartesian coordinates ................. <a href="#a.1)">a.1)</a>
 CHARge - total charge of the system ................................. <a href="#b.2)">b.2)</a>
 CONF - define shell configuration in atom calculations .............. <a href="#b.7)">b.7)</a>
 COORdinate - constrain atoms in geometry optimization ............... <a href="#d.4)">d.4)</a>
 CTRLoption - interactive control parameter in/output (unit 7) ....... <a href="#f.10)">f.10)</a>
 DCONvergence - SCF electron density convergence parameter ........... <a href="#c.5)">c.5)</a>
 DIIS - direct iterative inversion (SCF extrapolation) ............... <a href="#c.7)">c.7)</a>
 DMIXing - mixing scheme in extrapolation between SCF steps .......... <a href="#c.6)">c.6)</a>
 DOSOutput - file output for DOS calculations (units 96/97) .......... <a href="#f.11)">f.11)</a>
 DRAW - output data for plotting MOs, MEPS, or other properties ...... <a href="#e.5)">e.5)</a>
 DYNAmics - short-time dynamics simulation ........................... <a href="#f.14)">f.14)</a>
 ECONvergence - SCF energy convergence parameter ..................... <a href="#c.4)">c.4)</a>
 ECPRead - use alternative one-electron hamiltonian .................. <a href="#f.5)">f.5)</a>
 EPROut - output for subsequent EPR calculations ..................... <a href="#e.10)">e.10)</a>
 EXCI - define excited hole states ................................... <a href="#b.8)">b.8)</a>
 FIELd - apply external electric field ............................... <a href="#b.9)">b.9)</a>
 FILEoutput - analysis file output, used for Molden, Molekel ......... <a href="#f.8)">f.8)</a>
 FORCes - evaluate atom forces after single point SCF run ............ <a href="#f.13)">f.13)</a>
 FSYMmetry - use symmetry blocking of KS matrix ...................... <a href="#b.5)">b.5)</a>
 GCONvergence - energy gradient convergence (geometry opt.) .......... <a href="#d.1)">d.1)</a>
 GEOFormat - set format for geometry output files .................... <a href="#f.15)">f.15)</a>
 GRADients - use Versluis correction in energy gradients ............. <a href="#d.8)">d.8)</a>
 GRID - choice of grid for integration and fitting ................... <a href="#c.11)">c.11)</a>
 GROUp - constrain groups of atoms in geometry opt. .................. <a href="#d.6)">d.6)</a>
 GSTEpsize - maximum step size (geometry optimizations) .............. <a href="#d.2)">d.2)</a>
 HESSian - method of Hessian matrix update (geometry optimization) ... <a href="#d.7)">d.7)</a>
 INTEgration - method for angular grid integration ................... <a href="#c.10)">c.10)</a>
 LEVElshift - level shifting for improving SCF convergence ........... <a href="#c.8)">c.8)</a>
 LOCAlize - localize orbitals at specific atom centers ............... <a href="#b.12)">b.12)</a>
 LOEWdin - include Loewdin population analysis ....................... <a href="#e.2)">e.2)</a>
 MAXCycles - maximum number of SCF cycles ............................ <a href="#c.3)">c.3)</a>
 MAXGeometries - maximum number of geometry steps (optimization) ..... <a href="#d.3)">d.3)</a>
 MAXOverlap - maximum overlap orbital selection ...................... <a href="#c.9)">c.9)</a>
 MEPFit - calculate eff. atomic charges from MEPS fitting (n.a.) ..... <a href="#e.3)">e.3)</a>
 MULLiken - include Mulliken population analysis ..................... <a href="#e.1)">e.1)</a>
 MULTiplicity - spin multiplicity of N-electron state ................ <a href="#b.1)">b.1)</a>
 NMROut - output for subsequent NMR calculations ..................... <a href="#e.9)">e.9)</a>
 NEBparameters - compute NEB paths ................................... <a href="#e.12)">e.12)</a>
 NOFSsymmetry - do not symmetry block the KS matrix .................. <a href="#b.4)">b.4)</a>
 NOSYmmetry - do not use  symmetry ................................... <a href="#a.3)">a.3)</a>
 ORBItalchoice - choice of orbital representation (d functions)....... <a href="#f.4)">f.4)</a>
 PNTGenerator - gridpoint generator for angular integration .......... <a href="#f.6)">f.6)</a>
 POTEntial - type of Exc functional to be used ....................... <a href="#b.3)">b.3)</a>
 PRINtout - extended print output .................................... <a href="#f.2)">f.2)</a>
 PSCRatch - evaluate polarizabilities by SCF scratch runs ............ <a href="#e.6)">e.6)</a>
 PTCHarges - include external point charges (no basis functions) ..... <a href="#c.14)">c.14)</a>
 REORder - reorder orbitals in restart ............................... <a href="#b.11)">b.11)</a>
 RESInput - redirect restart input file units ........................ <a href="#e.13)">e.13)</a>
 RESOutput - redirect restart output file units ...................... <a href="#e.14)">e.14)</a>
 RUNType - type of calculation ....................................... <a href="#c.1)">c.1)</a>
 SAVE - save restart file periodically ............................... <a href="#f.3)">f.3)</a>
 SCFType - type of SCF algorithms (disk, memory, cpu intensive) ...... <a href="#c.2)">c.2)</a>
 SHoRTrestartfile - short StoBe restart file output (unit 2) ......... <a href="#f.12)">f.12)</a>
 SLATer - modify Slater radii used in integration scheme ............. <a href="#c.13)">c.13)</a>
 SMEAr - level occupation smearing ................................... <a href="#b.6)">b.6)</a>
 SPINcontamination - calculate spin contamination .................... <a href="#b.10)">b.10)</a>
 STRBalsac - BALSAC structure plot at each geometry step ............. <a href="#d.9)">d.9)</a>
 SUPSym - restrict orbital mixings ................................... <a href="#c.16)">c.16)</a>
 SYMMetry - use of spatial symmetry, broken symmetry calculations .... <a href="#a.4)">a.4)</a>
 TITLe - title line of StoBe run ..................................... <a href="#f.1)">f.1)</a>
 TOPOlogical - Topological charge/orbital analysis (Bader, etc.) ..... <a href="#e.8)">e.8)</a>
 TRRH - trust-region Roothan-Hall extrapolation ...................... <a href="#c.17)">c.17)</a>
 VIBRations - vibrational analysis details ........................... <a href="#e.11)">e.11)</a>
 VIRTuals - include virtual orbitals in print output ................. <a href="#f.9)">f.9)</a>
 WEDGe - restrict angular grid of Gauss-Legendre integration ......... <a href="#c.12)">c.12)</a>
 XRAYspectra - compute X-ray spectra (absorption, emission, RIXS) ...  <a href="#e.7)">e.7)</a>
 ZMATrix - geometry input in internal coordinates .................... <a href="#a.2)">a.2)</a>
-----------------------------------------------------------------------------



<a name="2.2."><b>2.2.</a>  DETAILED DESCRIPTION OF KEYWORDS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

There are currently about 60 keywords to define input parameters. Keywords are,
in most cases, followed by numbers on the same line or on following lines. The
keywords together with their numerical parameters are explained in detail by
logical groups

    -  Geometry basics
    -  Electronic states
    -  SCF iteration
    -  Geometry optimization
    -  Properties
    -  Miscellaneous keywords
    -  Untested keywords
    -  Unclear and obsolete keywords

in the following sections. In the following, the description of each main
keyword starts with its calling sequence where the shortest acceptable word
form (short notation) is shown by upper case characters. In the actual input,
all keywords start with their short notation (in any mixture of upper and lower
case characters) but may be longer. Main/option keywords, text or numbers are
separated on the same line by (at least) one blank character.



<a name="2.2.1."><b>2.2.1.</a>  KEYWORDS FOR GEOMETRY BASICS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

-----------------------------------------------------------------------------
                                                      <a name="a.1)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> a.1)  CARTesian  [ANGstrom, BOHr]  [nimg]</b>
-----------------------------------------------------------------------------

This keyword defines geometry input by cartesian coordinates. The keyword
ANGstrom must be used if the geometry is defined in Angstroms. Otherwise,
atomic units (Bohr) are used.

Integer number nimg refers to multi-image input (which is essential for
nudged-elastic-band (NEB) calculations, see <a href="#c.1)">c.1)</a>, <a href="#e.12)">e.12)</a>) where different
geometric structures of a cluster/molecule (so-called images) are treated at a
common basis. Here nimg denoted the number of images to be given in the
following (default is nimg = 1).

After the keyword line CARTesian ..., each line defines one atom (I) of
the system. The input format is

     Nm  X  Y  Z  ZZ  Ngrid  [Mass]

where

     Nm       = element symbol for atom I, followed by up to two numbers.
                NOTE that the element name (one or two characters) must be a
                valid name of the element table

                     H, He, Li, Be,  B,  C,  N,  O,  F, Ne, Na, Mg  ( 1-12)
                    Al, Si,  P,  S, Cl, Ar,  K, Ca, Sc, Ti,  V, Cr  (13-24)
                    Mn, Fe, Co, Ni, Cu, Zn, Ga, Ge, As, Se, Br, Kr  (25-36)
                    Rb, Sr,  Y, Zr, Nb, Mo, Tc, Ru, Rh, Pd, Ag, Cd  (37-48)
                    In, Sn, Sb, Te,  I, Xe, Cs, Ba, La, Ce, Pr, Nd  (49-60)
                    Pm, Sm, Eu, Gd, Tb, Dy, Ho, Er, Tm, Yb, Lu, Hf  (61-72)
                    Ta,  W, Re, Os, Ir, Pt, Au, Hg, Tl, Pb, Bi, Po  (73-84)
                    At, Rn, Fr, Ra, Ac, Th, Pa,  U, Np, Pu, Am, Cm  (75-96)
                    Bk, Cf, Es, Fm, Md, No, Lr, Ku, Ha              (97-105)

                The additional numbers permit you to distinguish different
                atoms of the same element, e.g. H1 H2 H3 ...H21. In addition,
                the atomic symbol Du refers to dummy atoms, i. e. atoms with
                basis sets but no nuclear charge. Note that dummy atoms are
                meaningful only for single point SCF and polarizability
                calculations (integration parameters are those of hydrogen,
                still testing!).

     X, Y, Z  = x , y , z coordinates of atom I given in Angstrom or Bohr
                units, see line CARTesian ... above.

     ZZ       = effective nuclear charge of atom I. This may be different
                from the atomic number if model core potentials are being
                used. Basis set superposition error (BSSE) corrections are
                calculated using ZZ=0.0 (set internally) for the respective
                atom centers while their basis sets are retained.

     Ngrid    = number of radial grid points used in the evaluation of the
                exchange-correlation potentials and energy density of atom I.

     Mass     = (optional) atomic mass of atom I, used to correct forces for
                translational/rotational invariance in geometry optimizations
                without symmetry. If no mass value appears, a default from
                an internal table is used.

The atom definition list of each image is terminated by one line containing
the keyword 'END'. The above list is repeated for multi-image input.

Examples:

     &gt;CARTESIAN
     &gt;O    0.0000      0.00000     0.0000      8.  32
     &gt;H1   0.0000000   1.4499633   1.1214967   1.  32
     &gt;H2   0.0000000  -1.4499633   1.1214967   1.  32
     &gt;END

     &gt;CARTESIAN 2
     &gt;O    0.0000      0.00000     0.0000      8.  32
     &gt;H1   0.0000000   1.4499633   1.1214967   1.  32
     &gt;H2   0.0000000  -1.4499633   1.1214967   1.  32
     &gt;END
     &gt;O    0.0000      0.00000     0.2000      8.  32
     &gt;H1   0.0000000   1.4499633   1.1214967   1.  32
     &gt;H2   0.0000000  -1.4499633   1.1214967   1.  32
     &gt;END

     &gt;CARTESIAN ANGSTROM
     &gt;O    0.0000      0.00000     0.0000      8.  32
     &gt;H1   0.0000000   0.7672872   0.5934703   1.  32
     &gt;H2   0.0000000  -0.7672872   0.5934703   1.  32
     &gt;END

     &gt;CARTESIAN ANGSTROM 2
     &gt;O    0.0000      0.00000     0.0000      8.  32
     &gt;H1   0.0000000   0.7672872   0.5934703   1.  32
     &gt;H2   0.0000000  -0.7672872   0.5934703   1.  32
     &gt;END
     &gt;O    0.0000      0.00000     0.2000      8.  32
     &gt;H1   0.0000000   0.7672872   0.5934703   1.  32
     &gt;H2   0.0000000  -0.7672872   0.5934703   1.  32
     &gt;END


-----------------------------------------------------------------------------
                                                      <a name="a.2)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> a.2)  ZMATrix  [ANGstrom]</b>
-----------------------------------------------------------------------------

This keyword defines geometry input by internal coordinates based on the
Z-matrix notation. The ANGSTROM option is chosen if the geometry is defined
in Angstroms. Otherwise, atomic units (Bohr) are used. After the keyword,
each line defines one atom (I) of the system. The line input format is

(atom 1)  Nm  ZZ  Ngrid  [Mass]
(atom 2)  Nm  J  R(I,J)  ZZ  Ngrid  [Mass]
(atom 3)  Nm  J  R(I,J)  K  ALPHA(I,J,K)  ZZ  Ngrid  [Mass]
(atom &gt;3) Nm  J  R(I,J)  K  ALPHA(I,J,K)  L  PHI(I,J,K,L)  ZZ  Ngrid  [Mass]

where

     Nm           = element symbol for atom I, followed by up to two
                    numbers. The definition is identical to that of keyword
                    CARTesian, <a href="#a.1)">a.1)</a>

     J            = index of previous atom J
     R(I,J)       = bond distance between atoms I, J

     K            = index of previous atom K (.ne. J)
     ALPHA(I,J,K) = bond angle between atoms I, J, K  (angle I - J - K )

     L            = index of previous atom L (.ne. J, .ne. K)
     PHI(I,J,K,L) = dihedral angle formed by atoms I, J, K, L (angle between
                    planes through J,K,I and through J,K,L:
                    PHI &gt; 0 for clockwise rotation of plane J,K,I towards
                    J,K,L about J - K, else PHI &lt; 0).

     ZZ           = effective nuclear charge of atom I. This may be different
                    from the atomic number if model core potentials are being
                    used. Basis set superposition error (BSSE) corrections are
                    calculated using ZZ=0.0 (set internally) for the respective
                    atom centers while their basis sets are retained.

     Ngrid        = number of radial grid points used for the least-squares
                    fit of the exchange-correlation potentials and energy
                    density of atom I.

     Mass         = (optional) atomic mass of atom I, used to correct forces
                    for translational/rotational invariance in geometry
                    optimizations without symmetry. If no mass value appears,
                    a default from an internal table is used.

The atom definition list is terminated by one line containing the keyword END.

The Z-matrix notation is converted internally to cartesian coordinates where
  - atom  # 1   defines the origin, i. e. R1 = (0, 0, 0)
  - atom  # 2   points along the (positive) z axis, i. e. R2 = (0, 0, R(1,2))
  - atom  # 3   lies in the xz plane with x &gt; 0, i. e. R3 = (x, 0, y)
  - atoms # p&gt;3 are defined accordingly

Examples:

  (a)  H2O molecule

     &gt;ZMATRIX ANGSTROM
     &gt;O                      8.  32
     &gt;H  1  0.97             1.  32
     &gt;H  1  0.97  2  105.5   1.  32
     &gt;END

  (b)  NH3 molecule

     &gt;ZMATRIX BOHR
     &gt;N                                    7.  32
     &gt;H  1  1.9419                         1.  32
     &gt;H  1  1.9419  2  107.06              1.  32
     &gt;H  1  1.9419  2  107.06  3  114.54   1.  32
     &gt;END

     corresponding to

     &gt;CARTESIAN BOHR
     &gt;N       0.00000000    0.00000000    0.00000000    7.  32
     &gt;H       0.00000000    0.00000000    1.94190000    1.  32
     &gt;H       1.85645263    0.00000000   -0.56970100    1.  32
     &gt;H      -0.77103753    1.68876212   -0.56970100    1.  32
     &gt;END

Note, that option ZMATrix can be used only if no symmetry is applied to
coordinates, see keyword NOSYm in <a href="#a.3)">a.3)</a>. Further, the Z-matrix format does not
support multi-image input available with cartesian coordinates, see <a href="#a.1)">a.1)</a>.


-----------------------------------------------------------------------------
                                                      <a name="a.3)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> a.3)  NOSYmmetry  [UNREstricted]</b>
-----------------------------------------------------------------------------

This keyword excludes the use of spatial symmetry in the calculations. The
keyword must be specified BEFORE the coordinate input and coordinates of ALL
atoms have to be given. The (optional) keyword

     UNREstricted   forces a spin-unrestricted calculation even in cases where
                    the number of alpha and beta spin orbitals is identical.

Examples:

     &gt;NOSYMMETRY
     &gt;NOSYMMETRY UNRESTRICTED


For more details on the use of symmetry, see also keywords SYMMetry,
FSYMmmetry, NOFSymmetry.


-----------------------------------------------------------------------------
                                                      <a name="a.4)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> a.4)  SYMMetry  symlabel  [UNREstricted, NOSYmmetry]</b>
-----------------------------------------------------------------------------

This keyword allows the use of spatial symmetry in the calculations to speed
up the calculations [DGS93]. With symmetry, the numerical integration is
performed only for symmetry non-equivalent atoms and only non-equivalent
atoms can appear in the coordinate input, see keyword CARTesian.
Therefore, the keyword line 'SYMMetry ...' must be specified BEFORE the
coordinate input and only coordinates (and orbital/auxiliary basis sets) of
symmetry non-equivalent atoms have to be included. At present, the following
48 point symmetry groups are supported (see also file symbasis):

         1. C1           2. Ci           3. Cs           4. Csxz
         5. Csy          6. Csyz         7. Csx          8. Csxy
         9. Csz         10. C2          11. C3          12. C4
        13. C5          14. C6          15. S4          16. S6
        17. D2          18. D3          19. D4          20. D5
        21. D6          22. C2v         23. C2vb        24. C3v
        25. C4v         26. C5v         27. C6v         28. C2h
        29. C3h         30. C4h         31. C5h         32. C6h
        33. D2h         34. D3h         35. D4h         36. D5h
        37. D6h         38. D2d         39. D3d         40. D4d
        41. D5d         42. D6d         43. T           44. Th
        45. Td          46. O           47. Oh          48. ATOM

Symmetry label ATOM which denotes the full rotational point group (up to d
functions) is restricted to free atoms.

For further definitions see also notes on symmetries, section 2.4.

Note that the above given symmetry labels can be given by mixed case (e.g. C4v)
or only upper case characters (e.g. C4V), see examples below.

Note that inside StoBe spatial coincidence of atoms as a result of
symmetrization is detected and corrected accordingly. Here "coincidence" is
defined by an interatomic distance &lt; 0.001 atomic units (0.000529177 Angstrom).
All atom centers at distances &gt; 0.001 au will be treated as separate centers.

The (optional) keywords

     UNREstricted   forces a spin-unrestricted calculation even in cases where
                    the number of alpha and beta spin orbitals in each symmetry
                    representation is identical.

     NOSYmmetry     applies the symmetry group only while generating atom
                    centers of a cluster/molecule whereas all SCF calculations
                    (single point, geometry optimizations, vibrations) are
                    carried out without symmetry (C1), requiring input
                    parameters which refer to C1. Note that with this option
                    all basis sets (orbital, auxiliary, model potentials) have
                    to be provided only for symmetry non-eqivalent centers, see
                    example m) below.

Examples:

  a)  H2O, no symmetry

     &gt;SYMM C1             or        &gt;NOSYMM
     &gt;CARTESIAN ANGSTROM
     &gt;O    0.0   0.0      0.0       8.0   35
     &gt;H    0.0   0.763    0.5861    1.0   32
     &gt;H    0.0  -0.763    0.5861    1.0   32

  b)  H2O, C2v symmetry

     &gt;SYMM C2v
     &gt;CARTESIAN ANGSTROM
     &gt;O    0.0   0.0      0.0       8.0   35
     &gt;H    0.0   0.763    0.5861    1.0   32

  c)  O2 (other homonuclear diatomics), D2h symmetry

     &gt;SYMM D2h
     &gt;CARTESIAN ANGS
     &gt; O    0.0       0.0    0.61   8.0   35

  d)  HF (other heteronuclear diatomics), C4v symmetry

     &gt;SYMM C4V
     &gt;CARTESIAN ANGS
     &gt;H    0.0   0.0    0.000  1.0     32
     &gt;F    0.0   0.0    0.916  9.0     35

  e)  NH3, C3v symmetry

     &gt;SYMM C3V
     &gt;CARTESIAN ANGSTROM
     &gt;  N    0.000    0.0000   0.0677      7.0    35
     &gt;  H    0.9406   0.0000  -0.2993      1.0    32

  f)  Pd3, D3h symmetry

     &gt;SYMM D3h
     &gt;CART ANGSTRO
     &gt; PD     2.38   0.0   0.0   46.0    42

  g)  C2H6, D3h symmetry

     &gt;SYMM D3H
     &gt;CARTESIAN BOHR
     &gt; C    0.0     0.00000  1.465      6.0    35
     &gt; H    1.915    0.0000   2.215     1.0    32

  h)  C6H6, D6H symmetry

     &gt;SYMM D6H
     &gt;CARTESIAN BOHR
     &gt; C     0.00000  2.6518633 0.000    6.0    35
     &gt; H     0.00000  4.6936720 0.000    1.0    32

  i)  CH4, Td symmetry

     &gt;SYMM TD
     &gt;CARTE ANGSTR
     &gt;C   0.0     0.0      0.0      6.0    35
     &gt;H   0.633   0.633   0.633     1.0    32

  j)  CH4, Td symmetry, spin-unrestricted calculation

     &gt;SYMM TD  UNRESTRICTED
     &gt;CARTE ANGSTR
     &gt;C   0.0     0.0      0.0      6.0    35
     &gt;H   0.633   0.633   0.633     1.0    32

  k)  Pd8, Oh symmetry

     &gt;SYMM OH
     &gt;CART ANGSTRO
     &gt; PD     2.38   2.38  2.38  46.0    42

  l)  Ni atom, full rotational atom symmetry

     &gt;SYMM ATOM
     &gt;CART ANGSTRO
     &gt; Ni     0.000  0.000  0.000  28.0    32

  m)  NH3 molecule, C1 symmetry but coordinate and basis set input with C3v
      symmetry

     &gt;SYMM C3V NOSYMM
     &gt;CARTESIAN BOHR
     &gt;  N       0.000000    0.000000    0.000000  7.  32
     &gt;  H       1.787874    0.000000    0.734852  1.  32
     &gt;END
     &gt;  ...
     &gt;END
     &gt;A-NITROGEN (4,4;4,4)
     &gt;A-HYDROGEN (4,0;4,0) diffuse
     &gt;O-NITROGEN (631/31/1)
     &gt;O-HYDROGEN (41/1*/1+) (TZVP-FIP2)
     &gt;END



<a name="2.2.2."><b>2.2.2.</a>  KEYWORDS FOR ELECTRONIC STATES</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

-----------------------------------------------------------------------------
                                                      <a name="b.1)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.1)  MULTiplicity [number]</b>
-----------------------------------------------------------------------------

Spin multiplicity of the N-electron state. Numbers 1, 2, 3, etc. refer to
singlet, doublet, triplet, etc. states. By default, a singlet state is
assumed (leading to an error message for systems where the total number of
electrons is odd). The spin multiplicity together with the net charge, see
CHARge, determines the total number of spin alpha and beta orbitals to be
occupied and the multiplicity / charge values are checked for consistency.

Note: Since only the occupations are given, the multiplicity is only formally
correct for high-spin states, i.e. when in each symmetry the number of
alpha(beta) electrons exceeds that of the other spin. Otherwise the resulting
spin state is a mixture of the possible spin states which have a projection
equal to (MULT-1)/2. In practice the formalism thus corresponds to a
single-determinant Hartree-Fock with regards to spin-coupling.

Example (triplet state):

     &gt;MULTIPLICITY  3


-----------------------------------------------------------------------------
                                                      <a name="b.2)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.2)  CHARge [number]</b>
-----------------------------------------------------------------------------

Net charge of the system, positive (negative) for cations (anions). By
default, the system is assumed neutral (number = 0). The net charge together
with the spin multiplicity, see MULTiplicity, determines the total number
of spin alpha and beta orbitals to be occupied and the multiplicity / charge
values are checked for consistency.

Example (singly charged cation):

     &gt;CHARGE  1


-----------------------------------------------------------------------------
                                                      <a name="b.3)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.3)  POTEntial [FTYP] [EXCH] [CORR]</b>
-----------------------------------------------------------------------------

 The exchange-correlation functional used in the calculations is defined by
 three keywords characterizing the

  - overall type of functional FTYP (LOCAl, NONLocal, MIXEd),

  - the exchange part EXCH (NORMal, PD86, PD91, PVS1, BE88, BECKe, DEPK,
    BE86, BA86, PBE, PBE2, RPBE), and

  - the correlation part CORR (XALPha, VWN, PD91, PVS1, PD86, PD91, LAP,
    PBE).

 All meaningful combinations are given in the following table, together with
 the corresponding pointers (NLCL, NLEX and NLEC) in the code.

  ___________________________________________________________________
  |  local              |       nonlocal      |        mixed        |
  |---------------------|---------------------|---------------------|
  |  NLCL=1             |  NLCL=2             |  NLCL=3             |
  |---------------------|---------------------|---------------------|
  |exch |nlex|corr |nlec|exch |nlex|corr |nlec|exch |nlex|corr |nlec|
  |----------|----------|----------|----------|----------|----------|
  |          |XALP | 0  |          |XALP | 0  |          |XALP | 0  |
  |NORM | 1  |VWN  | 1  |PD86 | 1  |PD86 | 1  |PD86 | 1  |PD86 | 1  |
  |PVS1 | 2  |PD91 | 2  |BE88 | 2  |PD91 | 2  |BE88 | 2  |PD91 | 2  |
  |          |PVS1 | 3  |PD91 | 3  |PVS1 | 3  |PD91 | 3  |PVS1 | 3  |
  |          |VBH  | 4  |BA86 | 4  |LAP  | 4  |BA86 | 4  |LAP  | 4  |
  |                     |DEPK | 5  |PBE  | 5  |DEPK | 5  |PBE  | 5  |
  |                     |BE86 | 6  |          |BE86 | 6  |          |
  |                     |PBE  | 7  |          |PBE  | 7  |          |
  |                     |PBE2 | 8  |          |PBE2 | 8  |          |
  |                     |RPBE | 9  |          |RPBE | 9  |          |
  -------------------------------------------------------------------

NOTE: For backwards compatibility keyword "BE88" can be replaced by "BECK".

The various choices for exchange and correlation parts have the following
meaning:

   (A)  Exchange part EXCH

        (LOCAl)    NORMal - standard local spin density exchange [D30]

        (LOCAl)    PVS1   - modified gradientless SD exchange [PVS94].

        (NONLocal) BE88   - GGA exchange functional of Becke [BE88].
        (NONLocal) BECK   - identical to BE88 (for backwards compatibility).

        (NONLocal) PD86   - GGA exchange of Perdew and Wang [PW86].

        (NONLocal) PD91   - improved GGA exchange functional of Perdew / Wang
                            [P91].

        (NONLocal) PBE    - GGA exchange of Perdew / Burke/ Ernzerhof
                            [PBE96].

        (NONLocal) PBE2   - revised GGA exchange of Perdew / Burke/ Ernzerhof
                            [ZY98], using different fit parameter choices.

        (NONLocal) RPBE   - alternative revised PBE exchange according to
                            Hammer et al. [HHN99].

        (NONLocal) BE86   - GGA exchange version of Becke as of 1986 [B86].

        (NONLocal) BA86   - GGA exchange version of Becke as of 1986 (alt.)
                            [B86a].

        (NONLocal) DEPK   - GGA exchange by Daul [GDZ86].

   (B)  Correlation part CORR

        (LOCAL)  XALP   - No explicit correlation, included for historic
                          reasons only.

        (LOCAL)  VWN    - LSD correlation functional by Vosko, Wilk and
                          Nusair [VWN80].

        (LOCAL)  VBH   -  LSD correlation functional by v. Barth, Hedin and
                          others [BH72, HL71, GL76].

        (LOCAL)  PD91   - Accurate analytical representation of the
                          homogeneous gas correlation energy by Perdew and
                          Wang [PW91].

        (LOCAL)  PVS1   - Gradientless correlation functional based on
                          (inhomogeneous) pair-correlation function of
                          Colle-Salvetti type [PVS94].

        (NONLocal) PD86 - GGA correlation functional of Perdew [P86].

        (NONLocal) PD91 - New GGA correlation functional of Perdew and Wang
                          [P91].

        (NONLocal) LAP  - Nonlocal generalization of the correlation
                          functional PVS1 involving the kinetic energy
                          density and the Laplacian of the electron density
                          [PRV95].

        (NONLocal) PBE  - GGA correlation of Perdew / Burke/ Ernzerhof
                          [PBE96].


The exchange/correlation combinations tested in detail are

     POTENTIAL LOCAL NORM VWN       (default functional)
     POTENTIAL LOCAL PVS1 PVS1
     POTENTIAL NONLOCAL PD86 LAP
     POTENTIAL NONLOCAL BE88 LAP
     POTENTIAL NONLOCAL PBE PBE
     POTENTIAL NONLOCAL PBE2 PBE
     POTENTIAL NONLOCAL RPBE PBE
     POTENTIAL MIXED PD86 LAP
     POTENTIAL MIXED BE88 LAP.

Some choices involving the options PVS1 and LAP are yet not debugged and should
not be used at present. In particular, for the LAP correlation option, at
present only the following parameter choices are meaningful

 1. BLAP1 (does not involve any parallel spin correlation beyond Ex)
          &gt;POTENTIAL NONLOCAL BE88 LAP 0.197 1.255 1.48 0.00

 2. PLAP1 (similar to BLAP1 in essence )
          &gt;POTENTIAL NONLOCAL PD86 LAP 0.197 1.255 1.48 0.00

 3. BLAP3 (includes some parallel spin correlation beyond Ex)
          &gt;POTENTIAL NONLOCAL BE88 LAP 0.197 1.276 1.477 0.04

  4. PLAP3 (similar to BLAP3)
          &gt;POTENTIAL NONLOCAL PD86 LAP 0.197 1.26 1.48 0.01

  5. PLAP4 (similar to PLAP3 but with a refined share of the parallel spin
     correlation, so as to achieve optimal results for weak interactions)
          &gt;POTENTIAL NONLOCAL PD86 LAP 0.1962 1.2557 1.48 0.003


-----------------------------------------------------------------------------
                                                      <a name="b.4)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.4)  NOFSymmetry  [AUFBau, SCFOccupation]</b>
-----------------------------------------------------------------------------

The StoBe code uses symmetry in two ways: to generate the equivalent centers
and only treat the non-equivalent centers in the numerical integration of the
exchange-correlation potentials and to generate a symmetry-adapted basis for
the expansion of the Kohn-Sham orbitals. Using symmetry on the grid can
substantially reduce the time for each iteration, while symmetrizing the
orbitals results in a block-diagonal Kohn-Sham matrix which improves
convergence and leads to more easily identified symmetry orbitals.

With the NOFSymmetry keyword, block diagonalization of the Kohn-Sham matrix
according to molecular symmetry, see keyword FSYMmetry, is not used while the
symmetry may still be used in the numerical integration, see keyword SYMMetry.

NOTE that in atom calculations with full rotational symmetry and explicit shell
occupation by option CONFig, see <a href="#b.7)">b.7)</a>, this option is ignored, see also <a href="#b.5)">b.5)</a>.

The keyword line

     NOFSsymetry  AUFBau  [ALphabeta]
         inhibits symmetry-based block-diagonalization of the Kohn-Sham matrix
         and determines the occupation of orbitals by the Aufbau principle
         (orbitals are filled with increasing KS 1-electron energy up to the
         HOMO). The Aufbau principle can be used together with the level smear
         option, see keyword SMEAr.

         The optional keyword ALphabeta does an overall aufbau using both alpha
         and beta spin orbitals together. This procedure does not necessarily
         preserve the total spin between iterations.

     NOFSymmetry  SCFOccupation  [EXCIted]
         inhibits symmetry based block diagonalization of the Kohn-Sham matrix
         and defines a fixed occupation scheme. The scheme on new lines as

           ALFA  nocca  leva   na1 occa1  na2 occa2  ...  nleva occleva
           BETA  noccb  levb   nb1 occb1  nb2 occb2  ...  nlebv occlevb

         where on the line starting with  'ALFA', nocca is the total number of
         alpha orbitals to be occupied (including those whose occupations
         are explicitly given!) and leva denotes the number of alpha orbitals
         (&lt; 10) whose occupations are to be given explicitly, followed by leva
         pairs of numbers (nai, occai) defining the orbital index nai and the
         orbital occupation occai. The following line starting with 'BETA'
         contains the analogous input for beta orbitals. Both 'ALFA' and 'BETA'
         lines are required in the input. The occupation numbers are kept fixed
         in the SCF calculation irrespective of the Aufbau principle (which may
         result in an excited state or in bad convergence). Note that the
         definition of the numbers following the 'ALFA' and 'BETA' keywords
         are somewhat different when used for atoms and with symmetry, see
         below. Fixed occupations are incompatible with the level smear option,
         see keyword SMEAr.

         An excited configuration (within the single KS determinant
         representation) can also be specified using the optional keyword
         EXCIted on the keyword line. This requires additional input lines
         where for the Kohn-Sham matrix all orbitals for which the occupations
         will be specified are given as:

             SYM 1
             ALFA 0 na num1 occ1 num2 occ2 ... numna occna
             BETA 0 nb num1 occ1 num2 occ2 ... numnb occnb
             END

         If na is greater than 9 then the input is simply continued as a
         numerical input on following lines (10 orbital specifications i.e.
         sets of (num,occ) to a line). Note that all orbitals occurring in the
         global occupation scheme (see above) but not specified explicitly
         by occupations retain an occupation of 1.

         The excited configuration scheme can also be used to evaluate Fukui
         functions and indices [PY84,PY89] within the finite difference
         approximation. This requires a restart from an initial configuration
         (with or without excitations), see <a href="#c.1)">c.1)</a>, where an artificial
         excitation is introduced in addition by changing the occupation of a
         specific orbital by a small amount (e.g. 0.01 electrons, Fukui
         charge). A comparison of the self-consistent solution with Fukui
         charge with the initial restart input is used to evaluate Fukui
         functions and indices. The Fukui charge excitation is defined by a
         keyword line

           FUKUi [ALFA, BETA]  qfukui norb iorb(1) worb(1) iorb(2) worb(2) ...

         (after the NOFSymmetry ... keyword line) which includes parameters

            ALFA, BETA  determines whether the charge addition/subtraction
                        is to occur in a spin alpha or beta orbital. Default is
                        spin alpha.

            qfukui      actual charge to be included in the calculation.
                        Positive values add charge to an unoccupied orbital
                        (LUMO in most cases) referring to f+(r), nucleophilic
                        attack. Negative values remove charge from an occupied
                        orbital (HOMO in most cases) referring to f-(r),
                        electrophilic attack. A meaningful value for f+/- is
                        +/-0.01.

            norb        number of orbitals involved in the calculation. All
                        norb orbitals to be defined in the following are varied
                        in their charge where the total (summed) charge amounts
                        to qfukui. Up to 20 orbitals (up to 5 per line, where
                        continuation lines simply continue with 'iorb(n)
                        worb(n) up to iorb(norb) occ(norb)...') can be included.

            iorb(i)     index of each orbital occupation to be changed in
                        the Fukui analysis. (Index iorb denotes the position in
                        the restart file.) For qfukui &lt; 0 each orbital must be
                        fully or partially occupied in the initial input
                        configuration (including usually the HOMO). For qfukui
                        &gt; 0 each orbital must be empty or partially occupied in
                        the initial input configuration (including usually the
                        LUMO).

            worb(i)     relative weight of each orbital whose occupation is to
                        be changed in the Fukui analysis. The sum of all
                        weights, W, is determined and the charge q(i) of each
                        orbital is calculated as qfukui*worb(i)/W.

         The Fukui input can be mixed with the above excitation definitions but
         must appear always after all excitation definitions. The complete
         configuration definition of the Fukui scheme must be terminated by a
         keyword line 'END'. NOTE: If combined with specific excitations using
         keyword EXCIted, then the END statement should appear only after both
         excitation and Fukui input are complete.

         The Fukui analysis is included in the output after the population
         analysis (if selected) where atom-projected Fukui indices are listed
         for both relaxed and frozen orbitals (in the latter case orbitals of
         the restart input file are used). In addition, both Fukui matrices are
         saved on unit 33 using format

         Record   1
            (6I4)     NFUKUI      Spin selection ( = 1 for alpha, = 2 for beta)
                      QFUKUI      Charge used to evaluate f+/- matrix
                      ISYM,IORB   Symmetry and sequence index of orbital used
                                  for analysis, here ISYM = 1.
                      NCNTRT      Dimension of Fukui matrix
                      NCNTSQ       = (NCNTRT+1)*NCNTRT/2
         Record   2
            (NCNTSQ*R8)           Fukui matrix elements (relaxed values) in
                                  tridiagonal form
         Record   3
            (NCNTSQ*R8)           Fukui matrix elements (frozen orbital values)
                                  in tridiagonal form

         Further, the DRAW option allows to plot contour lines of the Fukui
         function, see <a href="#e.5)">e.5)</a>.

         The Fukui option can be used also in a properties-only run (parameter
         CPROp, see <a href="#c.1)">c.1)</a> if output unit 33 from a previous Fukui run is
         provided as input.

Examples of molecules:

  a)  H2O, C2v symmetry, no block-diagonal (i.e. no symmetrization) KS matrix
      and Aufbau principle occupation
          &gt;TITLE
          &gt;H2O with symmetry but no block diag. KS matrix, Aufbau principle
          &gt;SYMM C2V
          &gt;CART BOHR
          &gt;  O     0.0        0.0   0.0    8.0    35
          &gt;  H     1.4596     0.0   1.1354 1.0    32
          &gt;END
          &gt;RUNTYPE STARTUP NO-OPT
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0.0
          &gt;NOFSYM AUFBAU
          &gt;DMIX  MDENS 0.45
          &gt;DIIS  ON
          &gt;END
          &gt;A-OXYGEN (5,2;5,2)
          &gt;A-HYDROGEN (5,1;5,1)
          &gt;O-OXYGEN (5211/411/1)
          &gt;O-HYDROGEN (41/1)
          &gt;END

  b)  H2O, C2v symmetry, no block-diagonal KS matrix and fixed occupation
      (taken from the output of the previous run).
          &gt;TITLE
          &gt;H2O with symmetry and no block-diag. KS matrix, fixed occupations
          &gt;SYMM C2V
          &gt;CART BOHR
          &gt;  O     0.0        0.0   0.0    8.0    35
          &gt;  H     1.4596     0.0   1.1354 1.0    32
          &gt;END
          &gt;RUNTYPE STARTUP NO-OPT
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0.0
          &gt;NOFSYM SCFOCCUP
          &gt;ALFA 5 0
          &gt;BETA 5 0
          &gt;DMIX  MDENS 0.45
          &gt;END
          &gt;A-OXYGEN (5,2;5,2)
          &gt;A-HYDROGEN (5,1;5,1)
          &gt;O-OXYGEN (5211/411/1)
          &gt;O-HYDROGEN (41/1)
          &gt;END

  c)  H2O, C2v symmetry, no block-diagonal KS matrix and fixed
      occupation including a HOMO-LUMO excitation (singlet state) with
      fractional occupancy of 0.5 (Slater transition state method).
          &gt;TITLE
          &gt;H2O with symmetry and no block-diag. KS matrix, fixed occupations
          &gt;WATER HOMO-LUMO excitation with Slater TSM
          &gt;SYMM C2V
          &gt;CART BOHR
          &gt;  O     0.0        0.0   0.0    8.0    35
          &gt;  H     1.4596     0.0   1.1354 1.0    32
          &gt;END
          &gt;RUNTYPE STARTUP NO-OPT
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0.0
          &gt;MAXCYC 35
          &gt;NOFSYM SCFOCCUP
          &gt;ALFA 6 2 5 0.5 6 0.5
          &gt;BETA 5 0
          &gt;DMIX  MDENS 0.45
          &gt;DIIS  ON
          &gt;END
          &gt;A-OXYGEN (5,2;5,2)
          &gt;A-HYDROGEN (5,1;5,1)
          &gt;O-OXYGEN (5211/411/1)
          &gt;O-HYDROGEN (41/1)
          &gt;END

  d)  An alternative to the above using EXCITED keyword with SCFOCC:
      H2O, C2v symmetry, no block-diagonal KS matrix and fixed
      occupation including a HOMO-LUMO excitation (singlet state) with
      fractional occupancy of 0.5 (Slater transition state method).
          &gt;TITLE
          &gt;H2O with symmetry and no block-diag. KS matrix, fixed occupations
          &gt;WATER HOMO-LUMO excitation with Slater TSM
          &gt;SYMM C2V
          &gt;CART BOHR
          &gt;  O     0.0        0.0   0.0    8.0    35
          &gt;  H     1.4596     0.0   1.1354 1.0    32
          &gt;END
          &gt;RUNTYPE STARTUP NO-OPT
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0.0
          &gt;MAXCYC 35
          &gt;NOFSYM SCFOCCUP EXCITED
          &gt;ALFA 6
          &gt;BETA 5
          &gt;SYM 1
          &gt;ALFA 0 2 5 0.5 6 0.5
          &gt;BETA 0 0
          &gt;END
          &gt;DMIX  MDENS 0.45
          &gt;DIIS  ON
          &gt;END
          &gt;A-OXYGEN (5,2;5,2)
          &gt;A-HYDROGEN (5,1;5,1)
          &gt;O-OXYGEN (5211/411/1)
          &gt;O-HYDROGEN (41/1)
          &gt;END

  e)  An evaluation of atom-projected Fukui indices (f-, electrophilic
      indices) of CO. Restart from neutral CO with occupation  (7,7)
          &gt;TITLE
          &gt;CO molecule ground state, Fukui charge -0.01
          &gt;NOSYMM
          &gt;CARTESIAN BOHR
          &gt;  C    0.0000   0.00000  0.00000   6.  32
          &gt;  O    0.0000   0.00000  2.15000   8.  32
          &gt;END
          &gt;RUNTYPE RESTART NEWOCC
          &gt;SCFTYPE DIRECT
          &gt;POTENTIAL NONLOCAL PD91 PD91
          &gt;GRID FINE NONRANDOM
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0
          &gt;MAXCYCLES 50
          &gt;ECONVERGENCE .0000001
          &gt;DCONVERGENCE .0000001
          &gt;DMIXING MDENS 0.40
          &gt;DIIS NEW 7
          &gt;NOFSYM SCFOCCUP EXCITED
          &gt;ALFA 7
          &gt;BETA 7
          &gt;FUKUI ALFA -.01 1 7 1.0
          &gt;END
          &gt;VIRT ALL
          &gt;MULL ON FULL
          &gt;ORBI 5D
          &gt;END
          &gt;A-CARBON (4,4;4,4)
          &gt;A-OXYGEN (4,4;4,4)
          &gt;O-CARBON (631/31/1)
          &gt;O-OXYGEN (631/31/1)
          &gt;END

  f)  An evaluation of atom-projected Fukui indices (f+, nucleophilic
      indices) of CO. Restart from neutral CO with occupation  (7,7)
          &gt;TITLE
          &gt;CO molecule ground state, Fukui charge +0.01
          &gt;NOSYMM
          &gt;CARTESIAN BOHR
          &gt;  C    0.0000   0.00000  0.00000   6.  32
          &gt;  O    0.0000   0.00000  2.15000   8.  32
          &gt;END
          &gt;RUNTYPE RESTART NEWOCC
          &gt;SCFTYPE DIRECT
          &gt;POTENTIAL NONLOCAL PD91 PD91
          &gt;GRID FINE NONRANDOM
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0
          &gt;MAXCYCLES 50
          &gt;ECONVERGENCE .0000001
          &gt;DCONVERGENCE .0000001
          &gt;DMIXING MDENS 0.40
          &gt;DIIS NEW 7
          &gt;NOFSYM SCFOCCUP EXCITED
          &gt;ALFA 8
          &gt;BETA 7
          &gt;SYM 1
          &gt;ALFA 0 1 8 0.0
          &gt;BETA 0 0
          &gt;FUKUI ALFA .01 1 8 1.0
          &gt;END
          &gt;VIRT ALL
          &gt;MULL ON FULL
          &gt;ORBI 5D
          &gt;END
          &gt;A-CARBON (4,4;4,4)
          &gt;A-OXYGEN (4,4;4,4)
          &gt;O-CARBON (631/31/1)
          &gt;O-OXYGEN (631/31/1)
          &gt;END

Examples of atoms:

  a)  C atom, no block-diagonal KS matrix and Aufbau principle
      occupation, "broken symmetry" (s and d-sigma can mix) s,p,d orbitals with
      non-spherical electron density.
          &gt;TITLE
          &gt;C nonspherical atom with NOFSYM
          &gt;SYMM D2H
          &gt;CARTESIAN BOHR
          &gt;  C   0.00000    0.00000   0.00000   6.0   35
          &gt;END
          &gt;RUNTYPE  STARTUP NO-OPTI
          &gt;GRID FINE RANDOM
          &gt;MULTIPLICITY 3
          &gt;CHARGE 0.
          &gt;DMIXING MDENS 0.3
          &gt;DIIS ON
          &gt;NOFSYM AUFBAU
          &gt;END
          &gt;A-CARBON (5,2;5,2)
          &gt;O-CARBON (621/41/1*)
          &gt;END


-----------------------------------------------------------------------------
                                                      <a name="b.5)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.5)  FSYMmetry  [AUFBau, SCFOccupation]</b>
-----------------------------------------------------------------------------

The StoBe code uses symmetry in two ways: to generate the equivalent centers
and only treat the non-equivalent centers in the numerical integration of the
exchange-correlation potentials and to generate a symmetry-adapted basis for
the expansion of the Kohn-Sham orbitals. Using symmetry on the grid can
substantially reduce the time for each iteration, while using the keyword
FSYM to symmetrize the orbitals results in a block-diagonal Kohn-Sham matrix
which improves convergence and leads to more easily identified symmetry
orbitals and facilitates the analysis of the resulting molecular or atomic
state.

Block-diagonalization of the Kohn-Sham matrix may lead to small increases in
the total energy compared to the case without symmetry-blocking (keyword
NOFSym) depending on whether or not orbital symmetry-breaking occurs in the
case without symmetry-blocking.

The keyword line

     FSYMmetry  AUFBau  [ALphabeta]
         (default setting) uses symmetry-based block-diagonalization of the
         Kohn-Sham matrix and determines the occupation of orbitals by the
         Aufbau principle (orbitals are filled with increasing KS 1-electron
         energy up to the HOMO). Occupations are allowed to change between
         different symmetry representations in the course of an SCF iteration
         which is indicated in the print output. The Aufbau principle can be
         used together with the level smear option, see keyword SMEAr.

         NOTE that in atom calculations with full rotational symmetry and
         explicit shell occupation by option CONFig, see <a href="#b.7)">b.7)</a>, keywords AUFBau
         and ALphabeta are ignored and corresponding fixed occupations are
         used, see below.

         The optional keyword ALphabeta does an overall aufbau using both
         alpha and beta spin orbitals together. This procedure does not
         necessarily preserve the total spin between iterations.

     FSYMmetry  SCFOccupation  [EXCIted]
         uses symmetry-based block-diagonalization of the Kohn-Sham matrix
         and defines a fixed occupation scheme by giving the number of
         occupied alpha and beta orbitals for each symmetry representation.
         The occupation information starts on new lines as

           ALFA  na1  na2  na3  ...  nansym
           BETA  nb1  nb2  nb3  ...  nbnsym

         where nai, nbi are the occupation numbers of alpha and beta orbitals
         of each symmetry representation i, i = 1 ... nsym (including
         orbitals whose occupations are given explicitly, see below!). These
         occupation numbers are kept fixed in the SCF calculation irrespective
         of the Aufbau principle. Note that the definition of the numbers
         following the 'ALFA' and 'BETA' keywords are somewhat different when
         used for atoms, see below. Fixed occupations are incompatible with the
         level smear option, see keyword SMEAr.

         Starting from the above occupation scheme, excited configurations
         (within the single KS determinant representation) can be defined.
         Here the occupation of orbitals in each symmetry representation can
         be defined individually. Examples are excited states via the Slater
         transition state method (fractional occupations are allowed) or
         broken symmetry cases (see option keyword UNREstricted). This
         option requires the optional keyword EXCIted on the keyword line and
         additional lines of input as follows

           SYMmetry  isym
           ALFA  idum  leva   na1 occa1  na2 occa2  ...  nleva occleva
           BETA  idum  levb   nb1 occb1  nb2 occb2  ...  nlebv occlevb

         where the line starting with 'SYMmetry' defines the index isym of a
         symmetry representation. On the following line starting with 'ALFA',
         leva denotes the number of alpha orbitals (&lt; 10) in representation
         isym whose occupations are to be given explicitly, followed by leva
         pairs of numbers (na1, occai) defining the orbital index nai and the
         orbital occupation occai. The following line starting with 'BETA'
         contains the analogous input for beta orbitals. (Parameters idum are
         dummies left for compatibility reasons.) Both 'ALFA' and 'BETA' lines
         are required in the input. The occupation information lines can be
         repeated if more than 9 alpha or beta orbital occupations are to be
         defined. The complete configuration definition of excited states must
         be terminated by a keyword line 'END'.  Note that all symmetry
         orbitals occurring in the global occupation scheme (see above) but not
         specified explicitly by occupations retain an occupation of 1.

         The excited configuration scheme can also be used to evaluate Fukui
         functions and indices [PY84,PY89] within the finite difference
         approximation. This requires a restart from an initial configuration
         (with or without excitations), see <a href="#c.1)">c.1)</a>, where an artificial
         excitation is introduced in addition by changing the occupation of a
         specific orbital by a small amount (e.g. 0.01 electrons, Fukui
         charge). A comparison of the self-consistent solution with Fukui
         charge with the initial restart input is used to evaluate Fukui
         functions and indices. The Fukui charge excitation is defined by a
         keyword line

           FUKUi [ALFA, BETA]  qfukui norb isym(1) iorb(1) worb(1) isym(2) ...

         (after the FSYM ... keyword line) which includes parameters

            ALFA, BETA  determines whether the charge addition/subtraction
                        is to occur in a spin alpha or beta orbital. Default is
                        spin alpha.

            qfukui      actual charge to be included in the calculation.
                        Positive values add charge to an unoccupied orbital
                        (LUMO in most cases) referring to f+(r), nucleophilic
                        attack. Negative values remove charge from an occupied
                        orbital (HOMO in most cases) referring to f-(r),
                        electrophilic attack. A meaningful value for f+/- is
                        +/-0.01.

            norb        number of orbitals involved in the calculation. All
                        norb orbitals to be defined in the following are varied
                        in their charge where the total (summed) charge amounts
                        to qfukui. Up to 20 orbitals (up to 5 per line, where
                        continuation lines simply continue with 'iorb(n)
                        worb(n) up to iorb(norb) occ(norb)...') can be included.

            isym(i), iorb(i)  symmetry and orbital index of each orbital whose
                        occupation is to be changed in the Fukui analysis.
                        (Indices isym/iorb refer to the position in the restart
                        file.) For qfukui &lt; 0 each orbital must be fully or
                        partially occupied in the initial input configuration
                        (including usually the HOMO). For qfukui &gt; 0 each
                        orbital must be empty or partially occupied in the
                        initial input configuration (including usually the
                        LUMO).

            worb(i)     relative weight of each orbital whose occupation is to
                        be changed in the Fukui analysis. The sum of all
                        weights, W, is determined and the charge q(i) of each
                        orbital is calculated as qfukui*worb(i)/W.

         The Fukui input can be mixed with the above excitation definitions but
         must appear always after all excitation definitions. The complete
         configuration definition of the Fukui scheme must be terminated by a
         keyword line 'END'. NOTE: If combined with specific excitations using
         keyword EXCIted, then the END statement should appear only after both
         excitation and Fukui input are complete.

         The Fukui analysis is included in the output after the population
         analysis (if selected) where atom-projected Fukui indices are listed
         both relaxed and frozen orbitals (in the latter case orbitals of the
         restart input file are used). In addition, both Fukui matrices are
         saved on unit 33 using format

         Record   1
            (6I4)     NFUKUI      Spin selection ( = 1 for alpha, = 2 for beta)
                      QFUKUI      Charge used to evaluate f+/- matrix
                      ISYM,IORB   Symmetry and sequence index of orbital used
                                  for analysis
                      NCNTRT      Dimension of Fukui matrix
                      NCNTSQ       = (NCNTRT+1)*NCNTRT/2
         Record   2
            (NCNTSQ*R8)           Fukui matrix elements (relaxed values) in
                                  tridiagonal form
         Record   3
            (NCNTSQ*R8)           Fukui matrix elements (frozen orbital values)
                                  in tridiagonal form

         Further, the DRAW option allows to plot contour lines of the Fukui
         function, see <a href="#e.5)">e.5)</a>.

         The Fukui option can be used also in a properties-only run (parameter
         CPROp, see <a href="#c.1)">c.1)</a> if output unit 33 from a previous Fukui run is
         provided as input.

Examples of molecules:

  a)  H2O, C2v symmetry with block-diagonalization (i.e. symmetrization) of
      the KS matrix and Aufbau principle occupation
          &gt;TITLE
          &gt;H2O with symmetry and block-diag. KS matrix, Aufbau principle
          &gt;SYMM C2V
          &gt;CART BOHR
          &gt;  O     0.0        0.0   0.0    8.0    35
          &gt;  H     1.4596     0.0   1.1354 1.0    32
          &gt;END
          &gt;RUNTYPE STARTUP NO-OPT
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0.0
          &gt;FSYM AUFBAU
          &gt;DMIX  MDENS 0.45
          &gt;DIIS  ON
          &gt;END
          &gt;A-OXYGEN (5,2;5,2)
          &gt;A-HYDROGEN (5,1;5,1)
          &gt;O-OXYGEN (5211/411/1)
          &gt;O-HYDROGEN (41/1)
          &gt;END

  b)  H2O, C2v symmetry with block-diagonalization of the KS matrix and fixed
      occupation (taken from the output of the previous run).
          &gt;TITLE
          &gt;H2O with symmetry and block-diag. KS matrix, fixed occupations
          &gt;SYMM C2V
          &gt;CART BOHR
          &gt;  O     0.0        0.0   0.0    8.0    35
          &gt;  H     1.4596     0.0   1.1354 1.0    32
          &gt;END
          &gt;RUNTYPE STARTUP NO-OPT
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0.0
          &gt;FSYM SCFOCCUP
          &gt;ALFA 3 1 1 0
          &gt;BETA 3 1 1 0
          &gt;DMIX  MDENS 0.45
          &gt;END
          &gt;A-OXYGEN (5,2;5,2)
          &gt;A-HYDROGEN (5,1;5,1)
          &gt;O-OXYGEN (5211/411/1)
          &gt;O-HYDROGEN (41/1)
          &gt;END

  c)  H2O, C2v symmetry with block-diagonalization of the KS matrix and fixed
      occupation including a HOMO-LUMO excitation (singlet state) with
      fractional occupancy of 0.5 (Slater transition state method). Note that
      ALL orbitals involved must be specified in the occupation input
      following the SCFOccup line, i.e. the alfa spin a1 occupation here
      becomes four.
          &gt;TITLE
          &gt;H2O with symmetry and block-diag. KS matrix, fixed occupations
          &gt;WATER HOMO-LUMO excitation with Slater TSM
          &gt;SYMM C2V
          &gt;CART BOHR
          &gt;  O     0.0        0.0   0.0    8.0    35
          &gt;  H     1.4596     0.0   1.1354 1.0    32
          &gt;END
          &gt;RUNTYPE STARTUP NO-OPT
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0.0
          &gt;MAXCYC 35
          &gt;FSYM SCFOCCUP EXCITED
          &gt;ALFA 4 0 2 0
          &gt;BETA 3 0 2 0
          &gt;SYM 1
          &gt;ALFA 0 2  3 0.5  4 0.5
          &gt;BETA 0 0
          &gt;END
          &gt;DMIX  MDENS 0.45
          &gt;DIIS  ON
          &gt;END
          &gt;A-OXYGEN (5,2;5,2)
          &gt;A-HYDROGEN (5,1;5,1)
          &gt;O-OXYGEN (5211/411/1)
          &gt;O-HYDROGEN (41/1)
          &gt;END

  d)  An evaluation of atom-projected Fukui indices (f-, electrophilic
      indices) of CO. Restart from neutral CO with occupation  (50002, 50002)
          &gt;TITLE
          &gt;CO molecule ground state, Fukui charge -0.01
          &gt;SYMM C4V
          &gt;CARTESIAN BOHR
          &gt;  C    0.0000   0.00000  0.00000   6.  32
          &gt;  O    0.0000   0.00000  2.15000   8.  32
          &gt;END
          &gt;RUNTYPE RESTART NEWOCC
          &gt;SCFTYPE DIRECT
          &gt;POTENTIAL NONLOCAL PD91 PD91
          &gt;GRID FINE NONRANDOM
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0
          &gt;MAXCYCLES 50
          &gt;ECONVERGENCE .0000001
          &gt;DCONVERGENCE .0000001
          &gt;DMIXING MDENS 0.40
          &gt;DIIS NEW 7
          &gt;FSYM SCFOCC EXCITED
          &gt;ALFA 5 0 0 0 2
          &gt;BETA 5 0 0 0 2
          &gt;FUKUI ALFA -.01 1 1 5 1.
          &gt;END
          &gt;VIRT ALL
          &gt;MULL ON FULL
          &gt;ORBI 5D
          &gt;END
          &gt;A-CARBON (4,4;4,4)
          &gt;A-OXYGEN (4,4;4,4)
          &gt;O-CARBON (631/31/1)
          &gt;O-OXYGEN (631/31/1)
          &gt;END

  e)  An evaluation of atom-projected Fukui indices (f+, nucleophilic
      indices) of CO. Restart from neutral CO with occupation  (50002, 50002)
          &gt;TITLE
          &gt;CO molecule ground state, Fukui charge +0.01
          &gt;SYMM C4V
          &gt;CARTESIAN BOHR
          &gt;  C    0.0000   0.00000  0.00000   6.  32
          &gt;  O    0.0000   0.00000  2.15000   8.  32
          &gt;END
          &gt;RUNTYPE RESTART NEWOCC
          &gt;SCFTYPE DIRECT
          &gt;POTENTIAL NONLOCAL PD91 PD91
          &gt;GRID FINE NONRANDOM
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0
          &gt;MAXCYCLES 50
          &gt;ECONVERGENCE .0000001
          &gt;DCONVERGENCE .0000001
          &gt;DMIXING MDENS 0.40
          &gt;DIIS NEW 7
          &gt;FSYM SCFOCC EXCITED
          &gt;ALFA 5 0 0 0 3
          &gt;BETA 5 0 0 0 2
          &gt;SYM 5
          &gt;ALFA 0 1 3 0.0
          &gt;BETA 0 0
          &gt;FUKUI ALFA .01 1 5 3 1.
          &gt;END
          &gt;VIRT ALL
          &gt;MULL ON FULL
          &gt;ORBI 5D
          &gt;END
          &gt;A-CARBON (4,4;4,4)
          &gt;A-OXYGEN (4,4;4,4)
          &gt;O-CARBON (631/31/1)
          &gt;O-OXYGEN (631/31/1)
          &gt;END

Calculations for atoms are more difficult than those for molecules. This is
due to the rotational symmetry and the more general "multiplet problem" in
DFT discussed, for example, in Refs. [D94] and [S95]. In all cases it is
suggested to use the generic atom symmetry (SYMMetry ATOM), see <a href="#a.4)">a.4)</a>. Open
shell atoms can be treated either as "spherical" atoms or non-spherical atoms:

  1) Atoms with closed atomic shells or only s-type open shells are spherical
     by their nature. Others can be forced to exhibit spherical total
     electron density by introducing fractional occupation numbers. This is
     particularly simple with the atom symmetry (SYMM ATOM) together with the
     CONFig option, see <a href="#b.7)">b.7)</a>. Note that the resulting solution in general does
     NOT correspond to a pure atomic state.

  2) Non-spherical atoms (with non-spherical total electron density) can be
     treated by integer occupation of pure (real) s,p,d orbitals. Since the state
     is determined by the occupations in a SINGLE-DETERMINANT picture and the
     program uses real orbitals, one must be careful to give occupations that
     produce a single-determinant spin and space representation of the
     desired atomic state. This is always possible for the highest
     spin-state, but low-spin open-shell states must be treated by considering
     the state-mixing induced by giving only the spin-orbital occupations.

For fixed atom occupations using the generic atom symmetry, the occupation
numbers given on the two lines following the keyword line with keyword
'SCFOccupation' are different in their definitions from those of the molecular
case. The lines

   ALFA  ns   npx  npy  npz   ndz2  ndx2-y2  ndxy  ndxz  ndyz
   BETA  ns   npx  npy  npz   ndz2  ndx2-y2  ndxy  ndxz  ndyz

define the total occupation of all s, px, py, pz, dz2, dx2-y2, dxy, dxz, dyz
orbitals of alpha and beta spin, respectively.

Examples of atoms:

  a)  C atom with block-diagonalization of the KS matrix and
      Aufbau principle occupation, pure s,p,d orbitals with non-spherical
      electron density.
          &gt;TITLE
          &gt;C  atom,  non-spherical
          &gt;SYMM ATOM
          &gt;CARTESIAN BOHR
          &gt;  C   0.00000    0.00000   0.00000   6.0   35
          &gt;END
          &gt;RUNTYPE  STARTUP NO-OPTI
          &gt;GRID FINE RANDOM
          &gt;MULTIPLICITY 3
          &gt;CHARGE 0.
          &gt;DMIXING MDENS 0.3
          &gt;DIIS ON
          &gt;FSYM AUFBAU
          &gt;END
          &gt;A-CARBON (5,2;5,2)
          &gt;O-CARBON (621/41/1*)
          &gt;END

  b)  C atom with block-diagonalization of the KS matrix and
      fixed occupations, pure s,p,d orbitals with non-spherical
      electron density.
          &gt;TITLE
          &gt;C  atom,  non-spherical, fixed occupations
          &gt;SYMM ATOM
          &gt;CARTESIAN BOHR
          &gt;  C   0.00000    0.00000   0.00000   6.0   35
          &gt;END
          &gt;RUNTYPE  STARTUP NO-OPTI
          &gt;GRID FINE RANDOM
          &gt;MULTIPLICITY 3
          &gt;CHARGE 0.
          &gt;DMIXING MDENS 0.3
          &gt;DIIS ON
          &gt;FSYM SCFOCC
          &gt;ALFA 2 1 0 1 0 0 0 0 0
          &gt;BETA 2 0 0 0 0 0 0 0 0
          &gt;END
          &gt;A-CARBON (5,2;5,2)
          &gt;O-CARBON (621/41/1*)
          &gt;END

  c)  C atom with block-diagonalization of the KS matrix and
      fixed occupations, fractional p occupations with spherical
      electron density. This produces equivalent orbitals, but corresponds
      to a mixture of atomic states.
          &gt;TITLE
          &gt;C  atom,  non-spherical, fixed occupations
          &gt;SYMM ATOM
          &gt;CARTESIAN BOHR
          &gt;  C   0.00000    0.00000   0.00000   6.0   35
          &gt;END
          &gt;RUNTYPE  STARTUP NO-OPTI
          &gt;GRID FINE RANDOM
          &gt;MULTIPLICITY 1
          &gt;CHARGE 0.
          &gt;DMIXING MDENS 0.3
          &gt;DIIS ON
          &gt;FSYM AUFBAU
          &gt;CONFIG 2 1 0 2 1 0
          &gt;END
          &gt;A-CARBON (5,2;5,2)
          &gt;O-CARBON (621/41/1*)
          &gt;END

  d)  C atom with block-diagonalization of the KS matrix and fixed occupations,
      pure s,p,d orbitals (s and d-sigma can mix) with non-spherical electron
      density, 2s -&gt; 2p excitation, total spin projection Ms=1 (corresponding
      to a triplet state if it had been high-spin).
          &gt;TITLE
          &gt;C  atom,  non-spherical, fixed occupations
          &gt;SYMM D2H
          &gt;CARTESIAN BOHR
          &gt;  C   0.00000    0.00000   0.00000   6.0   35
          &gt;END
          &gt;RUNTYPE  STARTUP NO-OPTI
          &gt;GRID FINE RANDOM
          &gt;MULTIPLICITY 3
          &gt;CHARGE 0.
          &gt;DMIXING MDENS 0.3
          &gt;DIIS ON
          &gt;FSYM SCFOCC
          &gt;ALFA 1 1 1 1 0 0 0 0 0
          &gt;BETA 2 0 0 0 0 0 0 0 0
          &gt;END
          &gt;A-CARBON (5,2;5,2)
          &gt;O-CARBON (621/41/1*)
          &gt;END

  e)  C atom with block-diagonalization of the KS matrix and fixed occupations,
      pure s,p,d orbitals (s and d-sigma can mix) with non-spherical electron
      density, alpha 2s -&gt; 3s excitation, triplet state. Note that ALL orbitals
      involved must be specified in the occupation input following the SCFOccup
      line, i.e. the alfa spin a1 occupation here becomes 3.
          &gt;TITLE
          &gt;C  atom,  non-spherical, fixed occupations
          &gt;SYMM D2H
          &gt;CARTESIAN BOHR
          &gt;  C   0.00000    0.00000   0.00000   6.0   35
          &gt;END
          &gt;RUNTYPE  STARTUP NO-OPTI
          &gt;GRID FINE RANDOM
          &gt;MULTIPLICITY 3
          &gt;CHARGE 0.
          &gt;DMIXING MDENS 0.3
          &gt;DIIS ON
          &gt;FSYM SCFOCC EXCITED
          &gt;ALFA 3 1 0 1 0 0 0 0 0
          &gt;BETA 2 0 0 0 0 0 0 0 0
          &gt;SYM 1
          &gt;ALFA 0  2   2 0.  3 1.
          &gt;BETA 0  0
          &gt;END
          &gt;END
          &gt;A-CARBON (5,2;5,2)
          &gt;O-CARBON (621/41/1*)
          &gt;END

  f)  C atom with block-diagonalization of the KS matrix and fixed occupations,
      pure s,p,d orbitals (s and d-sigma can mix) with non-spherical electron
      density, HOMO hole state, doublet.
          &gt;TITLE
          &gt;C atom: Ionization from HOMO
          &gt;SYMM D2H
          &gt;CARTESIAN BOHR
          &gt;  C   0.00000    0.00000   0.00000   6.0   35
          &gt;END
          &gt;RUNTYPE  STARTUP NO-OPTI
          &gt;MULTIPLICITY 2
          &gt;CHARGE 1.
          &gt;DMIXING MDENS 0.3
          &gt;DIIS ON
          &gt;FSYM AUFBAU
          &gt;END
          &gt;A-CARBON (5,2;5,2)
          &gt;O-CARBON (621/41/1*)
          &gt;END

  g)  C atom with block-diagonalization of the KS matrix and fixed occupations,
      pure s,p,d orbitals (s and d-sigma can mix) with non-spherical electron
      density, C1s hole state, quartet. Note that ALL orbitals involved must be
      specified in the occupation input following the SCFOccup line, i.e. the
      beta spin a1 occupation here is still 2, but the occupation of the 1s is
      set to zero. (The MULTIPLICITY is the formal one based on the initial
      occupations only, before modification of the occupation numbers. In the
      program only the spin projection is used.)
          &gt;TITLE
          &gt;C atom, Ionization from 1s, quartet state
          &gt;SYMM D2H
          &gt;CARTESIAN BOHR
          &gt;  C   0.00000    0.00000   0.00000   6.0   35
          &gt;END
          &gt;RUNTYPE STARTUP NO-OPTI
          &gt;MULTIPLICITY 3
          &gt;CHARGE 1.
          &gt;DMIXING MDENS 0.3
          &gt;DIIS ON
          &gt;FSYM SCFOCCUP EXCITED
          &gt;ALFA 2 1 0 1 0 0 0 0 0
          &gt;BETA 2 0 0 0 0 0 0 0 0
          &gt;SYM 1
          &gt;ALFA 0 0
          &gt;BETA 0 1 1 0.
          &gt;END
          &gt;END
          &gt;A-CARBON (5,2;5,2)
          &gt;O-CARBON (621/41/1*)
          &gt;END


-----------------------------------------------------------------------------
                                                      <a name="b.6)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.6)  SMEAr  [number]</b>
-----------------------------------------------------------------------------

For large systems with many orbital levels near the Fermi-level Ef, convergence
can be improved by assigning fractional occupation numbers to orbitals of
levels close to Ef. Using the keyword SMEAr with a window parameter w (in eV)
places an energy window [Ef-w/2, Ef+w/2] around the Fermi-level in which
orbitals are fractionally occupied [Fxx]. For w &gt; 0, the occupations of all
levels within the energy window are replaced by values of a monotonic
occupation function n(E) where n(Ef-w)=1 and n(Ef+w)=0. (Thus, an orbital with
a lower energy will be assigned a larger occupation number.) The function n(E)
is determined iteratively to guarantee conservation of the total number of
electrons. If the separation between the highest occupied molecular orbital
(HOMO) and the lowest unoccupied molecular orbital (LUMO) is larger than w/2,
SMEAR will have no effect. A reasonable smear value is w = 0.3 eV where w = 0
(no fractional occupation) is the default.

Note that the smear option is incompatible with the DIIS extrapolation scheme,
see keyword DIIS.

Example:

     &gt;SMEAR  0.3


-----------------------------------------------------------------------------
                                                      <a name="b.7)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.7)  CONFiguration  [SPIN]  nas  nap  nad  nbs  nbp  nbd</b>
-----------------------------------------------------------------------------

For StoBe calculations on free atoms using the full rotational symmetry
(symmetry label ATOM, see <a href="#a.4)">a.4)</a> this keyword allows to define a global
configuration by the occupation numbers

   nas   of s electrons (from all shells) with spin alpha
   nap   of p electrons (from all shells) with spin alpha
   nad   of d electrons (from all shells) with spin alpha
   nbs   of s electrons (from all shells) with spin beta
   nbp   of p electrons (from all shells) with spin beta
   nbd   of d electrons (from all shells) with spin beta

The occupation numbers are averaged over the different orbitals of the p
(px,py,pz) and d (dz2,dx2-y2,dxy,dxz,dyz) shells using fractional occupations
if required. Averaging over shells irrespective of spin results in a singlet
state.

With the optional keyword "SPIN" the average is performed over spin-shells
(alpha, beta) separately and allows to treat higher multiplet states in an
approximate way.

NOTE that the keyword CONFiguration MUST be combined with the full rotational
symmetry (symmetry label ATOM, see <a href="#a.4)">a.4)</a>. Further, other explicit orbital
occupations given by options 'NOFSym SCFOccupation' or 'FSYM SCFOccupation',
see <a href="#b.4)">b.4)</a> and <a href="#b.5)">b.5)</a>, must omitted.

Examples:

a) Averaged singlet state of nickel

     &gt;TITLE
     &gt;Ni spherical atom 3d9 4s1  (shell average)
     &gt;SYMM ATOM
     &gt;CARTESIAN BOHR
     &gt; Ni   0.00000    0.00000   0.00000  28.0   32
     &gt;END
     &gt;RUNTYPE START
     &gt;MULTIPLICITY 1
     &gt;CHARGE 0
     &gt;MAXCYCLES 100
     &gt;GRID FINE NONRANDOM
     &gt;ECONVERGENCE 0.0000001
     &gt;DCONVERGENCE 0.0000001
     &gt;DIIS NEW 7
     &gt;ORBITAL 5D
     &gt;FSYM AUFBAU
     &gt;CONFIG 4 6 5 3 6 4
     &gt;VIRT ALL
     &gt;END
     &gt;A-NICKEL (5,5;5,5)
     &gt;O-NICKEL (63321/5211*/311+)
     &gt;END

b) Averaged triplet state of nickel

     &gt;TITLE
     &gt;Ni spherical atom 3d9 4s1  (spin shell average)
     &gt;SYMM ATOM
     &gt;CARTESIAN BOHR
     &gt; Ni   0.00000    0.00000   0.00000  28.0   32
     &gt;END
     &gt;RUNTYPE START
     &gt;MULTIPLICITY 3
     &gt;CHARGE 0
     &gt;MAXCYCLES 100
     &gt;GRID FINE NONRANDOM
     &gt;ECONVERGENCE 0.0000001
     &gt;DCONVERGENCE 0.0000001
     &gt;DIIS NEW 7
     &gt;ORBITAL 5D
     &gt;FSYM AUFBAU
     &gt;CONFIG SPIN 4 6 5 3 6 4
     &gt;VIRT ALL
     &gt;END
     &gt;A-NICKEL (5,5;5,5)
     &gt;O-NICKEL (63321/5211*/311+)
     &gt;END


-----------------------------------------------------------------------------
                                                      <a name="b.8)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.8)  EXCIted  [ALFA, BETA]</b>
-----------------------------------------------------------------------------

This keyword allows to calculate excited states where holes are created in
specific orbitals achieved by level shifting. Keyword line

     EXCIted  ALFA  na1  na2  ...
          creates empty alpha orbitals where indices na1, na2, ... refer to
          the energetic order of KS one-electron energies. Up to 20 orbitals
          can be included on the keyword line.

     EXCIted  BETA  nb1  nb2  ...
          creates empty beta orbitals where indices nb1, nb2, ... refer to
          the energetic order of KS one-electron energies. Up to 20 orbitals
          can be included on the keyword line.

For the holes to be created, level shifts, see keyword LEVElshift, are required
to be larger than the energy difference between the HOMO level and the levels
to be emptied. A more efficient method to calculate these states is based on
using fixed occupations with the EXCIted option, see keywords FSYMmetry or
NOFSymmetry.


-----------------------------------------------------------------------------
                                                      <a name="b.9)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.9)  FIELd  Fx  fy  fz</b>
-----------------------------------------------------------------------------

This keyword includes an external electric field (Fx, Fy, Fz) (in cartesian
coordinates and atomic units, H/Bohr) in the electronic structure evaluation.
If a symmetry other than C1 is assumed the field direction will be checked for
compatibility (the field must not lower the symmetry). By default, no field is
applied.


-----------------------------------------------------------------------------
                                                      <a name="b.10)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.10)  SPINcontamination  [FULL]</b>
-----------------------------------------------------------------------------

This keyword evaluates the spin contamination by calculating the expectation
value &lt;S2&gt; and an effective multiplicity based on the Kohn-Sham MOs (assuming
occupancy = 1 for each occupied orbital). The optional parameter 'FULL'
includes a listing of the overlap matrix &lt;alpha|beta&gt; of all occupied orbitals
used to calculate the spin contamination

Example:

     &gt;SPINCONT FULL


-----------------------------------------------------------------------------
                                                      <a name="b.11)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.11)  REORder</b>
-----------------------------------------------------------------------------

Allows the reordering of orbitals from a previous SCF calculation to be used to
build the starting density in a restart run. The starting configuration is
defined by na triplets for spin up (alpha) orbitals and nb triplets for spin
down (beta) orbitals which are given on the lines after the keyword line. Each
triplet (isym, i, k) selects alpha/beta orbitals i, i+1, ... k of symmetry
representation isym in the restart file. Up to 6 triplets per line are used (up
to a total of 100 triplets). The orbital indices reflect the order within each
symmetry as given in the output listing of the SCF calculation whose restart
file is to be used as input. The orbital order may also be checked with utility
anlyz (option PORBitals), see Sec. 2.7.1. The general format reads as follows

     &gt;REORDER
     &gt;ALFA  na
     &gt;iasym(1) ia(1) ka(1)  iasym(2) ia(2) ka(2)  ...  iasym(6) ia(6) ka(6)
     &gt; ...
     &gt; ...    iasym(na) ia(na) ka(na)
     &gt;BETA  nb
     &gt;ibsym(1) ib(1) kb(1)  ibsym(2) ib(2) kb(2)  ...  ibsym(6) ib(6) kb(6)
     &gt; ...
     &gt; ...    ibsym(na) ib(na) kb(na)

Example:

     &gt; REORDER
     &gt; ALFA 7
     &gt; 1 1 2  1 4 4  1 3 3  1 5 7  1 9 9  2 1 7
     &gt; 3 1 3
     &gt; BETA 4
     &gt; 1 2 9  2 1 7  3 1 2  3 4 4

This defines a (hypothetical) configuration with orbital sets
alpha:   { 1 2 4 3 5 6 7 9 / 1 2 3 4 5 6 7 / 1 2 3}
beta:    { 2 3 4 5 6 7 8 9 / 1 2 3 4 5 6 7 / 1 2 4}
in three symmetry representations.


-----------------------------------------------------------------------------
                                                      <a name="b.12)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> b.12)  LOCAlize  nloc</b>
-----------------------------------------------------------------------------

Localize orbitals at nloc specific atom centers. This requires a previous run
to define the orbitals to localize. The localization is performed by
diagonalizing the R**2 matrix (in MO basis) with respect to each of the
requested nloc centers in sequence. The localization at the first center uses
all available occupied MOs and selects the requested number of orbitals as
localized based on the eigenvalues of the diagonal R**2 operator
(iorban(isym) lowest eigenvalues in each symmetry isym). For the next
center the R**2 matrix is set up with respect to that center, transformed to
MO basis (excluding the previously localized orbitals) and diagonalized. This
procedure preserves the previously localized orbitals and results in a set of
MOs where the first iorban(isym) in irreducible representation isym are
localized on the first specified center, the next set on the next requested
center etc. Note that the energetic order is not preserved, i.e. the orbitals
are now reordered according to the R**2 eigenvalues with respect to each
center for the selected orbitals and with respect to the last center for the
remaining ones. This can thus be used to put the core orbitals in a predefined
order in core excitation or core hole calculations, see examples below.

A parameter RMAX can be used to specify the maximum R**2 eigenvalue, e.g., in
the example below 9 localized orbitals are requested for a water molecule
embedded in a larger cluster of waters. The molecule itself carries 5 orbitals
and the additional 4 would be accepting lone-pairs or donated H-bonds
associated with neighboring waters, but only accepted if within a squared
distance of 26 (Bohr)**2.

Orbitals that should be excluded from the localization procedure can be
specified by the FROZen keyword which can be applied to either ALPHA or BETA
spin or the same parameters applied to both.

Note that, by applying the procedure to only the occupied orbitals the total
density is preserved. In case of degeneracies the program will try to resolve
them by diagonalizing in the sequence

(1) R**2
(2) X**2-Y**2
(3) 2xZ**2-X**2-Y**2
(4) X**2

To preserve the localized character of the orbitals, e.g., in an XAS or XPS
spectrum calculation, all localized core orbitals on centers other than the
active one (where the excitation/ionization originates) should be frozen
by using the SUPSYM keyword (note that the order of the orbitals is determined
by the order of localization).

The keyword line is followed by nloc sets of lines 1 to 5

   Line 1   (A4)  Atomlabel(i)

           This defines the atom center i considered for orbital localization.
           The label MUST be identical (except for leading blanks) to the
           label of the center used in the input.

   Line 2   (A4,20I)  'ALFA', (iorb, iorb = 1,nsym)

           This defines the number of alpha (spin up) orbitals to be localized
           in each symmetry on center Atomlabel(i).

   Line 3   (A4,20I)  'BETA', (iorb, iorb = 1,nsym)

           This defines the number of beta (spin down) orbitals to be
           localized in each symmetry on center Atomlabel(i).

Additional options:

   Line 4   (2A4)  FROZen [ALFA, BETA]

           This specifies orbitals that should be excluded from the
           localization procedure.  ALFA and/or BETA spin can be given
           separately or, if left out, the same parameters apply to both
           spin manifolds. The parameters are given in the same format as used
           with the SUPSym option for freezing orbitals in an SCF calculation.

           The FROZen keyword is followed by a specification of the number
           num1 of orbitals to be frozen and corresponding sequence numbers
           iorb(i), i = 1, num1

           Line 4a   (20I) num1
                Number orbitals that should be frozen.

           Line(s) 4b   (20I) iorb(1), iorb(2), ...,iorb(num1)
                Sequence numbers of orbitals that should be frozen. If more
                than 20 sequence numbers are to be provided they can be given
                on additional lines.

   Line 5   (A4,20I)  'RMAX'  R2max

           This defines the maximum R**2 eigenvalue accepted for a localized
           orbital. This can be used to guarantee that all relevant orbitals
           are found in cases of varying distances.

The LOCALIZE section needs to be terminated by a line reading 'END'.

Example 1:

     &gt; LOCALIZE
     &gt; O1
     &gt; ALFA 7
     &gt; BETA 0
     &gt; RMAX 26.
     &gt; END

defines a localization of 7 spin up orbitals at the center labeled 'O1' where
a radius square of 26. (radius slightly above 5) is considered.


Example 2:

XPS energy of carbon #6 in cytidine. Localize in sequence all the heavy atom
1s orbitals. Freeze all of them except C6 using supersymmetry (supsym) with
one orbital per representation. To compute C7 the same input is used, but with
the hole in orbital 10 (EXCITED) and orbital 9 frozen and 10 relaxed in the
SUPSYM input.

title
cytidine  compute xps energy for all heavier atoms (one at a time)
nosymm
cartesian angstrom
N1      0.38646326   -1.54649985    0.66531157  7.  32
N2     -0.08738194   -3.78380815   -0.08598576  7.  32
N3      0.65678252   -4.51297581   -2.12464257  7.  32
C1      0.93086113   -0.81560931    3.03141808  6.  32
C2      0.27418739   -0.48659819    1.66662656  6.  32
C3     -1.25360574    0.13338725    3.33272145  6.  32
C4      0.15064289    0.13118493    3.95253745  6.  32
C5      1.08672425   -1.30871792   -0.48041873  6.  32
C6      1.24580924   -2.26630584   -1.43488579  6.  32
C7      0.59055776   -3.52087309   -1.19374197  6.  32
C8     -0.17465968   -2.86962981    0.92715897  6.  32
C9     -2.22004073   -0.86362975    3.98181078  6.  32
O1     -1.09122955   -0.17376422    1.92312879  8.  32
O2     -0.68010463   -3.09724861    2.02059654  8.  32
O3     -2.50948314   -0.48787428    5.33869194  8.  32
O4      0.80848843    1.40890755    3.81360550  8.  32
O5      2.33322485   -0.62732755    3.03905717  8.  32
H       1.05002970   -4.35307374   -3.04719524  1.  32
H       0.11021281   -5.35529433   -1.95511616  1.  32
H       1.82446618   -2.06603579   -2.34003132  1.  32
H       1.52962973   -0.31372474   -0.58072057  1.  32
H       0.42704726    2.02012457    4.46876354  1.  32
H      -1.68265352    1.15141678    3.40568261  1.  32
H      -1.77243659   -1.86689718    4.01524978  1.  32
H      -3.13215705   -0.93155240    3.35777074  1.  32
H      -3.10596573    0.28600658    5.31318650  1.  32
H       0.14045634   -0.19711390    5.00652857  1.  32
H       0.72465240   -1.86086239    3.29378764  1.  32
H       2.46204101    0.34144288    3.14070687  1.  32
H       0.79849013    0.39233230    1.23364306  1.  32
end
nofsym scfocc excited
alfa 64
beta 64
sym 1
alfa 0 1 9 0.
beta 0 0
end
supsym alfa
range 16
 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 10 10
11 11 12 12 13 13 14 14 15 15 16 16 17 17
end
localize 17
N1
alfa 1
beta 0
N2
alfa 1
beta 0
N3
alfa 1
beta 0
C1
alfa 1
beta 0
C2
alfa 1
beta 0
C3
alfa 1
beta 0
C4
alfa 1
beta 0
C5
alfa 1
beta 0
C6
alfa 1
beta 0
C7
alfa 1
beta 0
C8
alfa 1
beta 0
C9
alfa 1
beta 0
O1
alfa 1
beta 0
O2
alfa 1
beta 0
O3
alfa 1
beta 0
O4
alfa 1
beta 0
O5
alfa 1
beta 0
end
runtype newocc no-opti
scftype direct
potential nonlocal RPBE PBE
grid fine random
multiplicity 1
charge 0
maxcycles 75
diis new 7
dmix mdens 0.1
econv 0.0000001
dconv 0.005
maxgeo 75
hessian 7
gconvergence 0.0001
mulliken full
ctrl
printout off
file gmolden
end


Example 3:

Evaluation of carbon #2 (C2) 1s excitations in pyridine using the transition
potential approach to calculate the corresponding XAS spectrum. Localize in
sequence the 1s orbitals of all other carbons (C1, C3, C4, C5) and freeze them
using supersymmetry (supsym) with one orbital per representation. This
calculation requires a restart output file from a previous groundstate
calculation. In the following, we list three input files, for (a) the ground
state, (b) the transition potental, and (c) the relaxed hole state
calculation. The restart file of (a) needs to be given as input to (b) and
(c).

(a) GROUND STATE CALCULATION

title
Pyridine C5NH5 ground state for NEXAFS
symm C1
cartesian angstrom
 N       1.39612966    0.00000000    0.00000000  7.0000   35
 C1      0.68882311    1.14824537    0.00000000  6.0000   35
 C2      0.68882311   -1.14824537    0.00000000  6.0000   35
 C3     -0.71283021    1.20331341    0.00000000  6.0000   35
 C4     -0.71283021   -1.20331341    0.00000000  6.0000   35
 C5     -1.42987148    0.00000000    0.00000000  6.0000   35
 H       1.27938895    2.07088516    0.00000000  1.0000   32
 H       1.27938895   -2.07088516    0.00000000  1.0000   32
 H      -1.22662201    2.16743392    0.00000000  1.0000   32
 H      -1.22662201   -2.16743392    0.00000000  1.0000   32
 H      -2.52352446    0.00000000    0.00000000  1.0000   32
end
runtype start
scftype direct
potential nonlocal RPBE PBE
grid fine nonrandom
multiplicity 1
charge 0
maxcycles 100
econvergence 0.0000001
dconvergence 0.0000001
dmixing mdens 0.1
diis new 7
virt all
print default
nofsym scfo
alfa 21
beta 21
end
GENA4 O-NITROGEN iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
O-NITROGEN iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
end

(b) TRANSITION POTENTIAL CALCULATION

title
Pyridine C5NH5 TP state for C2 1s NEXAFS
symm C1
cartesian angstrom
 N       1.40270041    0.00000000    0.00000000  7.0000   35
 C1      0.69106191    1.15092381    0.00000000  6.0000   35
 C2      0.69106191   -1.15092381    0.00000000  6.0000   35
 C3     -0.71373934    1.20353633    0.00000000  6.0000   35
 C4     -0.71373934   -1.20353633    0.00000000  6.0000   35
 C5     -1.43503389    0.00000000    0.00000000  6.0000   35
 H       1.28137718    2.07468149    0.00000000  1.0000   32
 H       1.28137718   -2.07468149    0.00000000  1.0000   32
 H      -1.22770180    2.16899074    0.00000000  1.0000   32
 H      -1.22770180   -2.16899074    0.00000000  1.0000   32
 H      -2.52940901    0.00000000    0.00000000  1.0000   32
end
runtype restart newocc
scftype direct
potential nonlocal RPBE PBE
grid fine nonrandom
multiplicity 1
charge 0
maxcycles 100
econvergence 0.0000001
dconvergence 0.0000001
dmixing mdens 0.1
diis new 7
virt all
print default
localize 4
C1
alfa 1
beta 0
C3
alfa 1
beta 0
C4
alfa 1
beta 0
C5
alfa 1
beta 0
end
supsym alfa
1
1
1
2
1
3
1
4
end
nofsym scfo
alfa 21 1 6 0.5
beta 21 0
xray xas
end
end
GENA4 O-NITROGEN iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
O-NITROGEN iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
end

(c) RELAXED HOLE STATE CALCULATION

title
Pyridine C5NH5  C2 1s hole state ionization potential
symm C1
cartesian angstrom
 N       1.40270041    0.00000000    0.00000000  7.0000   35
 C1      0.69106191    1.15092381    0.00000000  6.0000   35
 C2      0.69106191   -1.15092381    0.00000000  6.0000   35
 C3     -0.71373934    1.20353633    0.00000000  6.0000   35
 C4     -0.71373934   -1.20353633    0.00000000  6.0000   35
 C5     -1.43503389    0.00000000    0.00000000  6.0000   35
 H       1.28137718    2.07468149    0.00000000  1.0000   32
 H       1.28137718   -2.07468149    0.00000000  1.0000   32
 H      -1.22770180    2.16899074    0.00000000  1.0000   32
 H      -1.22770180   -2.16899074    0.00000000  1.0000   32
 H      -2.52940901    0.00000000    0.00000000  1.0000   32
end
runtype restart newocc
scftype direct
potential nonlocal RPBE PBE
grid fine nonrandom
multiplicity 1
charge 0
maxcycles 100
econvergence 0.0000001
dconvergence 0.0000001
dmixing mdens 0.1
diis new 7
virt all
print default
localize 4
C1
alfa 1
beta 0
C3
alfa 1
beta 0
C4
alfa 1
beta 0
C5
alfa 1
beta 0
end
supsym alfa
1
1
1
2
1
3
1
4
end
#nofsym scfo
#alfa 21
#beta 21
nofsym scfo
alfa 21 1 6 0.0
beta 21 0
end
GENA4 O-NITROGEN iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
GENA4 O-CARBON iii_iglo
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
A-HYDROGEN (3,1;3,1)
O-NITROGEN iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-CARBON iii_iglo
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
O-HYDROGEN (311/1)
end



<a name="2.2.3."><b>2.2.3.</a>  KEYWORDS FOR SCF ITERATION</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

-----------------------------------------------------------------------------
                                                      <a name="c.1)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.1)  RUNType  [STARtup, RESTart, CONTinue, CPROperties, NO-Optimize,</b>
                 (NOOPtimize,) OPTimize, NEWGeometry, NEWOccupation,
                 VIBRations, POLArizability, NEBcalculation]
-----------------------------------------------------------------------------

This keyword defines the type of calculation to be performed. Depending on the
run type up to two option keywords (which must be consistent) are needed where
all meaningful combinations are discussed in the following.

If starting from scratch, the initial density is generated from orbitals
obtained from a diagonalization of the one-electron matrix (i.e. neglecting
electron repulsion and the exchange-correlation potential).

---- NOTE -----------------------------------------------------------------
In single-image runs the final results are written onto a save file (fort.2).
In a restart this information is read from fort.1 so that the save file must
be copied onto fort.1 before a restart run.
---- NOTE -----------------------------------------------------------------

(A)  Single point SCF calculations for a fixed geometry

   RUNType  STARtup  NO-Optimize
        this starts a single point (fixed geometry) SCF calculation  from
        scratch ignoring any input from previous StoBe runs. This keyword line
        may be shortened to 'RUNType  STARtup'.

   RUNType  STARtup  NOOPtimize
        here keyword NOOPtimize means the same as NO-Optimize above and is
        included only for compatibility with previous deMon format input.

   RUNType  RESTart
        this restarts a single point (fixed geometry) SCF calculation if a
        previous run was not converged. Orbital occupation numbers are taken
        from the input file if defined (see keywords FSYM, NOFS), else from the
        restart file (in the latter case total charge and spin multiplicity of
        the input and restart files must agree). Atom coordinates are taken
        from the restart file. This run type requires additional file input
        (unit 1) from a previous StoBe run (single point SCF or geometry
        optimization). Using occupation or geometry input different from that
        of the restart file should/must be handled using keywords NEWOcc or
        NEWGeometry (see below).

   RUNType  RESTart  NEWGeometry
        this restarts a single point (fixed geometry) SCF calculation allowing
        a system geometry different from that of the previous SCF run. Atom
        coordinates are taken from the input file. Orbital occupation numbers
        are also taken from the input file if defined (see options FSYM, NOFS),
        else from the restart file (in the latter case total charge and spin
        multiplicity of the input and restart files must agree). This run type
        requires additional file input (unit 1) from a previous StoBe run
        (single point SCF or geometry optimization).
        This keyword line may be shortened to 'RUNType NEWGeometry'.

   RUNType  RESTart  NEWOccupation
        this restarts a single point (fixed geometry) SCF calculation allowing
        an orbital occupation different from that of the previous SCF run.
        Orbital occupation numbers must be provided explicitly in the input
        file (see options FSYM, NOFS), while atom coordinates are taken from
        the restart file. This run type requires additional file input (unit 1)
        from a previous StoBe run (single point SCF or geometry optimization).
        This keyword line may be shortened to 'RUNType NEWOccupation'.


(B)  Geometry optimizations involving SCF and force field iterations

   RUNType  STARtup  OPTimize
        this starts a geometry optimization from scratch and does not use any
        input from previous StoBe runs.
        This keyword line may be shortened to 'RUNType OPTimize'.

   RUNType  CONTinue
        this continues a geometry optimization where the starting geometry in
        the input file is ignored and the actual geometry of the restart file
        (unit 1) is taken. Orbital occupation numbers, if defined (see keywords
        FSYM, NOFS), and spin multiplicity of the input and restart files must
        agree. Force information of a previous geometry optimization restart
        file is used. This run type requires additional file input (unit 1)
        from a previous StoBe run (geometry optimization). NOTE that keyword
        CONTinue must NOT be combined with other keywords (like NEWGeometry or
        NEWOccupation) except VIBRations, see below.

   RUNType  OPTimize  NEWGeometry
        this starts a geometry optimization using a single point SCF restart
        file (unit 1) or a previous geometry optimization restart file. Initial
        orbital occupation numbers are taken from the input file if defined,
        see keywords FSYM, NOFS, else from the restart file. Initial atom
        coordinates are also taken from the input file. This run type requires
        additional file input (unit 1) from a previous StoBe run (single point
        SCF or geometry optimization).

   RUNType  OPTimize  NEWOccupation
        this starts a geometry optimization using a single point SCF restart
        file (unit 1) or a previous geometry optimization restart file. Initial
        orbital occupation numbers must be provided expicitly in the input
        file, see keywords FSYM, NOFS. Initial atom coordinates are taken from
        the restart file. This run type requires additional file input (unit 1)
        from a previous StoBe run (single point SCF or geometry optimization).
        This keyword line may also read 'RUNType NEWOccupation OPTimize'.


(C)  Reaction path optimization using the nudged-elatic-band (NEB) method
     [MJ94, MJG95, JMJ98, HUJ00] involving SCF and force field iterations along
     a path

   RUNType  STARtup  NEBcalculation
        this starts a NEB path optimization from scratch and does not use any
        input from previous StoBe runs. Additional control parameters
        determining the NEB run are provided by the keyword NEBParameters, see
        <a href="#e.12)">e.12)</a>.
        This keyword line may be shortened to 'RUNType NEBcalculation'.

   RUNType  RESTart  NEBcalculation
        this continues a NEB path optimization where the starting geometries
        of the nimg different images are ignored in the input file and
        replaced by those of the restart files (units nrbaseinp to
        nrbaseinp+nimg-1, see <a href="#e.13)">e.13)</a> and <a href="#a.1)">a.1)</a>) from a previous NEB run.
        Additional control parameters determining the NEB run are provided by
        the keyword NEBParameters, see <a href="#e.12)">e.12)</a>. This run type requires
        additional file input (units nrbase to nrbase+nimg-1) from a previous
        StoBe run (NEB path optimization)


(D)  Vibrational analysis

   RUNType  STARtup  VIBRations
        this starts a single point SCF calculation from scratch. This is
        followed by a vibrational analysis (vibrational eigenmodes and
        frequencies) based on finite differences of forces, where the initial
        input geometry is assumed to reflect the equilibrium geometry. Further
        parameters defining the vibrational analysis may be provided with
        keyword VIBRations, see <a href="#e.11)">e.11)</a>. See also notes below.

   RUNType  RESTart  VIBRations
        this starts a single point SCF calculation where orbital occupation
        numbers and atom coordinates are taken from the restart file (total
        charge and spin multiplicity of the input and restart files must
        agree). This is followed by a vibrational analysis, see above. This run
        type requires additional file input (unit 1) from a previous StoBe run
        (single point SCF, geometry optimization, no vibrational analysis!) and
        (optionally) a displacement vector file (unit 60), see <a href="#e.11)">e.11)</a>. For
        further comments on input parameters see NOTE above. See also notes
        below.

   RUNType  CONTinue  VIBRations
        this continues a vibrational analysis where the starting geometry in
        the input file is ignored and geometries of the restart file (unit 1)
        is taken. Orbital occupation numbers, if defined (see keywords FSYM,
        NOFS), and spin multiplicity of the input and restart files must agree.
        This run type requires additional file input (unit 1) from a previous
        StoBe run (vibrational analysis, displacement vector file, unit 60,
        is created from the restart file). For further comments on input
        parameters see NOTE above. See also notes below.

The vibrational analysis creates, in addition to list output of vibrational
frequencies (in harmonic approximation), dynamical dipoles, and displacement
vectors, corresponding output in Molekel format on file unit 59 which can be
used to visualize vibrational modes with the interactive graphics package
Molekel [MOL03]. Note that StoBe creates Molekel format files for vibrational
properties only.

NOTE that the vibrational analysis is subject to constraints in the input
parameters

  - The SCF runs for vibrational distortions must not use symmetry in the
    construction/diagonalization of the Kohn-Sham matrix even if the
    molecule/cluster has symmetry (defined by keyword SYMMetry, see <a href="#a.4)">a.4)</a>).
    Thus, keyword NOFSymmetry (together with options AUFBau or SCFOccupation)
    must be applied explicitly, see <a href="#b.4)">b.4)</a>.

  - For large systems the orbital selection according to maximum overlap,
    keyword MAXOverlap, see <a href="#c.9)">c.9)</a>, is suggested to avoid state transitions.

  - Atom or group constraints, see <a href="#d.5)">d.5)</a> and <a href="#d.6)">d.6)</a>, can be included in the
    vibrational analysis but have to be treated with care in order to avoid
    geometric incompatibilities. For example, constraining atom centers to
    motions which are symmetry forbidden should be avoided.

NOTE that vibrational modes of a system with symmetry higher than C1, if
calculated in one analysis run, are restricted to the highest symmetry
representation A (or A1, A1g). A full vibrational analysis, including all
symmetry representations, requires two subsequent analysis runs,

  - a first run with "RUNType ... VIBRations" where the full symmetry of the
    system is specified with keyword SYMMetry, option <a href="#a.4)">a.4)</a>. Further, the
    VIBRations keyword line, see <a href="#e.11)">e.11)</a>, has to read "VIBRations BASis". The
    vectors of symmetry-adapted vibrational distortions, file unit 60, have to
    be saved for the subsequent run.

  - a second run with "RUNType STARtup VIBRations" where the previous system is
    treated in C1 symmetry with all atom centers defined in the same order as
    in the first run. Further, the VIBRations keyword line, see <a href="#e.11)">e.11)</a>, has to
    read "VIBRations [modes] INPut [maxd]" where option [modes] can be left out
    or has to read "ALL" or "SELected".

NOTE that vibrational analyses and polarizability calculations, see (D) below,
have to be performed in separate StoBe runs.


(E)  Polarizability calculations

   RUNType [STARtup, RESTart] POLArizability
        this starts (or restarts) a single point SCF calculation, followed by
        three other SCF runs for the same geometry where homogeneous fields
        (E, 0, 0), (0, E, 0), (0, 0, E) are applied. The resulting dipole
        moments are evaluated and used to determine the static polarizability
        tensor of the system. The strength of the electric test field E
        (defaulted to 0.0005 au.) can be set separately by defining a
        homogeneous external electric field (Ex, Ey, Ez), see FIELd option,
        <a href="#b.9)">b.9)</a>, where E = sqrt(Ex*Ex+Ey*Ey+Ez*Ez) will be used in the
        polarizability calculations.

        By default, the SCF calculations following the first will be carried
        out as subsequent restart cases (except for free atoms/ions) which
        saves time but can introduce slight errors depending of the SCF
        convergence threshold. These SCF runs can be forced to start from
        scratch by option PSCRatch, see <a href="#e.6)">e.6)</a>. In polarization calculations on
        free atoms/ions SCF runs no. 2 - 4 will always start from scratch.

        NOTE that polarizability calculations and vibrational analyses, see (C)
        above, have to be performed in separate StoBe runs.

        Example:

             &gt;RUNType STARtup POLArization
             &gt;FIELd 0 0 .0002
             &gt;PSCRatch


(F)  Properties calculations

   RUNType  CPROperties
        this uses the restart file (unit 1) to do properties only: plots
        (keyword DRAW), population analyses and X-ray spectra, bypassing the
        SCF iteration and geometry optimization. No restart file will be
        written.

 NOTE that property options SYMMetry, NEWSymmetry, VIBRation, FREQuencies,
 RAMAn, which are available with keyword RUNType are not available so far.

The following table lists all keyword combinations that are accepted (and have
been tested) at present

         &gt;RUNType  STARtup                  ( = RUNType  STARtup  NO-Optimize)
         &gt;RUNType  RESTart
         &gt;RUNType  RESTart  NEWGeometry     ( = RUNType  NEWGeometry)
         &gt;RUNType  RESTart  NEWOccupation   ( = RUNType  NEWOccupation)
         &gt;RUNType  STARtup  OPTimize        ( = RUNType  OPTimize)
         &gt;RUNType  CONTinue
         &gt;RUNType  NEWGeometry  OPTimize    ( = RUNType  OPTimize  NEWGeometry)
         &gt;RUNType  NEWOccupation  OPTimize  ( = RUNType OPTimize NEWOccupation)
         &gt;RUNType  CPROperties
         &gt;RUNType  STARtup  VIBRations
         &gt;RUNType  RESTart  VIBRations
         &gt;RUNType  CONTinue  VIBRations     (to be implemented!)
         &gt;RUNType  STARtup  POLArization
         &gt;RUNType  RESTart  POLArization
         &gt;RUNType  NEBcalculation
         &gt;RUNType  STARtup  NEBcalculation
         &gt;RUNType  RESTart  NEBcalculation




-----------------------------------------------------------------------------
                                                      <a name="c.2)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.2)  SCFType [CONventional,DIRect,MEMory] [NUMerical]</b>
-----------------------------------------------------------------------------

 This keyword defines the method of handling 2-electron integrals to
 construct the Kohn-Sham matrices and allows to force numerical evaluation of
 the exchange-correlation potentials and total energy in the SCF-cycles
 rather than using the fitted potentials based on the auxiliary basis. The
 option keywords are

     CONventional
         the 2-electron integrals are calculated at the beginning of the SCF
         procedure and stored on disk. The integrals are retrieved from disk
         at each iteration. This requires large disk storage for large
         systems. This option is used as default.

     DIRect
         the 2-electron integrals are recalculated at each iteration. No
         integral disk storage is performed. This option is suggested for
         smaller systems.

     MEMory
         the 2-electron integrals are calculated at the beginning of the SCF
         procedure and as many integrals as possible are fit into memory, the
         rest is stored on disk.

The second option keyword NUM forces the numerical evaluation of the
exchange-correlation contributions to the Kohn-Sham matrix over the grid at
every SCF cycle instead of using an auxiliary basis to fit the potentials and
energy. The NUM keyword is equivalent to providing an auxiliary basis with
functions only for the fit of the Coulomb interaction, which also forces a
strict numerical integration of the exchange and correlation contributions.
However, neither can be combined with the use of symmetry. The use of the
fitting basis results in cpu savings at the expense of accuracy in the energy
in the iterations. The final energy is always computed numerically on an
enhanced grid.


-----------------------------------------------------------------------------
                                                      <a name="c.3)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.3)  MAXCycles  [number]</b>
-----------------------------------------------------------------------------

This keyword defines the maximum number of iterations, NSCF, calculated in any
SCF procedure (single point calculation or geometry optimization). The default
value is NSCF=50. Note that restarting a run with NSCF=0 calculates only
1-electron properties without iterating and no restart file will be written.

Example:

     &gt;MAXCYCLES  50


-----------------------------------------------------------------------------
                                                      <a name="c.4)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.4)  ECONvergence  [number]</b>
-----------------------------------------------------------------------------

This keyword defines the energy convergence for an SCF procedure where the
number gives the convergence threshold Econv (in Hartree). An SCF procedure
is terminated if three consecutive values of the total energies differ by
less than Econv. The default value is Econv 1.0E-6 .

Example:

     &gt;ECONVERGE  1.D-6


-----------------------------------------------------------------------------
                                                      <a name="c.5)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.5)  DCONvergence  [number]</b>
-----------------------------------------------------------------------------

This keyword defines the electron density convergence for an SCF procedure
where the number gives the convergence threshold Dconv (in a.u.). An SCF
procedure is terminated if three consecutive values of the densities differ
by less than Dconv. The default value is Dconv = 0.001.

Example:

     &gt;DCONVERGE  1.D-3


-----------------------------------------------------------------------------
                                                      <a name="c.6)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.6)  DMIXing  [NORMal  nd  nx , MDENsity  nm]</b>
-----------------------------------------------------------------------------

This keyword defines the extrapolation between successive SCF iteration
steps by linear mixing schemes.

The recommended option keyword MDENsity, together with parameter nm, allows
mixing of density matrices by

       Pin(m+1) = (1 - nm) * Pin(m) + nm * Pout(m)       0 &lt; nm &lt; 1

where Pin(m), Pin(m+1) are input density matrices of SCF steps m, m+1 and
Pout(m) is the output density matrix of SCF step m. Reasonable mixing factors
range between 0.05 (difficult convergence) and 0.5 (easy convergence) with nm
= 0.2 being the default. Density matrix mixing with nm = 0.2 is set by
default. NOTE that density matrix mixing leads to erroneous results if
changing fractional occupations (see level occupation, smearing keyword
SMEAr) are used.

If an SCF calculation is started from scratch (i.e. without input density)
the fixed mixing of densities is replaced by "dynamical" mixing for the
beginning N iterations using mixing factors

       nd(i) = nd + (N-i+1)/N * dnd              for iterations i &lt; N+1
             = nd                                for iterations i &gt; N

where at present N = 4, dnd = 0.3.

The option keyword NORMal, together with two parameters nd, nx, allows mixing
of electron densities and of exchange/correlation potentials by

       rhoin(m+1) = (1 - nd) * rhoin(m) + nd * rhoout(m)       0 &lt; nd &lt; 1

       fxcin(m+1) = (1 - nx) * fxcin(m) + nx  * fxcout(m)      0 &lt; nx &lt; 1

where rhoin(m), rhoin(m+1) are input electron densities of SCF steps m, m+1
and  rhoout(m) is the output electron density of SCF step m. Further,
fxcin(m), fxcin(m+1), fxcout(m) are input and output exchange/correlation
potentials of steps m, m+1. Reasonable mixing factors range between 0.05
(difficult convergence) and 0.5 (easy convergence) with nd = nx = 0.2 being
defaults.

If the direct iterative inversion scheme [P82] is used to speed up
convergence, see keyword DIIS, then the mixing factor nd is
automatically reset to unity, when the DIIS scheme is turned on.

Examples:

     &gt;DMIXING  MDENSITY  0.3

     &gt;DMIXING  NORMAL  0.5  0.4


-----------------------------------------------------------------------------
                                                      <a name="c.7)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.7)  DIIS [OFF, ON [esh], NEW nstep [esh, [thrd]]]</b>
-----------------------------------------------------------------------------

  This keyword defines the use of the DIIS algorithm (Direct Inversion of
  Iterative Subspace [P82]) to accelerate the SCF convergence, see also
  keyword DMIXing. Note that the DIIS scheme is incompatible with the
  smear option, keyword SMEAr. The keyword combination

     DIIS  OFF
          does not use the DIIS scheme in the SCF iteration cycle. This is
          required if the smear option, keyword SMEAr, is to be used to
          determine orbital occupations.

     DIIS  ON  [eshd]
          uses the DIIS scheme in the SCF iteration cycle (set as default)
          where all previous iteration steps are used for the extrapolation
          between cycles. (This may result in very large intermediate scratch
          files for large/long runs.) This scheme includes downwards/upwards
          shifts of all occupied/empty orbital levels by eshd, analogous to
          keyword LEVElshift, see <a href="#c.8)">c.8)</a>, where eshd can be defined on the
          keyword line (eshd in eV units), see below. As a default, eshd = 0.5
          eV is used and has to be modified if the HOMO/LUMO gap falls below
          0.5 eV.

     DIIS  NEW  nstep  [eshd, [thrd]]
          uses the DIIS scheme in the SCF iteration cycle where only up to
          nstep previous iteration steps are used for the extrapolation between
          cycles. (Reasonable nstep values are nstep = 5 - 10 with nstep = 7
          being default.) This scheme includes downwards/upwards shifts of all
          occupied/empty orbital levels by eshd, analogous to keyword
          LEVElshift, see <a href="#c.8)">c.8)</a>, where eshd can be defined on the keyword line
          (eshd in eV units), see below. As a default, eshd = 0.5 eV is used
          and has to be modified if the HOMO/LUMO gap falls below 0.5 eV.
          Further, parameter thrd allows to set the threshold for the
          DIIS error, see below, where thrd is defaulted to 0.05.

The DIIS algorithm is turned on only after the largest element of the DIIS
error MATRIX (computed from the second iteration on) is below a threshold thrd
(default = 0.05, may be reset with option DIIS NEW). This happens typically
after 8 - 15 iterations. Before DIIS is turned on a linear mixing scheme is
used for the extrapolation between successive SCF iteration steps, see <a href="#c.6)">c.6)</a>.

Note that the eshd value of the DIIS option will be overridden by any level
shift &gt; 0 provided explicitly with keyword LEVElshift, see <a href="#c.8)">c.8)</a>. The eshd value
will be used only if the keyword LEVElshift is omitted in the input or included
by a keyword line "LEVElshift 0.0".


-----------------------------------------------------------------------------
                                                      <a name="c.8)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.8)  LEVElshift  esh</b>
-----------------------------------------------------------------------------

This keyword includes the levelshift algorithm which may improve SCF
convergence. Here the Kohn-Sham hamiltonian is modified such that all
occupied/empty orbital levels are shifted downwards/upwards by esh. This
increases the HOMO/LUMO gap artificially by 2*esh while the occupied orbitals
and all calculated properties remain unchanged. (Level shifting may not be
suitable in cases where the virtual orbital space is used, as in NMR or EPR
calculations.) The procedure can avoid oscillatory convergence or divergence
due to swapping between virtual and occupied orbitals.

The default level shift is esh = 0 (applies no shift). For level shift values
esh &gt; 0 (in eV units, reasonable values are 5 - 10 eV) level shifting is
applied where information about occupied and empty orbitals is assumed to be
reliable. Therefore, level shifting should be used only after the energy
ordering of the orbitals is stable, i. e. it should NOT be used in
calculations starting from scratch.

If the DIIS algorithm is used to accelerate the SCF convergence, see
keyword DIIS, level shifting is always applied where the present esh value
provided with keyword LEVElshift overrides any eshd value given (explicitly
or defined implicitly) with keyword DIIS, see <a href="#c.7)">c.7)</a>. The eshd value is used only
for esh = 0 (default shift).

Note that level shifting is incompatible with the smear option, keyword SMEAr.


-----------------------------------------------------------------------------
                                                      <a name="c.9)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.9)  MAXOverlap [LIST]</b>
-----------------------------------------------------------------------------

With this keyword, the maximum orbital overlap criterion is used to select
orbitals of an SCF iteration: if in iteration n the set of occupied output
orbitals is {f1, f2, ... fn}, the occupied orbitals of iteration n+1,
{g1, g2, ... gn}, are selected such that the overlap integral (fi|gj) is
largest (only orbitals fi, gj of the same symmetry representation are
compared). This guarantees that the orbital character is approximately
conserved and allows smoother convergence in some cases and also allows the
calculation of specific excited and hole states. Example:

     &gt;MAXOVERLAP

The keyword sequence

     MAXOverlap  LIST

prints for each iteration the orbital selection and maximum overlap values. In
the listing "S(i,k)= ovlp" means that occupied orbital i refers to the kth root
from the diagonalization with the overlap value oclp. NOTE that this option may
generate a lot of output and is meant only for testing purposes in case of
convergence problems.

The maximum overlap option may be used together with the REORder option which
allows a reordering of orbitals from a previous run to be used to build the
starting density in a restart run. For details see option <a href="#b.11)">b.11)</a>.

Note that using the maximum orbital overlap option may result in orbital
sequences in the output listing which do not reflect the natural sequence
(increasing orbital energies within each symmetry representation). The relevant
sequence is always given by the orbital listing of the output and refers also
to the sequence used in the restart file output. This has taken into account
in subsequent runs using the restart file as input.


-----------------------------------------------------------------------------
                                                      <a name="c.10)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.10)  INTEgration  [LEBEdev, GAUSs  n1  n2  n3  n4  n5]</b>
-----------------------------------------------------------------------------

 The angular integration can be performed using either Lebedev (default) or
 Gauss-Legendre quadrature. The keyword combination

    INTEgration  LEBEdev
         (default) uses the Lebedev integration scheme [L75] which is highly
         accurate and more efficient than the Gauss-Legendre method but is
         restricted to a maximum of 194 grid points.

    INTEgration  GAUSs  n1  n2  n3  n4  n5
         uses the Gauss-Legendre integration scheme which allows angular
         grids with more than 194 points but is less efficient than the
         Lebedev method (requiring about 20% more points for the same
         accuracy). The numbers n1 ... n5 define the order of the integration
         polynominals. For n2=n3=n4=n5=0 (or omitted in the input) one order
         n1 polynominal is used globally while finite values for n2 ... n5
         allow to use different orders in 5 different radial regions. The
         number of points generated for each radial region is
`                2*(2ni+1)*(2ni+1).
         In practice, ni=5 leads to a good quality grid, ni=8 or 9 allow
         calculations of weak interaction energies (together with 128 radial
         grid points).

Example:

     &gt;INTEGRATE  GAUSS  5 5 5 5 5


-----------------------------------------------------------------------------
                                                      <a name="c.11)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.11)  GRID [COARse,FINE,MEDIum,EXTRafine] [RANDom,NONRandom] [SAME]</b>
-----------------------------------------------------------------------------

  The user specifies the quality and type of the grids used for the least
  squares fit of the exchange-correlation potentials and final energy
  density. Keyword GRID comes with up to three additional option keywords
  from the following three groups

  (a) the size of the angular grid is defined by keywords

          COARse      using    6 points per radial shell
          MEDIum      using   12 points per radial shell
          FINE        using   26 points per radial shell  (default)
          EXTRafine   using  194 points per radial shell

      The radial grid consists of 64 points by default, i.e., each atom is
      surrounded by 64 shells of either 194, 26, 12, or 6 points. The number
      of radial points can be given for each atom with the Ngrid parameter in
      the coordinate list, see CARTesian or ZMATrix.

  (b) the mesh type is defined by keywords

          NONRandom   (default) forces the angular points of the radial
                      shells to line up.

          RANDom      all angular points of a radial shell are subject to a
                      common (random) rotation where rotation angles differ
                      between shells. As a result, total energy variations due
                      to coordinate rotations are somewhat reduced and possible
                      bias introduced by the lineup of angular points is
                      (hopefully) minimized. However, randomization may destroy
                      the molecular symmetry slightly (position differences
                      within 1.D-3 Angstrom). Perfect symmetry can be
                      maintained by choosing the NONRandom option with a
                      properly oriented molecule.

  (c) the additional keyword

          SAME        specifies that the same angular grid is used for
                      fitting and for the numerical integration to evaluate
                      total energies. By default, the numerical integration is
                      performed with a larger grid.

Example:

     &gt;GRID FINE NONRANDOM


-----------------------------------------------------------------------------
                                                      <a name="c.12)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.12)  WEDGe  [TETA, PHI]                              (UNTESTED!)</b>
-----------------------------------------------------------------------------
This keyword allows to restrict the angular integration grid of selected
atoms to a smaller range in case of the Gauss-Legendre integration scheme
and symmetry, see keyword INTEgration. This results in a larger
effective grid. The keyword line

     WEDGE  TETA  i1  nt1  i2  nt2  ...
          restricts the theta range of integration for atom ii to [0, pi/nti]
          where up to 10 atom centers ii can be included on the keyword line.
          The keyword line can be repeated for n &gt; 10 atom centers.

     WEDGE  PHI  i1  np1  i2  np2  ...
          restricts the phi range of integration for atom ii to [0, pi/npi]
          where up to 10 atom centers ii can be included on the keyword line.
          The keyword line can be repeated for n &gt; 10 atom centers.


-----------------------------------------------------------------------------
                                                      <a name="c.13)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.13)  SLATer_radii</b>
-----------------------------------------------------------------------------

In the numerical integration scheme the points are distributed between atoms
based on their size. The radii used as default are the Slater atomic radii. For
strongly ionic systems (e.g. oxides such as MgO) the numerical accuracy can be
improved by making the division based on the ionic radii instead. In the limit
of a very large set of points per atom this should only have minor effects on
the accuracy. By adapting the radii to the specific situation the standard
numerical grids in StoBe can still be used. An indicator when this option can
be used is a calculation where the total number of electrons obtained from the
density integrated over the grid differs "substantially" (&gt;0.01 electron) from
the correct number of electrons.

     SLATer
       i1   rad1
       i2   rad2
       ..   ....
     END

           where i1, i2,... are the sequence numbers (same order as in the
           coordinate input) of the symmetry independent centers for which
           the radius will be changed to the values rad1, rad2, ...
           The input is terminated by the END line.

Example:

     &gt;TITLE
     &gt;CO/MgO(001)
     &gt;SYMM C2V
     &gt;CARTESIAN BOHR
     &gt;O    0.        0.        7.13    8.  32
     &gt;C    0.        0.        5.00    6.  32
     &gt;Mg   0.00000   0.00000   0.0000 12.  32
     &gt;O   0.00000   0.00000  -3.97906  8.  32
     &gt;O   3.97906   0.00000   0.00000  8.  32
     &gt;O   0.00000   3.97906   0.00000  8.  32
     &gt;O   3.97906   3.97906  -3.97906  8.  32
     &gt;Mg   0.00000  3.97906  -3.97906 12.  32
     &gt;Mg   3.97906  0.00000  -3.97906 12.  32
     &gt;Mg   3.97906  3.97906   0.00000 12.  32
     &gt;END
     &gt;RUNTYPE START NOOPTIMIZE
     &gt;SCFTYPE DIRECT
     &gt;SLATER RADII
     &gt;3  0.86
     &gt;4  1.26
     &gt;5  1.26
     &gt;6  1.26
     &gt;7  1.26
     &gt;8  0.86
     &gt;9  0.86
     &gt;10  0.86
     &gt;END
     &gt;POTENTIAL NONLOCAL PD86 PD86
     &gt;GRID FINE NONRANDOM
     &gt;MULTIPLICITY 1
     &gt;CHARGE 0
     &gt;MAXCYCLES 65
     &gt;ECONVERGENCE 0.000001
     &gt;DCONVERGENCE 0.00001
     &gt;MAXGEOMETRIES 15
     &gt;GCONVERGENCE 0.0001
     &gt;GSTEPSIZE 0.25
     &gt;HESSIAN 7
     &gt;DMIXING MDENS 0.15
     &gt;MULLIKEN ON
     &gt;DIIS ON
     &gt;FSYM SCFOCC
     &gt;ALFA  37 23 23 14
     &gt;BETA  37 23 23 14
     &gt;END
     &gt;A-OXYGEN (4,4;4,4)
     &gt;A-CARBON (4,4;4,4)
     &gt;A-MAGNESIUM (5,4;5,4)
     &gt;A-OXYGEN (4,4;4,4)
     &gt;A-OXYGEN (4,4;4,4)
     &gt;A-OXYGEN (4,4;4,4)
     &gt;A-OXYGEN (4,4;4,4)
     &gt;A-MAGNESIUM (5,4;5,4)
     &gt;A-MAGNESIUM (5,4;5,4)
     &gt;A-MAGNESIUM (5,4;5,4)
     &gt;O-OXYGEN (631/31/1)
     &gt;O-CARBON (631/31/1)
     &gt;O-MAGNESIUM (6321/411*)
     &gt;O-OXYGEN (631/31/1)
     &gt;O-OXYGEN (631/31/1)
     &gt;O-OXYGEN (631/31/1)
     &gt;O-OXYGEN (631/31/1)
     &gt;O-MAGNESIUM (6321/411*)
     &gt;O-MAGNESIUM (6321/411*)
     &gt;O-MAGNESIUM (6321/411*)
     &gt;END

In the following, numerical values of all internally defined Slater radii are
listed, radii are given in Angstrom.

 --------------------------------------------------------------------------
   element   Rslater          element   Rslater         element   Rslater
 --------------------------------------------------------------------------
     1 H      0.5000           36 Kr     2.7500          71 Lu     1.7500
     2 He     2.0000           37 Rb     2.3500          72 Hf     1.5500
     3 Li     1.4500           38 Sr     2.0000          73 Ta     1.4500
     4 Be     1.0500           39 Y      1.8000          74 W      1.3500
     5 B      0.8500           40 Zr     1.5500          75 Re     1.3500
     6 C      0.7000           41 Nb     1.4500          76 Os     1.3000
     7 N      0.6500           42 Mo     1.4500          77 Ir     1.3500
     8 O      0.6000           43 Tc     1.3500          78 Pt     1.3500
     9 F      0.5000           44 Ru     1.3000          79 Au     1.3500
    10 Ne     2.2500           45 Rh     1.3500          80 Hg     1.5000
    11 Na     1.8000           46 Pd     1.4000          81 Tl     1.9000
    12 Mg     1.5000           47 Ag     1.6000          82 Pb     1.8000
    13 Al     1.2500           48 Cd     1.5500          83 Bi     1.6000
    14 Si     1.1000           49 In     1.5500          84 Po     1.9000
    15 P      1.0000           50 Sn     1.4500          85 At     1.6500
    16 S      1.0000           51 Sb     1.4500          86 Rn     3.2500
    17 Cl     1.0000           52 Te     1.4000          87 Fr     2.8000
    18 Ar     3.0000           53 I      1.4000          88 Ra     2.1500
    19 K      2.2000           54 Xe     3.0000          89 Ac     1.9500
    20 Ca     1.8000           55 Cs     2.6000          90 Th     1.8000
    21 Sc     1.6000           56 Ba     2.1500          91 Pa     1.8000
    22 Ti     1.4000           57 La     1.9500          92 U      1.7500
    23 V      1.3500           58 Ce     1.8500          93 Np     1.7500
    24 Cr     1.4000           59 Pr     1.8500          94 Pu     1.7500
    25 Mn     1.4000           60 Nd     1.8500          95 Am     1.7500
    26 Fe     1.4000           61 Pm     1.8500          96 Cm     1.7500
    27 Co     1.3500           62 Sm     1.8500          97 Bk     1.7500
    28 Ni     1.3500           63 Eu     1.8500          98 Cf     1.7500
    29 Cu     1.3500           64 Gd     1.8000          99 Es     1.7500
    30 Zn     1.3500           65 Tb     1.7500         100 Fm     1.7500
    31 Ga     1.3000           66 Dy     1.7500         101 Md     1.7500
    32 Ge     1.2500           67 Ho     1.7500         102 No     1.7500
    33 As     1.1500           68 Er     1.7500         103 Lr     1.7500
    34 Se     1.1500           69 Tm     1.7500         104        1.5500
    35 Br     1.1500           70 Yb     1.7500         105        1.5500
 --------------------------------------------------------------------------


-----------------------------------------------------------------------------
                                                      <a name="c.14)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.14)  PTCHarges  [FILE  [ir], FIL&  [ir]]</b>
-----------------------------------------------------------------------------

This keyword allows to include external point charges (without basis functions)
in the calculation. At present, up to 100000 (noutch) external charges can be
included where coordinates and charges are read from a separate charge file
(unit ir) and/or from the input file. The keyword line(s)

     PTCHarges
       npc
       xpc  ypc  zpc  qpc
       ...

           where the first line gives the number of point charges, npc, to be
           included. The following npc lines give for each point charge its
           coordinates (xpc, ypc, zpc) and its charge qpc.

     PTCHarges  FILE  [ir]
          defines input only from a separate file (unit ir, default = 9) where
          the charge information is given in the same ASCII format as discussed
          above.

     PTCHarges  FIL&  [ir]
          defines input from a separate file (unit ir, default = 9). Additional
          point charges can be read in from the input file. The input
          formats are those described above.

Coordinates of atom charges have to be defined in Angstrom or Bohr units
depending on the definitions used to describe atom positions, see keywords
CARTesian and ZMATrix.

In calculations with molecular symmetry, all point charge centers are checked
for the existence of symmetry equivalent centers and centers are added if
needed to conserve symmetry. Therefore, with molecular symmetry, the input of
external charges can be resticted to non-equivalent centers. Symmetry
equivalent centers, if provided with the input, will be detected and processed
accordingly.

Example:

     &gt;PTCHARGES
     &gt;  5
     &gt;   0    0   10   .1
     &gt;   5    0    0  -.1
     &gt;  -5    0    0  -.1
     &gt;   0    5    0   .1
     &gt;   0   -5    0   .1


-----------------------------------------------------------------------------
                                                      <a name="c.15)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.15)  BSSError  na  i1  i2  ...  ina</b>
-----------------------------------------------------------------------------

This keyword defines an SCF calculation where na selected atom centers (indices
i1 i2 ... ina) are treated as "ghosts", i. e. their basis sets and numerical
grids are included but their nuclear charges are ignored  in the calculation.
This type of SCF calculation allows an estimate of the basis set superposition
error (BSSE).

If symmetry is used, the atom numbering ii refers to non-equivalent centers
only. The keyword line can contain up to 19 atom indices. If na &gt; 19 atoms
are to be included, the index list can be continued on the following line(s)
with up to 20 indices per line.


-----------------------------------------------------------------------------
                                                      <a name="c.16)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.16)  SUPSym  [ALFA, BETA]</b>
-----------------------------------------------------------------------------

This restricts orbital rotations to avoid undesired mixings in, for instance,
calculations where the energetic effects of different interactions should be
investigated in CSOV (Constrained Space Orbital Variation) calculations
[BHB84a,BHB84b]. By adding an additional (formal) symmetry label to specific
orbitals an additional blocking of the Kohn-Sham matrix is done and only
orbitals with the same (formal) symmetry label are allowed to mix with each
other. By specifying the optional keyword ALFA or BETA this will be applied
only to the specified spin symmetry. If this additional keyword is left out it
will be applied to both the alpha and beta spin-orbitals.

NOTE: this option can also be used to determine excited states variationally in
a stepwise procedure by eliminating excitations into lower-lying orbitals
through:
1) Assigning a different SUPSym to orbitals that should be eliminated
2) Defining an occupation zero to these orbitals in the EXCIted specification
   when restarting from the converged result for the preceding excited state.

This option requires additional numerical input following the keyword line and
reading

     SUPSym
       num1
       i1  i2 i3 ...
       num2
       j1 j2 j3  ....
       num...
       ...
     END

where the first numerical line gives the number num1 of orbitals to be grouped
together as "supersymmetry" 1. The following lines (20 entries to a line)
specify which orbitals, i1, i2, ... are assigned to supersymmetry 1, where the
numbering is from the first orbital in molecular symmetry 1 to the last orbital
in the last molecular symmetry (irrespective of occupation, order given in the
listing of orbitals in the output - same numbering for alpha and beta).
Additional lines can be added if num1 &gt; 20. The input for supersymmetry 2 is
analogous to that of supersymmetry 1. Up to nsup different supersymmetries are
allowed, where nsup + nsym (nsym = sum of basic symmetry representations) must
not exceed 20.

Example:

     &gt;TITLE
     &gt;h2o restart with frozen 1s core hole in alpha spin KS-matrix
     &gt;SYMM C2V
     &gt;CARTESIAN BOHR
     &gt;  O    0.0000   0.00000  0.0000   8.  32
     &gt;  H    0.0000000   2.0504030   1.1309461  1.  32
     &gt;END
     &gt;RUNTYPE NEWOCC NOOPTIMIZE
     &gt;SCFTYPE DIRECT
     &gt;POTENTIAL NONLOCAL PD86 PD86
     &gt;GRID FINE NONRANDOM
     &gt;MULTIPLICITY 2
     &gt;CHARGE 1
     &gt;MAXCYCLES 75
     &gt;ECONVERGENCE 0.000001
     &gt;DCONVERGENCE 0.00001
     &gt;DMIXING MDENS 0.40
     &gt;MULLIKEN ON
     &gt;DIIS ON
     &gt;FSYM SCFOCC EXCITED
     &gt;ALFA 3 1 1 0
     &gt;BETA 3 1 1 0
     &gt;SYM 1
     &gt;ALFA 0 1  1 0.
     &gt;BETA 0 0
     &gt;END
     &gt;SUPSYM ALFA
     &gt;1
     &gt;1
     &gt;END
     &gt;END
     &gt;A-OXYGEN (4,4;4,4)
     &gt;A-HYDROGEN (4,2;4,2)
     &gt;O-OXYGEN (631/31/1)
     &gt;O-HYDROGEN (311/1)
     &gt;END

There is an alternative way to assign orbitals to supersymmetries which is
particularly useful when longer sequences of consecutive orbital indices are to
be given. This option starts, for each supersymmetry, with the keyword RANGe as
follows

   RANGe npairs

where npairs denotes the number of index pairs to be given in the following
line(s) (20 entries to a line, additional lines can be added if npairs &gt; 10).
These numerical lines reading

   ia1 ie1  ia2 ie2  ...

define ranges of orbital indices selecting orbitals ia1, ia1+1, ie1, and ia2,
ia2+1, ie2, ... for a given supersymmetry. As an example, the input

   &gt; SUPSYM
   &gt; 9
   &gt; 1 2 3 4 5 6 7 10 11
   &gt; 3
   &gt; 12 13 14
   &gt; END

which sets two supersymmetries of 9 and 3 orbitals each can be written
alternatively as

   &gt; SUPSYM
   &gt; RANGE 2
   &gt; 1 7 10 11
   &gt; RANGE 1
   &gt; 12 14
   &gt; END


-----------------------------------------------------------------------------
                                                      <a name="c.17)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> c.17)  TRRH [DIIS, nswitch]</b>
-----------------------------------------------------------------------------

Trust-region Roothan-Hall extrapolation from Thogersen et al., J. Chem. Phys.
123, 074103 (2005). This approach can be applied to cases that are very
difficult to converge, oscillate or even diverge. A model Hessian for the
orbital rotations is set up and an attempted step in the direction of the
orbital gradient is attempted if the error function increases a shorter step
is attempted. These microiterations are continued until a suitable step is
found. The time for each iteration cycle can thus vary strongly depending on
how many microiterations are required at each step. However, this is a very
powerful procedure that almost always leads to convergence.

The input specifies at which SCF iteration step the extrapolation should be
turned on. For standard cases where it goes into the DIIS, but the DIIS has
difficulties the TRRH extrapolation can be turned on automatically after the
DIIS has started by

     TRRH DIIS
          This switches to the trust-region Roothan-Hall extrapolation two
          iteration steps after the direct iterative inversion scheme (DIIS)
          [P82], see also keyword DIIS, has been activated. This is considered
          the default option.

For cases where the divergence or convergence difficulties appear at a given
step it is recommended to turn on the TRRH a few iterations before reaching
that point. For this to be well-defined the calculation has to be started
again from the same point (so that the behavior at each iteration is
identical) by specifying at which iteration the Trust-region Roothan-Hall
procedure should be started. The corresponding input is

     TRRH nswitch
          This switches to the trust-region Roothan-Hall extrapolation at
          iteration step nswitch.



<a name="2.2.4."><b>2.2.4.</a>  KEYWORDS FOR GEOMETRY OPTIMIZATION</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

-----------------------------------------------------------------------------
                                                      <a name="d.1)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> d.1)  GCONvergence  [number]</b>
-----------------------------------------------------------------------------

This keyword defines the gradient convergence for a geometry optimization where
the number gives the convergence threshold Gconv (in a.u.). A geometry
optimization is terminated when the energy gradient (absolute value)
is less than Gconv. The default value is Gconv 1.0D-4.

Example:

     &gt;GCONVERGE  1.D-4


-----------------------------------------------------------------------------
                                                      <a name="d.2)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> d.2)  GSTEpsize  [maxstep]  [fscale]</b>
-----------------------------------------------------------------------------

This keyword defines an upper bound maxstep to the allowed average
displacement of atoms between successive steps in a geometry optimization
(maxstep in Bohr or Angstrom depending on the initial coordinate input, see
<a href="#a.1)">a.1)</a>. Larger displacements will be reduced to the maximum while their
direction remains unchanged. A reasonable value is 0.25 Bohr with the
default = 0.5 Bohr.

The second (optional) value allows to scale all displacements evaluated
according to forces globally by a constant factor fscale (with default = 1.0).
For values fscale &lt; 1.0 this may result in an increased number of convergence
steps but smoother convergence.

Example:

     &gt;GSTEPSIZE  0.25


-----------------------------------------------------------------------------
                                                      <a name="d.3)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> d.3)  MAXGeometries  [number]</b>
-----------------------------------------------------------------------------

This keyword defines the maximum number of geometry steps, MAXG, in
a geometry optimization procedure. The default value is MAXG=10.

Example:

     &gt;MAXGEOMETRIES  30


-----------------------------------------------------------------------------
                                                      <a name="d.4)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> d.4)  COORdinate  FIX</b>
-----------------------------------------------------------------------------

This keyword allows to include geometry constraints for selected atom
coordinates in a geometry optimization. This can be used as an alternative to
keyword 'ATOM' (which is more general, see <a href="#d.5)">d.5)</a>. As an example, consider an
adsorbate/cluster model where all cluster atoms are kept fixed while the
adsorbate atom is allowed to equilibrate along the z axis or parallel to the
surface (xy plane). The keyword line

     COORdinate  FIX  X=Y  na
          constrains atom center na to movements along a plane through its
          starting position and spanned by vectors (1,1,0), (0,0,1). This has
          the same effect as keyword line 'ATOM  DIR  na 1 1 0  0 0 1'.

     COORdinate  FIX  X=Z  na
          constrains atom center na to movements along a plane through its
          starting position and spanned by vectors (1,0,1), (0,1,0). This has
          the same effect as keyword line 'ATOM  DIR  na 1 0 1  0 1 0'.

     COORdinate  FIX  Y=Z  na
          constrains atom center na to movements along a plane through its
          starting position and spanned by vectors (0,1,1), (1,0,0). This has
          the same effect as keyword line 'ATOM  DIR  na 0 1 1  1 0 0'.

     COORdinate  FIX  X  na
          constrains atom center na to movements along a plane through its
          starting position and spanned by vectors (0,1,0), (0,0,1). This has
          the same effect as keyword line 'ATOM  DIR  na 0 1 0  0 0 1'.

     COORdinate  FIX  Y  na
          constrains atom center na to movements along a plane through its
          starting position and spanned by vectors (1,0,0), (0,0,1). This has
          the same effect as keyword line 'ATOM  DIR  na 1 0 0  0 0 1'.

     COORdinate  FIX  Z  na
          constrains atom center na to movements along a plane through its
          starting position and spanned by vectors (1,0,0), (0,1,0). This has
          the same effect as keyword line 'ATOM  DIR  na 1 0 0  0 1 0'.

In all cases, the atom number na refers to a non-equivalent center with its
symmetry equivalents being subject to corresponding constraints where symmetry
relations are accounted for.

Note that coordinate constraints cannot be combined. The last keyword line for
a given atom center determines its constraints. Further, the present
constraints are ignored for atom centers which are fixed by a keyword line
'ATOM FIX', see keyword ATOM, <a href="#d.5)">d.5)</a>.

Example:

     &gt;COOR  FIX  X=Y  4


-----------------------------------------------------------------------------
                                                      <a name="d.5)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> d.5)  ATOM  [FIX, FREE, DIRection]</b>
-----------------------------------------------------------------------------

This keyword allows to include geometry constraints for selected atoms in a
geometry optimization or vibrational analysis. It can be used and is more
general than keyword 'COORdinate', see <a href="#d.4)">d.4)</a>. As an example, consider an
adsorbate/cluster model where all cluster atoms are kept fixed at the
experimental bulk geometry while the adsorbate structure is optimized. The
keyword line

     ATOM  FIX   na  i1  i2  ...  ina
          fixes na atom centers i1 ... ina at their position given in the input
          file (or in the restart file if option CONTinue is used, see keyword
          RUNType, <a href="#c.1)">c.1)</a>). All other atom centers are allowed to move freely in
          the optimization/vibration, see also below. If symmetry is used, the
          atom numbers ii refer to non-equivalent centers with their symmetry
          equivalents being fixed as well. The keyword line can contain up to
          19 atom indices. If na &gt; 19 atoms are to be included, the index list
          can be continued on the following line(s) with up to 20 atom indices.
          Fixing an atom center overrides other geometry constraints set by
          keyword COORdinate.

     ATOM  FIX  ALL
          fixes all atom centers of the cluster/molecule at their position
          given in the input file (or in the restart file if option CONTinue is
          used, see keyword RUNType, <a href="#c.1)">c.1)</a>). This keyword line is meaningful
          only for geometry optimizations where group constraints (allowing
          groups of atoms to move) are given in addition, see <a href="#d.6)">d.6)</a>.


     ATOM  FREE  na  i1  i2  ...  ina
          keeps all atom centers fixed at their position given in the input
          file (or in the restart file if option CONTinue is used, see keyword
          RUNType, <a href="#c.1)">c.1)</a>) while na atom centers i1 ... ina are allowed to move
          freely in the optimization/vibration, see also below. If symmetry is
          used, the atom numbering ii refers to non-equivalent centers with
          their symmetry equivalents being allowed to move such that the global
          symmetry is conserved. The keyword line can contain up to 19 atom
          indices. If na &gt; 19 atoms are to be included, the index list can be
          continued on the following line(s) with up to 20 atom indices.
          Freeing an atom center allows it to be imposed by other geometry
          constraints set by keyword COORdinate.

     ATOM  DIRection  na  x1  y1  z1  [x2  y2  z2]
          constrains the movement of atom center na (and its symmetry partners)
          during the optimization/vibration. Here v1 = (x1, y1, z1) and
          v2 = (x2, y2, z2) are direction vectors in cartesian coordinates. If
          only v1 is given on the keyword line, center na is constrained to
          move along the line defined by its starting position and direction
          vector v1. If both v1 and v2 appear on the keyword line, center na is
          constrained to move along the plane defined by its starting position
          and the two direction vectors v1, v2. If symmetry is used, the atom
          number na refers to a non-equivalent center with its symmetry
          equivalents being allowed to move such that the global symmetry is
          conserved. The present constraint is overridden by subsequent
          constraints set by keyword COORdinate.

A keyword line ATOM FIX ...  overrides all previous lines ATOM FIX, ATOM FREE,
                             and ATOM DIR appearing in the input file.
A keyword line ATOM FREE ... overrides all previous lines ATOM FREE, ATOM FIX
                             and ATOM DIR appearing in the input file.
A keyword line ATOM DIR ...  constrains only those atom centers which have
                             not been fixed in a previous ATOM FIX or ATOM FREE
                             keyword line appearing in the input file.

Examples:

     &gt;ATOM FIX 4 1 2 3 4
     &gt;ATOM DIR 5  1. 0. 0.

Fixes atom centers 1, 2, 3, 4 and constrains atom center 5 to move along
(1,0,0) from its initial position.

     &gt;ATOM FREE 3 5 6 7
     &gt;ATOM DIR 5  1. 0. 0.  0. 0. 1.

Fixes all atom centers except centers 5, 6, 7 and constrains atom center 5 to
move along a plane through its initial position and parallel to the xz plane.


-----------------------------------------------------------------------------
                                                      <a name="d.6)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> d.6)  GROUp  [DEFine, FIX, TRAnslate, ROTate, MOVe]</b>
-----------------------------------------------------------------------------

IN PROGRESS!    This option is still experimental.

This keyword allows to include geometry constraints for selected groups of
atoms in a geometry optimization or vibrational analysis. A group of atoms is
considered a rigid subunit which is allowed to move only by translation of its
center of gravity (COG) or by rotation about its COG. As an example, consider a
surface cluster model where (rigid) surface layers are allowed to relax in an
optimization. Atom (see <a href="#d.5)">d.5)</a>) and group constraints can be mixed as long as
they are consistent. In doubtful cases (e.g. atoms fixed by atom constraints
but allowed to move by a group constraint, atoms move in different directions
by an atom and a group constraint) group constraints take precedence over atom
constraints. NOTE that group definitions and operations are allowed (and
meaningful) only for systems with &gt; 2 atoms. Further, group rotation is ignored
for systems with symmetry &gt; C1. The keyword line

     GROUp  DEFine   na  i1  i2  ...  ing
          defines a group of na atoms i1 ... ing. If symmetry is used, atom
          numbers i1 ... ing refer to non-equivalent centers with their
          symmetry equivalents being also included such that the global
          symmetry is conserved. The keyword line can contain up to 19 atom
          indices. If more than 19 atoms are to be included in the group, the
          index list can be continued on the following line(s) (up to 20
          indices per line). The group is assigned a group number ng according
          to the sequence of group definitions. This number is refered to
          below. If no other constraint of group ng (after its definition) is
          given, the group is allowed to move rigidly by translation of its COG
          as well as by free rotation about its COG.

          Note that group definitions with only one atom center (counting also
          symmetry equivalents) ignore rotation and consider translation only.
          In this case only combinations GROUP DEF / GROUP FIX and GROUP TRA
          are meaningful and can be dealt with by atom constraints, see keyword
          ATOM in <a href="#d.5)">d.5)</a>. Group rotation is also ignored for systems with
          symmetry &gt; C1, i. e. GROUP ROT =&gt; GROUP FIX, GROUP MOV =&gt; to GROUP
          TRA.

     GROUp  FIX  ng
          fixes all atom centers of group ng at their positions given in the
          input file (or in the restart file if option CONTinue is used, see
          keyword RUNType, <a href="#c.1)">c.1)</a>). This does not affect atom centers outside the
          group. Fixing atom centers overrides other geometry constraints.

     GROUp  TRAnslate  ng  [x1  y1  z1  [x2  y2  z2]]
          allows group ng to move rigidly by translation of its COG only
          without rotation about its COG. The translation can be restricted
          further by direction contraints where v1 = (x1, y1, z1) and
          v2 = (x2, y2, z2) are direction vectors in cartesian coordinates. If
          only v1 is given on the keyword line, the COG is constrained to move
          along the line defined by its starting position and direction vector
          v1. If both v1 and v2 appear on the keyword line, the COG is
          constrained to move along the plane defined by its starting position
          and the two direction vectors v1, v2.

     GROUp  ROTate  ng  [x1  y1  z1]
          allows group ng to rotate rigidly about its COG only without
          translation of its COG. The rotation can be restricted further by an
          axis contraint where v1 = (x1, y1, z1) is the direction vector (in
          cartesian coordinates) of a fixed rotation axis through the COG.
          Group rotation is ignored for systems with symmetry &gt; C1,
          i. e. GROUP ROT =&gt; GROUP FIX.

     GROUp  MOVe  ng  [DIR  x1  y1  z1  [x2  y2  z2]] [AXIs  x3  y3  z3]
          allows rigid group ng to both translate its COG and to rotate about
          its COG. The movement can be restricted further by direction and axis
          contraints analogous to those for translation or rotation only. Here
          v1 = (x1, y1, z1) and v2 = (x2, y2, z2), following keyword DIR, are
          direction vectors in cartesian coordinates. If only v1 is given, the
          COG is constrained to move along the line defined by its starting
          position and direction vector v1. If both v1 and v2 appear, the COG
          is constrained to move along the plane defined by its starting
          position and the two direction vectors v1, v2.
          Vector v1 = (x1, y1, z1), following keyword AXIs, is a direction
          vector (in cartesian coordinates) of a fixed rotation axis through
          the COG.
          Group rotation is ignored for systems with symmetry &gt; C1,
          i. e. GROUP MOV ... =&gt; GROUP TRA  x1  y1  z1  [x2  y2  z2].

Note that atoms can appear in only one group definition (different group
definitions must not overlap). Keyword lines with additional constraints (FIX,
TRAnslate, ROTate, MOVe) must appear always after the group definition line(s)
in the input file. If the input file includes different constraints (FIX,
TRAnslate, ROTate, MOVe) for the same atom group the constraint appearing last
will be used.

Examples:

     &gt;GROUP DEFINE 5 1 3 4 5 7

Defines a rigid group of 5 atom centers # 1, 3, 4, 5, 7 and allows it to move
rigidly by translation of its COG as well as by rotation about its COG.

     &gt;ATOM FIX ALL
     &gt;GROUP DEFINE 2 2 6
     &gt;GROUP TRANSLATE 1  0. 0. 1.
     &gt;GROUP DEFINE 5 1 3 4 5 7
     &gt;GROUP TRANSLATE 2
     &gt;GROUP DEFINE 2 8 9

Fixes all atom centers except those of the three groups defined subsequently.
Defines a rigid group (# 1) of 2 atom centers # 2, 6 which is allowed to move
by translation of its COG along the (0,0,1) direction without rotation.
Further, a rigid group (# 2) of 5 atom centers # 1, 3, 4, 5, 7 is defined
allowing for translation in any direction. Finally, a rigid group (# 3) of 2
atom centers # 8, 9 is defined allowing for both translation and rotation.


-----------------------------------------------------------------------------
                                                      <a name="d.7)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> d.7)  HESSian  [number  [scale]]</b>
-----------------------------------------------------------------------------

This keyword defines the method used to update the Hessian matrix between
successive steps in a geometry optimization. The following methods are
available:

 number = 0   Steepest descent (extrapolation mixing alpha = 1.0)
          1   Steepest descent (extrapolation mixing alpha = 0.5)
          2   Conjugate gradient (extrapolation mixing alpha = 1.0)
          3   Conjugate gradient (extrapolation mixing alpha = 0.5)
          4   Conjugate gradient, Polak-Ribiere variant
          5   Quasi-Newton, Davidson-Fletcher-Powell variant
          6   Quasi-Newton, Murtaugh - Sargent variant
          7   Quasi-Newton, Broyden-Fletcher-Goldfarb-Shanno variant  (default)
          8   Quasi-Newton, BFGS variant with line search (experimental!)

 With update methods number 0, 1, 2, 3 the extrapolation mixing factor alpha
 may be set explicitly using the (optional) parameter scale. For values
 scale &lt; 0.5 this may result in an increased number of convergence steps but
 smoother convergence.

Examples:

     &gt;HESSIAN  7
     &gt;HESSIAN  3  0.7


-----------------------------------------------------------------------------
                                                      <a name="d.8)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> d.8)  GRADients  [VERSluis, STANdard]</b>
-----------------------------------------------------------------------------

In the energy gradient evaluation, all contributions are calculated
analytically except for the exchange-correlation (XC) contribution. The latter
is determined numerically and introduces an error which can be compensated
partly by the Versluis correction [VZ88]. The keyword line

     GRADients  VERSluis
          eliminates the spurious 1-center XC contributions to the energy
          gradients. This Versluis correction leads, in many cases, to slightly
          more exact energy gradients at the expense of increased computational
          effort (cpu time increased by about 30%)

     GRADients  STANdard
          does not include the Versluis correction. This is the default
          setting.


-----------------------------------------------------------------------------
                                                      <a name="d.9)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> d.9)  STRBalsac</b>
-----------------------------------------------------------------------------

This keyword refers to BALSAC [H00] format file output of the cluster/molecule
geometry during a geometry optimization. By default, BALSAC structure plot
files are generated at the beginning (file struc000.plt) and at the end (file
strucfin.plt) of a geometry optimization run. If keyword STRBalsac is included,
a BALSAC plot file (file strucXXX.plt) will be generated at each geometry step
where XXX denotes the step number (filled by zeros to form a 3 digit number, an
example file name is struc007.plt). The output files can be used as input to
BALSAC where the atoms of a cluster/molecule are displayed as shaded balls.



<a name="2.2.5."><b>2.2.5.</a>  KEYWORDS FOR PROPERTIES</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

-----------------------------------------------------------------------------
                                                      <a name="e.1)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.1)  MULLiken  [OFF  /  ON  [FULL, ORBItal] ]</b>
-----------------------------------------------------------------------------

This keyword includes a listing of the gross Mulliken population analysis and
Mayer bond orders at the end of SCF calculations or geometry optimizations. By
default, the total Mulliken population analysis and total Mayer bond orders,
i. e. values summed over all occupied orbitals, are included. In addition,
orbital resolved data can be requested where the analysis is performed for all
occupied and virtual orbitals included in the listing, see also <a href="#f.9)">f.9)</a>. For
NEXAFS calculations all excitation orbitals with intensity greater than 0.001
are included in the listing. The analysis is performed in spherical or
cartesian gaussians depending on the internal representation of d basis
functions used in the electronic state calculation, see option ORBItalchoice
(<a href="#f.4)">f.4)</a>. Keyword line

   MULLiken ON           (or MULLiken) lists total Mulliken populations and
                         total Mayer bond orders. This is the default if no
                         keyword is given.

   MULLiken OFF          lists neither populations nor bond orders.

   MULLiken ON ORBItal   lists total and orbital resolved Mulliken populations
                         as well as total Mayer bond orders.

   MULLiken ON FULL      lists total and orbital resolved Mulliken populations
                         as well as total and orbital resolved Mayer bond
                         orders.

Examples:
     &gt;MULLIKEN ON FULL        full Mulliken population and Mayer bond order
                              analysis.
     &gt;MULLIKEN OFF            no Mulliken population nor bond order analysis.


-----------------------------------------------------------------------------
                                                      <a name="e.2)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.2)  LOEWdin  [ ON  [FULL, ORBItal] ]</b>
-----------------------------------------------------------------------------

This keyword includes a listing of the Loewdin population analysis and
Mayer bond orders at the end of SCF calculations or geometry optimizations. By
default, no Loewdin population analysis is included. In addition, orbital
resolved data can be requested where the analysis is performed for all occupied
and virtual orbitals included in the listing, see also <a href="#f.9)">f.9)</a>. For NEXAFS
calculations all excitation orbitals with intensity greater than 0.001 are
included in the listing. The analysis is performed in spherical or cartesian
gaussians depending on the internal representation of d basis functions used in
the electronic state calculation, see option ORBItalchoice (<a href="#f.4)">f.4)</a>. Keyword line

   LOEWdin OFF           lists neither populations nor bond orders. This is the
                         default if no keyword is given.

   LOEWdin ON            (or LOEWdin) lists total Loewdin populations and
                         total Mayer bond orders.

   LOEWdin ON ORBItal    lists total and orbital resolved Loewdin populations
                         as well as total Mayer bond orders.

   LOEWdin ON FULL       lists total and orbital resolved Loewdin populations
                         as well as total and orbital resolved Mayer bond
                         orders.

Examples:
     &gt;LOEWDIN ON FULL         full Loewdin population and Mayer bond order
                              analysis.
     &gt;LOEWDIN OFF             no Loewdin population nor bond order analysis.


-----------------------------------------------------------------------------
                                                      <a name="e.3)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.3)  MEPFit  [VANDerwaals]       (not available!)</b>
-----------------------------------------------------------------------------

This keyword includes the calculation of effective atom charges based on
electrostatic potentials evaluated from fitted and numerically evaluated charge
densities (Method of Singh and Kollman [KLS96]). The methods uses default Van
der Waals radii which are stored internally. Modified Van der Waals radii can
be chosen together with option keyword VANDerwaals as follows

     MEPFit  VANDerwaals
     nat1    c
     nat2    radVdW2
     ...
     END

redefines the Van der Waals radii of atomic number nat1, nat2, ... by
radVdW1, radVdW2, ... where the definition list is terminated by one line
containing the keyword END.

Example:

     &gt;MEPF                          evaluates effective atom charges based on
                                    default Van der Waals radii.


     &gt;MEPF  VANDER                  evaluates effective atom charges based on
     &gt; 1   1.0                      default Van der Waals radii except for H
     &gt; 5   2.0                      (Z=1) and B (Z=5) atoms whose radii are
     &gt;END                           redefined as 1.0 and 2.0, respectively.


-----------------------------------------------------------------------------
                                                      <a name="e.4)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.4)  BALPopulation  [TOTAl, FUKUi, ALFA, BETA]</b>
-----------------------------------------------------------------------------

This keyword initiates BALSAC [H00] format file output to visualize and analyze
atom charges derived from Mulliken/Loewdin populations as well as
atom-projected Fukui indices. The output files can be used as input to BALSAC
where the atoms of a cluster/molecule are displayed as shaded balls. The ball
radii are defined by the actual atom charges and positive/negative charges are
shown by different colors (red/blue by default) in the plot. The selection of
Mulliken or Loewdin populations is determined by the print output choice, see
options MULLiken (<a href="#e.1)">e.1)</a>, LOEWdin (<a href="#e.2)">e.2)</a>. Note that the present option requires
appropriate population (either Mulliken or Loewdin or both, see examples below)
print output. The keyword line

     BALPOP  TOTAL [ALFA, BETA, DIFF]
          generates BALSAC file output, poptotM.plt and/or poptotL.plt, with
          atom radii given by total atom charges (absolute values) calculated
          from Mulliken and/or Loewdin populations. Negative / positive atom
          charges are shown by different colors (green / blue by default,
          coresponding to ball "charges" Z = 1 / = 2) in the plot.

          Optional keyword 'ALFA' uses spin alpha projected atom charges,
          defined by qnuc/2 - pop(alpha) for the plot.
          Optional keyword 'BETA' uses spin beta projected atom charges,
          defined by qnuc/2 - pop(beta) for the plot.
          Optional keyword 'DIFF' uses spin differences per atom, defined by
          pop(alpha) - pop(beta) for the plot.

     BALPOP  FUKUI
          generates BALSAC file output, fukrlax.plt, fukfroz.plt, with atom
          radii given by atom-projected Fukui indices (relaxed and frozen
          orbital values, respectively). Negative / positive atom charges are
          shown by different colors (green / blue by default, coresponding to
          ball "charges" Z = 1 / = 2) in the plot. NOTE that this option
          requires the FUKUI option to be activated, see <a href="#b.4)">b.4)</a>, <a href="#b.5)">b.5)</a>.

     BALPOP  ALFA  na  i1  i2  ...  ina
          generates a set of BALSAC output files, populMAiii.plt and/or
          populLAiii.plt, iii= i1, i2 ... ina, for na alpha orbitals. Here,
          for each alpha orbital ii, atom radii are determined by respective
          Mulliken and/or Loewdin populations (&lt;0 and &lt;1) describing the
          orbital character and location inside the system. The orbital indices
          ii reflect the energetic order of the levels (over all symmetries)
          and are identical to those used in the Mulliken/Loewdin analysis of
          the print output.

          The keyword line can contain up to 19 orbital indices. If na &gt; 19
          alpha orbitals are to be included, the index list can be continued on
          the following line(s).

     BALPOP  BETA  nb  i1  i2  ...  inb
          generates a set of BALSAC output files, populMBiii.plt and/or
          populLBiii.plt, iii= i1, i2 ... inb, for nb beta orbitals.
          Information and input format are identical to that of alpha orbitals
          described above.

Examples:

     &gt;MULLIKEN ON                   performs short Mulliken analysis printout
     &gt;BALPOP TOTAL                  and generates a BALSAC file poptotM.plt

     &gt;LOEWDIN ON                    performs short Loewdin and full Mulliken
     &gt;MULLIKEN ON FULL              analysis printout, then generates BALSAC
     &gt;BALPOP BETA 2 101 102         files populMB101.plt, populMB102.plt
                                    (Mulliken output) and populLB101.plt,
                                    populLB102.plt (Loewdin output) for
                                    orbitals 101, 102.


-----------------------------------------------------------------------------
                                                      <a name="e.5)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.5)  DRAW  [MEPS, DENSity, WAVEfunction, SFUNction, XCENergy,</b>
              XCPOtential, FUKUifunction, FFUKuifunction, VOROnoi, BADEr]
-----------------------------------------------------------------------------

This keyword allows to calculate electrostatic potentials, orbital and total
densities, spin densities, orbitals, XC densities, and more on a regular grid.
The corresponding function values are stored in files (binary unit 88, ASCII
unit 98, format details are given below) and can be used later on for graphical
representations or analysis purposes, see e. g. utility khpltps. All function
values are given in atomic units whereas coordinates and lengths saved in file
units 88, 98 refer to Angstrom or Bohr units depending on the definitions used
to describe atom positions, see keywords CARTesian in <a href="#a.1)">a.1)</a> and ZMATrix in <a href="#a.2)">a.2)</a>.
Several DRAW options can be combined in a single StoBe run except for
electrostatic potential plots inside 3-dimensional cubes/polyhedra, see (A)
below.

NOTE that restart files of converged SCF runs or geometry optimizations can be
used for generating plot output files without further iterations by setting

  &gt;RUNType  CPROperties           , see keyword RUNType

 or alternatively

  &gt;RUNType  RESTart               , see keyword RUNType
  &gt;MAXCycles  0                   , see keyword  MAXCycles


(A) Electrostatic potentials

    The keyword line and following numerical line(s)

     DRAW  MEPS  POINts  np
     x1  y1  z1
     ...
          determines the electrostatic potential at np specific points
          (xi,yi,zi), i = 1, np, whose coordinates are on the following lines
          (one line per point). The coordinates are defined in Angstrom or Bohr
          units depending on the definitions used to describe atom positions,
          see keywords CARTesian and ZMATrix. Note that this option does not
          generate binary file output. For details of the output files see
          below.

     DRAW  MEPS  PLANe  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines the electrostatic potential on an equidistant mesh inside
          a rectangular section on a plane. The plane is defined by the three
          positions R0=(x0,y0,z0), R1=(x1,y1,z1), R2=(x2,y2,z2) where R0 forms
          the drawing origin, the x axis points along (R1-R0), and the y axis
          along (R2-R0)' =  [(R1-R0)x(R2-R0)]x(R1-R0) such that
          (R1-R0)*(R2-R0)'=0. The path from R0 to R0+xlen*(R1-R0)/|(R1-R0)| is
          subdivided into nx points, that from R0 to
          R0+ylen*(R2-R0)'/|(R2-R0)'| into ny points, forming altogether an
          nx*ny point mesh over an area of size xlen by ylen. The position
          vectors and lengths are defined in Angstrom or Bohr units depending
          on the definitions used to describe atom positions, see keywords
          CARTesian and ZMATrix. Any of the three triplets (xi, yi, zi) can be
          replaced by an integer number ni pointing to an atom center ni whose
          coordinates will be used for (xi, yi, zi).

          The area section with respect to the origin R0=(x0,y0,z0) can be
          defined more generally by an option line

                DRAW  MEPS  PLANe  xa  xe  ya  ye  nx  ny

          where the section refers to an area [xa, xe] x [ya, ye] wrt. the
          origin. (The above short form uses an area [0, xlen] x [0, ylen].)

          Note that this option generates binary file output. For details of
          the output files see below.

     DRAW  MEPS  CUBE
     x0  y0  z0  xlen  ylen  zlen  nx  ny  nz
          determines the electrostatic potential on an equidistant mesh inside
          a cube. The cube is defined by its origin R0=(x0,y0,z0) and its
          lengths along x (xlen), y (ylen), and z (zlen), i. e. a
          [x0,x0+xlen] x [y0,y0+ylen] x [z0,z0+zlen] block. The block sides are
          subdivided into nx, ny, nz points, respectively, forming altogether
          an nx*ny*nz point mesh. The position vectors are defined in Angstrom
          or Bohr units depending on the definitions used to describe atom
          positions, see keywords CARTesian and ZMATrix. The printout includes
          the minimum value of the MEP within the cube. Note that this option
          does not generate binary file output. For details of the output files
          see below.
          NOTE that this DRAW option cannot be combined with other DRAW task in
          the same StoBe run.


     DRAW  MEPS  GCUBE  x0  y0  z0
     x1  y1  z1  n1
     x2  y2  z2  n2
     x3  y3  z3  n3
          determines the electrostatic potential on an equidistant mesh inside
          a polyhedron spanned by vectors R1 = (x1, y1, z1), R2 = (x2, y2, z2),
          and R3 = (x3, y3, z3) starting from the origin at R0 = (x0, y0, z0).
          (If the vectors R1, R2, R3 are mutually perpendicular the polyhedron
          is rectangular.) The mesh points are given by
                  r = R0 + i*R1/(n1-1) + j*R2/(n2-1) + k*R3/(n3-1)
          where i, j, k run between 0 and n1-1, n2-1, and n3-1, respectively
          which yields an n1*n2*n3 point mesh. The position vectors are defined
          in Angstrom or Bohr units depending on the definitions used to
          describe atom positions, see keywords CARTesian and ZMATrix. The
          ASCII output (unit 98) is given in the Gaussian Cube file format
          (see http://astronomy.swin.edu.au/~pbourke/geomformats/cube/) and can
          be used for example as input to the visualisation tool Molekel
          [MOL03]. This option does not generate binary file output.
          NOTE that this DRAW option cannot be combined with other DRAW task in
          the same StoBe run.

     DRAW  MEPS  SURF  [isur]
          determines the electrostatic potential on any surface defined by grid
          points which are provided separately in a file (units isur, default
          unit = 9) with fixed format

              (I5)     &gt;  ntot
              (3F12.6) &gt;  xi  yi  zi    ,  i = 1, ntot

          The position vectors (xi,yi,zi) are defined in Angstrom or Bohr units
          depending on the definitions used to describe atom positions, see
          keywords CARTesian and ZMATrix. Note that this option does not
          generate binary file output. For details of the output files see
          below.

    All electrostatic potential values are give in atomic units (Hartree,
    corresponding to 27.211608 eV).

(B) Densities

     The keyword line and following numerical line(s)

     DRAW  DENSity  ORBItal  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
     norb  n1  n2  ...
          determines densities of norb (up to 200) orbitals on an equidistant
          mesh inside a rectangular section on a plane where orbitals are
          defined by their indices n1, n2, ... The input line can contain up to
          20 indices pointing to orbitals according to their energetic order
          given in the listing. As an example, n1 = 4 selects the fourth
          orbital in energetic sequence, irrespective of its symmetry label. In
          the output listing of a drawing task the orbital indexing is shown as

            Alpha dens.  ni (  nfia): min= ...
             Beta dens.  ni (  nfib): min= ...

          where ni refers to the energetic order (given in the input) while
          numbers nfia, nfib in parentheses denote the positions of the alpha,
          beta spin orbitals in the restart file. If norb &gt; 20 orbitals are to
          be included, the index list can be continued on the following
          line(s). The plane is defined as described for electrostatic
          potentials.

          The last input line "norb  n1  n2  ..." may be replaced by a line

           HOLU  nocc  nempty

          which uses orbital densities of the nocc highest occupied levels and
          nempty lowest unoccupied levels for input (nocc = 0, nempty = 0 is
          accepted). For details of the output files see below.

     DRAW  DENSity  MIXOrbitals  xlen  ylen  nx  ny   [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
     norb  n1 ns1 q1  n2 ns2 q2 ...
          determines a weighted superposition of norb (up to 200) orbital
          densities on an equidistant mesh inside a rectangular section on a
          plane. The corresponding orbital contributions are each defined by
          index triples (ni nsi qi) where ni gives the orbital index analogous
          to the definition used for orbital densities, see above. Parameter
          nsi defines the spin assignment where nsi = 1 (2) selects the alpha
          (beta) spin orbital and nsi = 3 uses both alpha and beta spin
          orbitals. Each orbital contribution is weighted by a factor qi. As an
          example, the triple (17 2 0.5) defines a density contribution of beta
          spin orbital no. 17 (energetic order, see above) with a weight of
          0.5. The input line can contain up to 6 index triples. If norb &gt; 6
          orbital contributions are to be included, the index list can be
          continued on the following line(s). The plane is defined as described
          for electrostatic potentials.

     DRAW  DENSity  TOTAl  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines the total electron density (numerical and fitted) on an
          equidistant mesh inside a rectangular section on a plane. The plane
          and section are defined as described for electrostatic potentials.
          For details of the output files see below.

     DRAW  DENSity  EXchangecorrelation  xlen  ylen  nx  ny   [ xa  xe  ya ...]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines the Ex, Ec, Exc energy densities on an equidistant mesh
          inside a rectangular section on a plane. The plane is defined as
          described for electrostatic potentials. For details of the output
          files see below.

    All density values are give in atomic units (e/Bohr**3, corresponding to
    6.748343 e/Angstrom**3, for orbital and total densities, H/Bohr**3,
    corresponding to 183.633252 eV/Angstrom**3, for energy densities).

(C) Orbitals

     The keyword line and following numerical line(s)

     DRAW  ORBItal  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
     norb  n1  n2  ...
          determines wavefunction values of norb (up to 200) orbitals on an
          equidistant mesh inside a rectangular section on a plane where
          orbitals are defined by their indices n1, n2, ... The input line can
          contain up to 20 indices pointing to orbitals according to their
          energetic order given in the listing. As an example, n1 = 4 selects
          the fourth orbital in energetic sequence, irrespective of its
          symmetry label. In the output listing of a drawing task the orbital
          indexing is shown as

            Alpha orb.  ni (  nfia): min= ...
             Beta orb.  ni (  nfib): min= ...

          where ni refers to the energetic order (given in the input) while
          numbers nfia, nfib in parentheses denote the positions of the alpha,
          beta spin orbitals in the restart file. If norb &gt;20 orbitals are to
          be included, the index list can be continued on the following
          line(s). The plane and section are defined as described for
          electrostatic potentials.

          The last input line "norb  n1  n2  ..." may be replaced by a line

           HOLU  nocc  nempty

          which uses orbitals of the nocc highest occupied levels and nempty
          lowest unoccupied levels for input (nocc = 0, nempty = 0 is
          accepted). For details of the output files see below.

    All orbital values are give in atomic units (Bohr**(-3/2), corresponding
    to 2.597757 Angstrom**(-3/2)).

(D) Spin difference densities

     DRAW SFUNction  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines the total spin density difference (rho(alpha)-rho(beta)
          from numerical spin densities) on an equidistant mesh inside a
          rectangular section on a plane. The plane and section are defined as
          described for electrostatic potentials. For details of the output
          files see below.

    All spin density values are give in atomic units (spin/Bohr**3,
    corresponding to 6.748343 spin/Angstrom**3).

(E) Exchange and correlation functions

     DRAW XCENergy  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines Ex, Ec and Exc energies on an equidistant mesh inside a
          rectangular section on a plane. The plane and section are defined as
          described for electrostatic potentials. For details of the output
          files see below.

     DRAW XCPOtential  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines Vx, Vc and Vxc potentials on an equidistant mesh inside a
          rectangular section on a plane. The plane and section are defined as
          described for electrostatic potentials.

    All energy values are give in  atomic units (Hartree, corresponding to
    27.211608 eV).

(F) Fukui functions

     DRAW FUKUifunction  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines the (relaxed) Fukui function f+(r) or f-(r) (depending on
          the sign of parameter qfukui, see <a href="#b.5)">b.5)</a>) on an equidistant mesh inside
          a rectangular section on a plane. Here f+(r) / f-(r) include orbital
          relaxation. The plane and section are defined as described for
          electrostatic potentials. For details of the output files see below.
          NOTE that plots of Fukui functions require the FUKUI option to be
          activated, see <a href="#b.4)">b.4)</a>, <a href="#b.5)">b.5)</a>.

     DRAW FFUKuifunction  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines the (frozen) Fukui function f+(r) or f-(r) (depending on
          the sign of parameter qfukui, see <a href="#b.5)">b.5)</a>) on an equidistant mesh inside
          a rectangular section on a plane. Here f+(r) / f-(r) include only
          occupation changes without orbital relaxation (orbitals of the
          restart input file are used). The plane and section are defined as
          described for electrostatic potentials. For details of the output
          files see below. NOTE that plots of Fukui functions require the FUKUI
          option to be activated, see <a href="#b.4)">b.4)</a>, <a href="#b.5)">b.5)</a>.

    All Fukui function values are give in atomic units (e/Bohr**3,
    corresponding to 6.748343 e/Angstrom**3).

(G) Miscellaneous

     DRAW VOROnoi  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines the index of the closest atom for each point on an
          equidistant mesh inside a rectangular section on a plane. This can be
          used to draw the boundaries of the molecular Voronoi cells along the
          plane. The plane and section are defined as described for
          electrostatic potentials. For details of the output files see below.

     DRAW BADEr  xlen  ylen  nx  ny    [ xa  xe  ya  ye  nx  ny]
     x0  y0  z0     (or nc0)
     x1  y1  z1     (or nc1)
     x2  y2  z2     (or nc2)
          determines the index of the Bader attractor atom for each point on an
          equidistant mesh inside a rectangular section on a plane. This can be
          used to draw the boundaries of the molecular Bader cells along the
          plane. The plane and section are defined as described for
          electrostatic potentials. For details of the output files see below.


FORMAT DETAILS OF DRAW OUTPUT FILES

The combination of DRAW tasks of a StoBe run generates output in binary and
ASCII files which can be inspected and used as input to subsequent
applications, see e. g. utility khpltps. The file formats are described in the
following

(a) Binary output files (unit 88)
    The basic file format consists of ntask sets of records 1 - nx described
    below where ntask is the total number of DRAW tasks defined in the StoBe
    input (parameter types are I4=INTEGER*4, R8=REAL*8, Cn=CHARACTER*n):

Record   1
   (C80)         TASKTITL     task title. Possible titles start with the run
                              title followed by

                 'elstat. potential'
                      for plots of the electrostatic potential along a plane.

                 'rho alpha orb.# nn' and 'rho beta  orb.# nn'
                      for orbital density plots of alpha / beta orbital no. nn
                      where nn denotes the orbital index in energetic sequence
                      (shown in the listing).

                 'total density (num.)' and 'total density (fit.)'
                      for total density plots (all occupied orbitals) evaluated
                      numerically or by fitting.

                 'Exchange energy density', 'Correlation energy density' and
                 'Combined XC energy density'
                      for plots of Ex, Ec, Exc energy densities.

                 'wvf alpha orb.# nn' or 'wvf beta  orb.# nn'
                      for orbital plots of alpha / beta orbital no. nn where nn
                      denotes the orbital index in energetic sequence (shown in
                      the listing)

                 'spin difference density'
                      for plots of the total spin density difference.

                 'Exchange energy function', 'Correlation energy function' and
                 'Combined XC energy function'
                      for plots of Ex, Ec and Exc energy distributions.

                 'Exchange potential', 'Correlation potential' and
                 'Combined XC potential'
                      for plots of Vx, Vc and Vxc potential distributions.

Record   2
   (2*R8)        XA, XE       starting and ending point along the x direction
                              (in Bohr or Angstrom defined by the coordinate
                              input, see <a href="#a.1)">a.1)</a> or <a href="#a.2)">a.2)</a>) of the rectangular plot
                              section. The length of the section along x is
                              given by (XE - XA).
   (2*R8)        YA, YE       starting and ending point along the y direction
                              (in Bohr or Angstrom defined by the coordinate
                              input, see <a href="#a.1)">a.1)</a> or <a href="#a.2)">a.2)</a>) of the rectangular plot
                              section. The length of the section along y is
                              given by (YE - YA).
   (I4)          NX           number of points in the equidistant mesh used
                              along the x direction
   (I4)          NY           number of points in the equidistant mesh used
                              along the y direction
   (I4)          NPTS         block size (e.g. 128) used in the blocking of the
                              function array of record 3.

Records  3
   (NX*NY*R8)    ARRAY(I)     function array (in atomic units) in subrecords
                              for all grid points where a blocking of NPTS
                              numbers per subrecord is used. The last subrecord
                              may contain less than NPTS numbers.

Record   4
   (I4)          NCENTER      number of atom centers of the cluster / molecule.

Record   5
   (C4)          LABCEN       label of each atom center
   (R8)          XPROJ        x coordinate of each atom center wrt. plot plane
   (R8)          YPROJ        y coordinate of each atom center wrt. plot plane
   (R8)          ZPROJ        z coordinate of each atom center wrt. plot plane

    where all centers of the cluster / molecule are collected in one record
    (LABCEN(I),XPROJ(I),YPROJ(I),ZPROJ(I), I=1,NCENTER). The coordinates are
    given in Bohr or Angstrom defined by the coordinate input, see <a href="#a.1)">a.1)</a> or
    <a href="#a.2)">a.2)</a>.


(b) ASCII output files (unit 98)

    This output format is self-explanatory and needs no further documentation.
    All coordinates and lengths are given in Bohr or Angstrom defined by the
    coordinate input, see <a href="#a.1)">a.1)</a> or <a href="#a.2)">a.2)</a>.


-----------------------------------------------------------------------------
                                                      <a name="e.6)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.6)  PSCRatch</b>
-----------------------------------------------------------------------------

Four SCF calculations are used to determine the polarization of a system, see
option RUNtype, <a href="#c.1)">c.1)</a>, where, by default, the three SCF runs no. 2 - 4 are
carried out as subsequent restart cases (except for free atoms/ions). This
saves time but can introduce slight errors depending of the SCF convergence
threshold. SCF runs no. 2 - 4 can be forced to start from scratch by including
the keyword line

     &gt;PSCRatch

In polarization calculations on free atoms/ions SCF runs no. 2 - 4 will always
start from scratch.


-----------------------------------------------------------------------------
                                                      <a name="e.7)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.7)   XRAYspectra  [XAS, XES, RIXS]</b>
-----------------------------------------------------------------------------

This keyword allows the calculation of core - valence and core - unoccupied
transition energies and corresponding dipole transition probabilities which can
be used to evaluate theoretical X-ray spectra (XAS = X-ray absorption, XES =
X-ray emission, RIXS = resonant ionization Xray scattering). The three types
of calculations are described in the following.


(A)  Xray absorption spectra (XAS, NEXAFS, XANES)

    The keyword line

         XRAYspectra  XAS

    allows the calculation of X-ray absorption spectra (XAS, NEXAFS) based on
    the transition state approach using the Kohn-Sham orbitals of the present
    StoBe run. The option requires additional keyword input, described below,
    as well as additional basis set input for the augmentation basis to be used
    to describe the excitation orbitals of the final states. The augmentation
    basis is specified at the end of the basis set input (section 2.3).
    Further, the electronic configuration of the StoBe run must correspond to
    that of a transition state where the corresponding core hole level is
    occupied with q = 0.5 electrons. For further background on the techniques
    to compute X-ray spectra consult references [TPA98], [TLP99], [FBH00],
    [PAK00], [KPP01].

    Additional keyword lines are

        REMThreshold  remthr
             defining the threshold (remthr) for linear dependencies in the
             augmentation basis set used in the NEXAFS calculation. The default
             value of remthr (used if this line is omitted) is 0.000001.

        SHIFtenergy  eshft
             defining an energy eshft (in eV) which is used to shift ionization
             potentials and all excitation energies by the same amount. This
             rigid shift can be used to correct for the difference between
             orbital energy and real ionization potential. This is done in most
             cases in the subsequent graphics program. The default value of
             eshft (used if this line is omitted) is 0.0.

        END
             terminating the XAS input. This line must be present even if
             default values for the parameters remthr, eshft are chosen and the
             corresponding lines are omitted.

    NOTE that the 'END' line must always be present in the input.

    The XAS data are, apart from print output, also saved in a spectrum file on
    unit 11 (fort.11, ASCII format) containing excitation energies, oscillator
    strengths, and transition moments. The format is

      Line 1     (A5,I5)  Type,Ntrans

                 Type  = 'XAS  '   characterizes the subsequent data as
                                   referring to Xray absorption.

                 Ntrans            number of core excitations listed below.

      Line(s) 2  (F22.10,2F22.16,9D20.12) (Eex,Osctot,OscR2,Dx,Dy,Dz,
                                           Qxx,Qxy,Qxz,Qyy,Qyz,Qzz), I=1,Ntrans

                describing Ntrans core excitations with

                Eex       excitation energy in Hartree units. The energy may be
                          shifted wrt the level energy difference by eshft, see
                          above.

                Osctot    total dipole oscillator strength of the excitation in
                          a.u. given by

                            Osctot = 2/3 * (Eex-eshft) * ( &lt;final|x|core&gt;**2 +
                                                           &lt;final|y|core&gt;**2 +
                                                           &lt;final|z|core&gt;**2 )

                OscR2     transition moment of the hypothetical R**2 operator,
                          given by

                            OscR2 =  2/3 * (Eex-eshft) *
                                                 &lt;final|x**2+y**2+z**2|core&gt;**2

                          This quantity can be helpful in placing the
                          s-components while it does not correspond to a
                          physical operator.

                Dx, Dy, Dz
                          cartesian components of the dipole transition moment,
                          given by

                            Dx = &lt;final|x|core&gt; ,  Dy = &lt;final|y|core&gt;,
                            Dz = &lt;final|z|core&gt;

                          These components allow the evaluation of total
                          and angular resolved spectra using e. g. utility
                          xrayspec, see Sec. 2.7.6.

                Qxx, Qxy, Qxz, Qyy, Qyz, Qzz
                          cartesian components of the quadrupole transition
                          moment tensor, given by

                            Qxx = &lt;final|xx|core&gt; ,  Qxy = &lt;final|xy|core&gt;,
                            Qxz = &lt;final|xz|core&gt; ,  Qyy = &lt;final|yy|core&gt;,
                            Qyz = &lt;final|yz|core&gt; ,  Qzz = &lt;final|zz|core&gt;,

                          These components allow the evaluation of total
                          and angular resolved spectra using e. g. utility
                          xrayspec, see Sec. 2.7.6.


    Example #1:

    &gt;TITLE
    &gt;h2o O1s excitation based on transition potential for 1s orbital
    &gt;SYMM C2V
    &gt;CARTESIAN ANGSTROM
    &gt;O           0.000000    0.000000    0.212830  8.  32
    &gt;H           0.699763    0.000000   -0.451321  1.  32
    &gt;END
    &gt;RUNTYPE START NOOPTIMIZE
    &gt;SCFTYPE DIRECT
    &gt;POTENTIAL NONLOCAL PD86 PD86
    &gt;GRID FINE NONRANDOM
    &gt;MULTIPLICITY 1
    &gt;CHARGE 0
    &gt;MAXCYCLES 25
    &gt;ECONVERGENCE 0.000001
    &gt;DCONVERGENCE 0.00001
    &gt;DMIXING MDENS 0.40
    &gt;MULLIKEN ON
    &gt;DIIS ON
    &gt;FSYM SCFOCC EXCITED
    &gt;ALFA 3 0 1 1
    &gt;BETA 3 0 1 1
    &gt;SYM 1
    &gt;ALFA 3 1 1 0.5
    &gt;BETA 3 0
    &gt;END
    &gt;XRAY XAS
    &gt;END
    &gt;END
    &gt;A-OXYGEN (4,4;4,4)
    &gt;A-HYDROGEN (4,2;4,2)
    &gt;O-OXYGEN (521/41)
    &gt;O-HYDROGEN (311/1)
    &gt;X-FIRST
    &gt;X-DUMMY
    &gt;END

    For this example the unit 11 output file contains a first line

    'XAS    153'

    followed by 153 lines listing  quantities Eex(H), Osctot, OscR2, Dx, Dy,
    Dz, Qxx, Qxy, Qxz, Qyy, Qyz, Qzz for each transition (all numbers of the
    first 6 and last 3 lines are cut off after 4 digits, quadrupole moments are
    listed on a separate line):

    19.76416  0.0067  0.0051 -0.5028D-09 -0.5612D-16  0.2271D-01
        -0.8124D-02 -0.1282D-15  0.1727D-10 -0.4181D-02  0.3573D-16 -0.7436D-02

    19.84634  0.0160  0.0000 -0.3487D-01  0.7084D-16 -0.3753D-09
         0.1766D-09  0.3402D-13  0.8079D-03  0.5579D-10 -0.9250D-16  0.1185D-09

    19.89767  0.0012  0.0000  0.2237D-15  0.9888D-02  0.8847D-16
        -0.1832D-15 -0.1031D-09 -0.1956D-15 -0.3439D-16  0.4446D-02 -0.2149D-15

    19.90631  0.0011  0.0012 -0.3289D-09  0.8310D-16  0.9328D-02
        -0.4724D-02 -0.5224D-15 -0.4374D-10 -0.6298D-02  0.4344D-16  0.1506D-02

    19.91228  0.0008  0.0297  0.4479D-09  0.1210D-15 -0.8097D-02
         0.1254D-01  0.1532D-15 -0.2152D-09  0.1552D-01 -0.6309D-17  0.1930D-01

    19.92696  0.0014  0.0000 -0.1050D-01  0.5735D-15 -0.4928D-09
        -0.5297D-10  0.4479D-13  0.2830D-02  0.9416D-09 -0.9011D-15  0.5393D-09

    ...........................................................................

    34.12209  0.0936  0.0000  0.1447D-10  0.1645D-11 -0.6417D-01
         0.1502D-03  0.2221D-12 -0.7141D-12 -0.1666D-03 -0.3533D-13  0.3377D-03

    34.17390  0.0931  0.0000 -0.4366D-11 -0.6393D-01 -0.1644D-11
         0.7875D-13 -0.6558D-07  0.8241D-13 -0.6524D-13  0.9139D-04  0.3560D-14

    75.92744  0.0000  0.0104 -0.9598D-13  0.4462D-14  0.1602D-03
         0.4808D-02 -0.1312D-12  0.1086D-13  0.4775D-02  0.2016D-13  0.4806D-02

    where the quantities have been described above. From this file total or
    angle resolved NEXAFS spectra can be generated by convolution using utility
    xrayspec or freefwhm (for the latter see subdirectory XRAY/Convolute of the
    present release). NOTE: In the output listing both the transition moment
    OscR2 and the expectation value of R**2 for the final excited orbital are
    given. The latter can be used to estimate the spatial extent of the excited
    state which can provide some information on the valence versus Rydberg
    character of the excitation.

    Example #2:

    &gt;TITLE
    &gt;Four water molecules in bilayer of ice.
    &gt;Use ECP for the 1s on the oxygens in the waters that are
    &gt;not considered for the excitation.
    &gt;SYMM C1
    &gt;CARTESIAN ANGSTROM
    &gt;O    -2.686528 4.321350 .000000 6. 32
    &gt;O    1.343264  4.321350 2.326602 6. 32
    &gt;O   1.343264   4.321350 -2.326602 6. 32
    &gt;O1   .031838 3.470107 .035066 8. 32
    &gt;H   -3.075511 3.967239 .803056 1. 32
    &gt;H   -1.785863 4.025866 -.022379 1. 32
    &gt;H   2.248521 4.001804 2.327158 1. 32
    &gt;H   .891118 4.001804 3.110856 1. 32
    &gt;H   2.233222 3.967239 -2.261942 1. 32
    &gt;H   .876184 4.034834 -1.552115 1. 32
    &gt;H1  .059902 2.527293 .094088 1. 32
    &gt;H1  .464274 3.812810 .810402 1. 32
    &gt;END
    &gt;FSYM SCFOCC EXCITED
    &gt;ALFA  17
    &gt;BETA  17
    &gt;SYM   1
    &gt;ALFA 17 1 1 0.5
    &gt;BETA 17 0
    &gt;END
    &gt;RUNTYPE START NOOPT
    &gt;SCFTYPE DIRECT
    &gt;POTENTIAL NONLOCAL BE88 PD86
    &gt;GRID FINE RANDOM
    &gt;MULTIPLICITY 1
    &gt;CHARGE 0
    &gt;MAXCYCLES 100
    &gt;XRAY XAS
    &gt;REMTHR  1.E-07
    &gt;END
    &gt;ECONV 0.00001
    &gt;DCONV 0.005
    &gt;DMIX MDENS 0.05
    &gt;MAXOVERLAP
    &gt;MULLIKEN ON
    &gt;DIIS ON
    &gt;PRINTOUT OFF
    &gt;END
    &gt;A-OXYGEN (4,4;4,4)
    &gt;A-OXYGEN (4,4;4,4)
    &gt;A-OXYGEN (4,4;4,4)
    &gt;A-OXYGEN (4,4;4,4)
    &gt;A-HYDROGEN (3,1;3,1)
    &gt;A-HYDROGEN (3,1;3,1)
    &gt;A-HYDROGEN (3,1;3,1)
    &gt;A-HYDROGEN (3,1;3,1)
    &gt;A-HYDROGEN (3,1;3,1)
    &gt;A-HYDROGEN (3,1;3,1)
    &gt;A-HYDROGEN (3,1;3,1)
    &gt;A-HYDROGEN (3,1;3,1)
    &gt;O-OXYGEN(+6) (311/211)
    &gt;O-OXYGEN(+6) (311/211)
    &gt;O-OXYGEN(+6) (311/211)
    &gt;O-OXYGEN iii_iglo
    &gt;O-HYDROGEN (311/1)
    &gt;O-HYDROGEN (311/1)
    &gt;O-HYDROGEN (311/1)
    &gt;O-HYDROGEN (311/1)
    &gt;O-HYDROGEN (311/1)
    &gt;O-HYDROGEN (311/1)
    &gt;O-HYDROGEN (311/1)
    &gt;O-HYDROGEN (311/1)
    &gt;P-OXYGEN(+6) (3,1:10,0)
    &gt;P-OXYGEN(+6) (3,1:10,0)
    &gt;P-OXYGEN(+6) (3,1:10,0)
    &gt;X-DUMMY
    &gt;X-DUMMY
    &gt;X-DUMMY
    &gt;X-FIRST
    &gt;X-DUMMY
    &gt;X-DUMMY
    &gt;X-DUMMY
    &gt;X-DUMMY
    &gt;X-DUMMY
    &gt;X-DUMMY
    &gt;X-DUMMY
    &gt;X-DUMMY
    &gt;END

    For this example the unit 11 output file contains a first line

    'XAS    243'

    followed by 153 lines listing  quantities Eex(H), Osctot, OscR2, Dx, Dy,
    Dz, Qxx, Qxy, Qxz, Qyy, Qyz, Qzz for each transition (all numbers of the
    first 6 and last 3 lines are cut off after 4 digits, quadrupole moments are
    listed on a separate line):

    19.71494  0.0034  0.0013  0.4055D-02 -0.1376D-01  0.7492D-02
         0.3415D-02  0.1375D-04  0.5500D-04  0.3237D-02  0.2835D-04  0.3477D-02

    19.75885  0.0038  0.0003  0.1858D-02  0.1663D-01  0.3095D-02
        -0.1888D-02  0.5575D-04  0.7507D-04 -0.1526D-02  0.8809D-04 -0.1811D-02

    19.79333  0.0013  0.0000 -0.8845D-02  0.3899D-04  0.5179D-02
         0.2081D-03 -0.2086D-03  0.1182D-03  0.1486D-05  0.1167D-03 -0.2076D-03

    19.80733  0.0023  0.0000 -0.1743D-02  0.1288D-01 -0.2865D-02
         0.4559D-03 -0.3060D-04 -0.8058D-04  0.6798D-03 -0.5317D-04  0.3615D-03

    19.82692  0.0002  0.0000 -0.3958D-02 -0.8391D-04  0.2365D-02
        -0.7199D-04 -0.6073D-04 -0.6435D-04  0.3672D-04  0.3434D-04  0.1613D-03

    19.83206  0.0005  0.0006 -0.3175D-02 -0.2437D-03 -0.5834D-02
        -0.2343D-02  0.1125D-03  0.9331D-04 -0.2507D-02  0.2090D-03 -0.2230D-02

    ..........................................................................

    77.03001  0.0481  0.0000 -0.2679D-01  0.5788D-03  0.1481D-01
         0.4522D-05 -0.3402D-05  0.2821D-05 -0.2157D-06  0.1723D-05 -0.3485D-05

    81.83401  0.0000  0.0025 -0.4240D-04  0.5289D-04 -0.7886D-04
         0.2276D-02 -0.5125D-06 -0.2065D-05  0.2276D-02 -0.1020D-05  0.2275D-02

   281.08093  0.0000  0.0001 -0.7156D-06  0.8284D-06 -0.1247D-05
        -0.3370D-03 -0.4186D-07 -0.4766D-06 -0.3354D-03 -0.1162D-06 -0.3369D-03


(B)  Xray emission spectra (XES)

    The keyword line

         XRAYspectra  XES  [ncore  icore(1)  icore(2) ...  icore(ncore)]

    allows the calculation of X-ray emission spectra (XES) corresponding to
    valence -&gt; core level transitions based on ground state, transition state,
    or relaxed core hole state Kohn-Sham orbitals where the electronic
    configuration of the StoBe run (ground, transition, or relaxed core hole
    state) determines the type of approach. The calculation can include several
    initial core hole orbitals where ncore denotes the number of orbitals and
    icore(1), icore(2), ..., icore(ncore) gives their orbital indices. If no
    core orbitals are included in the keyword line (or ncore = 0) then only the
    lowest core orbital with occupation &lt; 1 is used in the calculation. In this
    case the electronic configuration of the StoBe run must correspond to a
    transition state or a relaxed core hole state. NOTE that in XES practice
    the choice of ground state orbitals is preferable over that of transition
    state or core hole state orbitals. For further background on the techniques
    to compute X-ray spectra consult references [TPA98], [TLP99], [FBH00],
    [PAK00], KPP01].

    NOTE that available orbital indices icore(i) are given in the energy level
    listing of the print output, column "(pos.)". Spin beta orbitals have to be
    incremented by an offset NLA which gives the number of occupied spin alpha
    orbitals. As an example, in H2O (5 occupied spin alpha orbitals) the O1s
    orbital has icore = 1 for spin alpha and = 6 for spin beta.

    The option requires additional keyword input with keyword lines

        SHIFtenergy  eshft
             defining an energy eshft (in eV, default = 0.0) which is used to
             shift ionization potentials and all de-excitation energies by the
             same amount. This rigid shift can be used to correct for the
             difference between orbital energy and real ionization potential.
             This is done in most cases in the subsequent graphics program.

        END
             terminating the XES input. This line must be present even if
             default values for the parameters fwhm, eshft, emax are chosen and
             the corresponding lines are omitted.

    NOTE that the 'END' line must always be present in the input.

    The XES data are, apart from print output, also saved in a spectrum file on
    unit 11 (fort.11, ASCII format) containing excitation energies,
    intensities, and transition moments. The format is

      Line 1     (A5,I5)  Type,Ntrans

                 Type  = 'XES  '   characterizes the subsequent data as
                                   referring to Xray emission.

                 Ntrans            number of valence-&gt;core transitions listed
                                   below.

      Line(s) 2  (F22.10,2F22.16,9D20.12) (Eex,Osctot,OscR2,Dx,Dy,Dz,
                                           Qxx,Qxy,Qxz,Qyy,Qyz,Qzz), I=1,Ntrans

                describing Ntrans valence-&gt;core transitions with

                Eex       transition energy in Hartree units. The energy may be
                          shifted wrt the level energy difference by eshft, see
                          above.

                Osctot    total dipole emission intensity of the transition in
                          a.u. given by

                            Osctot = 1/3 * (Etr-eshft)**3 *
                                     ( &lt;final|x|core&gt;**2 + &lt;final|y|core&gt;**2
                                                         + &lt;final|z|core&gt;**2 )

                OscR2     transition moment of the hypothetical R**2 operator,
                          given by

                            OscR2 =  1/3 * (Etr-eshft)**3 *
                                                 &lt;final|x**2+y**2+z**2|core&gt;**2

                          This quantity can be helpful in placing the
                          s-components while it does not correspond to a
                          physical operator.

                Dx, Dy, Dz
                          cartesian components of the dipole transition moment,
                          given by

                            Dx = &lt;final|x|core&gt; ,  Dy = &lt;final|y|core&gt;,
                            Dz = &lt;final|z|core&gt;

                          These components allow the evaluation of total
                          and angular resolved spectra using e. g. utility
                          xrayspec, see Sec. 2.7.6.

                Qxx, Qxy, Qxz, Qyy, Qyz, Qzz
                          cartesian components of the quadrupole transition
                          moment tensor, given by

                            Qxx = &lt;final|xx|core&gt; ,  Qxy = &lt;final|xy|core&gt;,
                            Qxz = &lt;final|xz|core&gt; ,  Qyy = &lt;final|yy|core&gt;,
                            Qyz = &lt;final|yz|core&gt; ,  Qzz = &lt;final|zz|core&gt;,

                          These components allow the evaluation of total
                          and angular resolved spectra using e. g. utility
                          xrayspec, see Sec. 2.7.6.

    If more than one core level is included in the XES calculation the above
    lines 1, 2 are saved on unit 11 for each core level sequentially.


    Example:

    &gt;TITLE
    &gt;NiCO Frozen XES calculation for carbon and oxygen 1s
    &gt;SYMM C4V
    &gt;CARTESIAN BOHR
    &gt;Ni   0.00000    0.00000   0.00000   28.0 64
    &gt;C    0.00000    0.00000   3.17       6.0 64
    &gt;O    0.00000    0.00000   5.37       8.0 64
    &gt;END
    &gt;RUNTYPE  START NOOPTIMIZATION
    &gt;SCFTYPE  CONVENTIONAL
    &gt;POTENTIAL NONLOCAL PD86 PD86
    &gt;GRID FINE RANDOM
    &gt;MULTIPLICITY 1
    &gt;CHARGE 0
    &gt;MAXCYCLES 70
    &gt;ECONVERGENCE 0.000001
    &gt;DCONVERGENCE 0.00001
    &gt;DMIXING MDENS 0.10
    &gt;MULLIKEN ON FULL
    &gt;DIIS ON
    &gt;FSYM SCFOCC
    &gt;ALFA 11 0 1 1 8
    &gt;BETA 11 0 1 1 8
    &gt;XRAY XES 2 4 5
    &gt;END
    &gt;END
    &gt;A-NICKEL (5,8;5,8)
    &gt;A-CARBON (5,2;5,2)
    &gt;A-OXYGEN (5,2;5,2)
    &gt;O-NICKEL (63321/5211*/311+)
    &gt;O-CARBON iii_iglo
    &gt;O-OXYGEN iii_iglo
    &gt;END

    For this example the unit 11 output file contains a first line

    'XES     15'

    describing the first set of transitions (O1s) followed by 15 lines listing
    quantities Etr(H), Osctot, OscR2, Dx, Dy, Dz, Qxx, Qxy, Qxz, Qyy, Qyz, Qzz
    for each transition (all numbers are cut off after 4 digits, quadrupole
    moments are listed on a separate line):

     8.84003  0.0000  0.0010  0.0000D+00  0.0000D+00 -0.1393D-03
         0.1329D-04  0.0000D+00  0.0000D+00  0.1329D-04  0.0000D+00  0.1382D-03

    15.03307  0.0000  0.0000  0.0000D+00  0.0000D+00  0.2648D-06
         0.1071D-04  0.0000D+00  0.0000D+00  0.1071D-04  0.0000D+00  0.2426D-04

    16.37857  0.0000  0.0000  0.0000D+00  0.0000D+00  0.2234D-04
         0.7839D-06  0.0000D+00  0.0000D+00  0.7839D-06  0.0000D+00 -0.1560D-03

    16.42006  0.0000  0.0000  0.1464D-04 -0.3219D-17  0.0000D+00
         0.0000D+00  0.0000D+00 -0.7093D-04  0.0000D+00  0.6555D-18  0.0000D+00

    16.42006  0.0000  0.0000 -0.4121D-17  0.1464D-04  0.0000D+00
         0.0000D+00  0.0000D+00  0.7471D-18  0.0000D+00 -0.7093D-04  0.0000D+00

    17.82309  0.6794  3.1796  0.0000D+00  0.0000D+00 -0.1897D-01
         0.1224D-01  0.0000D+00  0.0000D+00  0.1224D-01  0.0000D+00  0.1328D-01

    18.34703  2.3970  0.6128  0.0000D+00  0.0000D+00 -0.3412D-01
        -0.6830D-02  0.0000D+00  0.0000D+00 -0.6830D-02  0.0000D+00 -0.5992D-02

    18.44251  3.0763  0.2583  0.0000D+00  0.0000D+00  0.3835D-01
         0.2521D-02  0.0000D+00  0.0000D+00  0.2521D-02  0.0000D+00  0.1713D-02

    18.45278  5.1045  0.0000  0.4936D-01 -0.4186D-15  0.0000D+00
         0.0000D+00  0.0000D+00 -0.5723D-03  0.0000D+00  0.8086D-17  0.0000D+00

    18.45278  5.1045  0.0000  0.9127D-15  0.4936D-01  0.0000D+00
         0.0000D+00  0.0000D+00 -0.7844D-17  0.0000D+00 -0.5723D-03  0.0000D+00

    18.63657  0.8159  0.0000 -0.1944D-01  0.2582D-15  0.0000D+00
         0.0000D+00  0.0000D+00 -0.1222D-04  0.0000D+00 -0.4148D-17  0.0000D+00

    18.63657  0.8159  0.0000 -0.3009D-15 -0.1944D-01  0.0000D+00
         0.0000D+00  0.0000D+00 -0.1079D-16  0.0000D+00 -0.1222D-04  0.0000D+00

    18.65392  0.0811  0.0001  0.0000D+00  0.0000D+00 -0.6123D-02
         0.4758D-03  0.0000D+00  0.0000D+00  0.4758D-03  0.0000D+00  0.5143D-03

    18.67967  0.0000  0.0000  0.0000D+00  0.0000D+00  0.5421D-19
         0.3964D-04  0.0000D+00  0.0000D+00 -0.3964D-04  0.0000D+00 -0.5407D-17

    18.67967  0.0000  0.0000  0.0000D+00  0.0000D+00  0.0000D+00
         0.0000D+00  0.3964D-04  0.0000D+00  0.0000D+00  0.0000D+00  0.0000D+00

    after which the line

    'XES     14'

    describing the second set of transitions (C1s) followed by 14 lines listing
    quantities Etr(H), Osctot, OscR2, Dx, Dy, Dz, Qxx, Qxy, Qxz, Qyy, Qyz, Qzz
    for each transition (all numbers are cut off after 4 digits, quadrupole
    moments are listed on a separate line):

     6.19303  0.0000  0.0000  0.0000D+00  0.0000D+00 -0.6250D-03
         0.1042D-03  0.0000D+00  0.0000D+00  0.1042D-03  0.0000D+00  0.6068D-03

     7.53851  0.0006  0.0008  0.0000D+00  0.0000D+00 -0.2146D-02
         0.4583D-03  0.0000D+00  0.0000D+00  0.4583D-03  0.0000D+00  0.1588D-02

     7.58003  0.0000  0.0000  0.2846D-03  0.5266D-17  0.0000D+00
         0.0000D+00  0.0000D+00 -0.1246D-03  0.0000D+00  0.2290D-17  0.0000D+00

     7.58003  0.0000  0.0000  0.3824D-17  0.2846D-03  0.0000D+00
         0.0000D+00  0.0000D+00 -0.6859D-19  0.0000D+00 -0.1246D-03  0.0000D+00

     8.98305  0.2990  0.4685  0.0000D+00  0.0000D+00  0.3518D-01
         0.1222D-01  0.0000D+00  0.0000D+00  0.1222D-01  0.0000D+00  0.1927D-01

     9.50700  0.0096  0.9993  0.0000D+00  0.0000D+00 -0.5795D-02
         0.1916D-01  0.0000D+00  0.0000D+00  0.1916D-01  0.0000D+00  0.2086D-01

     9.60247  1.0327  0.1540  0.0000D+00  0.0000D+00 -0.5915D-01
         0.8436D-02  0.0000D+00  0.0000D+00  0.8436D-02  0.0000D+00  0.5812D-02

     9.61274  0.6664  0.0000  0.4744D-01 -0.8171D-15  0.0000D+00
         0.0000D+00  0.0000D+00  0.2612D-02  0.0000D+00 -0.2260D-16  0.0000D+00

     9.61274  0.6664  0.0000  0.4536D-15  0.4744D-01  0.0000D+00
         0.0000D+00  0.0000D+00  0.5113D-16  0.0000D+00  0.2612D-02  0.0000D+00

     9.79653  0.1026  0.0000  0.1809D-01  0.2605D-15  0.0000D+00
         0.0000D+00  0.0000D+00 -0.2397D-02  0.0000D+00  0.3710D-16  0.0000D+00

     9.79653  0.1026  0.0000  0.7764D-15  0.1809D-01  0.0000D+00
         0.0000D+00  0.0000D+00 -0.4050D-16  0.0000D+00 -0.2397D-02  0.0000D+00

     9.81389  0.0061  0.0063  0.0000D+00  0.0000D+00  0.4412D-02
        -0.2571D-02  0.0000D+00  0.0000D+00 -0.2571D-02  0.0000D+00  0.6986D-03

     9.83964  0.0000  0.0000  0.0000D+00  0.0000D+00  0.7589D-18
         0.3805D-03  0.0000D+00  0.0000D+00 -0.3805D-03  0.0000D+00  0.1084D-17

     9.83964  0.0000  0.0000  0.0000D+00  0.0000D+00  0.0000D+00
         0.0000D+00  0.3805D-03  0.0000D+00  0.0000D+00  0.0000D+00  0.0000D+00


     SPECIAL NOTES for normalization of XES data:

     In some cases it is desirable to use a normalization which makes the XES
     intensity correspond to the number of p-electrons on that specific atom.
     This can be done by summing up the squares of the dipole transition
     moments for an atom and putting up an equation e.g. for carbon A*sum(m)=2
     where A is a normalization constant which is specific for each atom, m are
     the dipole transition moments and 2 comes from that carbon has 2
     p-electrons. The constants for some atoms are:

                C  148.2
                N  198.0
                O  249.5

     The normalization constants were tested for different excited states of
     the atoms and were constant to within about 5%. A simple procedure is to
     convolute the (square of the) transition moments and scale with the factor
     A. This does not include the energy dependence of the XES intensities,
     which will make a difference of a few percent.


(C)  Resonant Inelastic X-ray Scattering (RIXS)

    The keyword line

         XRAYspectra  RIXS  [ncore  icore(1)  icore(2) ...  icore(ncore)]

    allows the calculation of resonant inelastic X-ray scattering (RIXS)
    corresponding to combinations of core -&gt; unocc. and valence -&gt; core
    transitions (resulting in a final state with an electron in a formerly
    unoccupied orbital and a hole in a valence orbital). The calculation is
    based on Kohn-Sham orbitals determined by the electronic configuration of
    the StoBe run (ground, transition, or relaxed core hole state). The RIXS
    analysis can include several initial core hole orbitals where ncore denotes
    the number of orbitals and icore(1), icore(2), ..., icore(ncore) gives
    their orbital indices. If no core orbitals are included in the keyword line
    (or ncore = 0) then only the lowest core orbital with occupation &lt; 1 is
    used in the calculation. In this case the electronic configuration of the
    StoBe run must correspond to a transition state or a relaxed core hole
    state. NOTE that in RIXS practice the choice of ground state orbitals is
    preferable over that of transition state or core hole state orbitals. For
    further background on the techniques to compute X-ray spectra consult
    references [TPA98], [TLP99], [FBH00], [PAK00], KPP01].

    NOTE that available orbital indices icore(i) are given in the energy level
    listing of the print output, column "(pos.)". Spin beta orbitals have to be
    incremented by an offset NLA which gives the number of occupied spin alpha
    orbitals. As an example, in H2O (5 occupied spin alpha orbitals) the O1s
    orbital has icore = 1 for spin alpha and = 6 for spin beta.

    The option requires additional keyword input with keyword lines

        SHIFtenergy  eshft
             defining an energy eshft (in eV, default = 0.0) which is used to
             shift ionization potentials and all transition energies by the
             same amount. This rigid shift can be used to correct for the
             difference between orbital energy and real ionization potential.
             This is done in most cases in the subsequent graphics program.

        END
             terminating the RIXS input. This line must be present even if
             default values for the parameters fwhm, eshft, emax are chosen and
             the corresponding lines are omitted.

    NOTE that the 'END' line must always be present in the input.

    The RIXS data are, apart from print output, also saved in a spectrum file
    on unit 11 (fort.11, ASCII format) containing excitation energies,
    intensities, and transition moments. The format is

      Line 1     (A5,I5)  Type,Ntrans

                 Type  = 'RIXA '   characterizes the subsequent data as
                                   referring to the first part of the RIXS
                                   analysis describing valence-&gt;core
                                   transitions.

                 NtransA           number of valence-&gt;core transitions listed
                                   below.

      Line(s) 2  (F22.10,2F22.16,3D20.12) (Eex,Osctot,OscR2,Dx,Dy,Dz,
                                          Qxx,Qxy,Qxz,Qyy,Qyz,Qzz), I=1,NtransA

                describing NtransA valence-&gt;core transitions with

                Eex       transition energy in Hartree units. The energy may be
                          shifted wrt the level energy difference by eshft, see
                          above.

                Osctot    total dipole emission intensity of the transition in
                          a.u. given by

                            Osctot = 1/3 * (Etr-eshft)**3 *
                                     ( &lt;final|x|core&gt;**2 + &lt;final|y|core&gt;**2
                                                         + &lt;final|z|core&gt;**2 )

                OscR2     transition moment of the hypothetical R**2 operator,
                          given by

                            OscR2 =  1/3 * (Etr-eshft)**3 *
                                                 &lt;final|x**2+y**2+z**2|core&gt;**2

                          This quantity can be helpful in placing the
                          s-components while it does not correspond to a
                          physical operator.

                Dx, Dy, Dz
                          cartesian components of the dipole transition moment,
                          given by

                            Dx = &lt;final|x|core&gt; ,  Dy = &lt;final|y|core&gt;,
                            Dz = &lt;final|z|core&gt;

                          These components allow the evaluation of total
                          and angular resolved spectra using e. g. utility
                          xrayspec, see Sec. 2.7.6.

                Qxx, Qxy, Qxz, Qyy, Qyz, Qzz
                          cartesian components of the quadrupole transition
                          moment tensor, given by

                            Qxx = &lt;final|xx|core&gt; ,  Qxy = &lt;final|xy|core&gt;,
                            Qxz = &lt;final|xz|core&gt; ,  Qyy = &lt;final|yy|core&gt;,
                            Qyz = &lt;final|yz|core&gt; ,  Qzz = &lt;final|zz|core&gt;,

                          These components allow the evaluation of total
                          and angular resolved spectra using e. g. utility
                          xrayspec, see Sec. 2.7.6.

      Line 3     (A5,I5)  Type,Ntrans

                 Type  = 'RIXB '   characterizes the subsequent data as
                                   referring to the second part of the RIXS
                                   analysis describing core-&gt;unocc.
                                   transitions.

                 NtransB           number of core-&gt;unocc. transitions listed
                                   below.

      Line(s) 2  (F22.10,2F22.16,9D20.12) (Eex,Osctot,OscR2,Dx,Dy,Dz,
                                          Qxx,Qxy,Qxz,Qyy,Qyz,Qzz), I=1,NtransB

                describing NtransB core-&gt;unocc. transitions with

                Eex       excitation energy in Hartree units. The energy may be
                          shifted wrt the level energy difference by eshft, see
                          above.

                Osctot    total oscillator strength of the excitation in a.u.
                          given by

                            Osctot = 2/3 * (Etr-eshft)**3 *
                                     ( &lt;final|x|core&gt;**2 + &lt;final|y|core&gt;**2
                                                         + &lt;final|z|core&gt;**2 )

                OscR2     transition moment of the hypothetical R**2 operator,
                          given by

                            OscR2 =  2/3 * (Etr-eshft)**3 *
                                                 &lt;final|x**2+y**2+z**2|core&gt;**2

                          This quantity can be helpful in placing the
                          s-components while it does not correspond to a
                          physical operator.

                Dx, Dy, Dz
                          cartesian components of the dipole transition moment,
                          given by

                            Dx = &lt;final|x|core&gt; ,  Dy = &lt;final|y|core&gt;,
                            Dz = &lt;final|z|core&gt;

                          These components allow the evaluation of total
                          and angular resolved spectra using e. g. utility
                          xrayspec, see Sec. 2.7.6.

                Qxx, Qxy, Qxz, Qyy, Qyz, Qzz
                          cartesian components of the quadrupole transition
                          moment tensor, given by

                            Qxx = &lt;final|xx|core&gt; ,  Qxy = &lt;final|xy|core&gt;,
                            Qxz = &lt;final|xz|core&gt; ,  Qyy = &lt;final|yy|core&gt;,
                            Qyz = &lt;final|yz|core&gt; ,  Qzz = &lt;final|zz|core&gt;,

                          These components allow the evaluation of total
                          and angular resolved spectra using e. g. utility
                          xrayspec, see Sec. 2.7.6.

    If more than one core level is included in the XES calculation the above
    lines 1, 2 are saved on unit 11 for each core level sequentially.


    Example:

    &gt;TITLE
    &gt;NiCO Frozen RIXS calculation for carbon and oxygen 1s
    &gt;SYMM C4V
    &gt;CARTESIAN BOHR
    &gt;Ni   0.00000    0.00000   0.00000   28.0 64
    &gt;C    0.00000    0.00000   3.17       6.0 64
    &gt;O    0.00000    0.00000   5.37       8.0 64
    &gt;END
    &gt;RUNTYPE  START NOOPTIMIZATION
    &gt;SCFTYPE  CONVENTIONAL
    &gt;POTENTIAL NONLOCAL PD86 PD86
    &gt;GRID FINE RANDOM
    &gt;MULTIPLICITY 1
    &gt;CHARGE 0
    &gt;MAXCYCLES 70
    &gt;ECONVERGENCE 0.000001
    &gt;DCONVERGENCE 0.00001
    &gt;DMIXING MDENS 0.10
    &gt;MULLIKEN ON FULL
    &gt;DIIS ON
    &gt;FSYM SCFOCC
    &gt;ALFA 11 0 1 1 8
    &gt;BETA 11 0 1 1 8
    &gt;XRAY RIXS 2 4 5
    &gt;END
    &gt;END
    &gt;A-NICKEL (5,8;5,8)
    &gt;A-CARBON (5,2;5,2)
    &gt;A-OXYGEN (5,2;5,2)
    &gt;O-NICKEL (63321/5211*/311+)
    &gt;O-CARBON iii_iglo
    &gt;O-OXYGEN iii_iglo
    &gt;END

    For this example the unit 11 output file contains a first line

    'RIXA    15'

    describing part A (valence-&gt;core transitions) of the first set of
    transitions (O1s) followed by 15 lines listing  quantities Etr(H), Osctot,
    OscR2, Dx, Dy, Dz, Qxx, Qxy, Qxz, Qyy, Qyz, Qzz for each transition. The
    numerical output is identical to that of the XES example in Sec. (B) above.
    Then the line

    'RIXB    81'

    describes part B (core-&gt;unocc. transitions) of the first set of transitions
    (O1s) followed by 81 lines listing  quantities Eex(H), Osctot, OscR2, Oscx,
    Oscy, Oscz for each transition (all numbers of the first 6 and last 3 lines
    are cut off after 4 digits, quadrupole moments are listed on a separate
    line):

    18.72435  0.0004  0.0000  0.0000D+00  0.0000D+00  0.8122D-02
        -0.8592D-03  0.0000D+00  0.0000D+00 -0.8592D-03  0.0000D+00 -0.7161D-03

    18.76761  0.0055  0.0000 -0.2968D-01  0.1416D-15  0.0000D+00
         0.0000D+00  0.0000D+00 -0.3365D-03  0.0000D+00  0.2276D-17  0.0000D+00

    18.76761  0.0055  0.0000 -0.9443D-16 -0.2968D-01  0.0000D+00
         0.0000D+00  0.0000D+00 -0.9960D-18  0.0000D+00 -0.3365D-03  0.0000D+00

    18.90101  0.0015  0.0000  0.1555D-01 -0.1022D-16  0.0000D+00
         0.0000D+00  0.0000D+00  0.4172D-03  0.0000D+00 -0.5461D-18  0.0000D+00

    18.90101  0.0015  0.0000 -0.3656D-17  0.1555D-01  0.0000D+00
         0.0000D+00  0.0000D+00  0.1945D-17  0.0000D+00  0.4172D-03  0.0000D+00

    18.90602  0.0000  0.0002  0.0000D+00  0.0000D+00 -0.1885D-02
        -0.3042D-02  0.0000D+00  0.0000D+00 -0.3042D-02  0.0000D+00 -0.2674D-02

    ..........................................................................

    74.07447  0.0000  0.0018  0.0000D+00  0.0000D+00 -0.3368D-03
        -0.2851D-02  0.0000D+00  0.0000D+00 -0.2851D-02  0.0000D+00 -0.2909D-02

   151.43965  0.0000  0.0000  0.0000D+00  0.0000D+00 -0.3646D-04
        -0.9415D-05  0.0000D+00  0.0000D+00 -0.9415D-05  0.0000D+00  0.1656D-03

   273.00328  0.0000  0.0000  0.0000D+00  0.0000D+00  0.1377D-04
         0.3482D-03  0.0000D+00  0.0000D+00  0.3482D-03  0.0000D+00  0.3323D-03

    after which the line

    'RIXA    14'

    describes part A (valence-&gt;core transitions) of the second set of
    transitions (C1s) followed by 14 lines listing  quantities Etr(H), Osctot,
    OscR2, Dx, Dy, Dz, Qxx, Qxy, Qxz, Qyy, Qyz, Qzz for each transition. The
    numerical output is identical to that of the XES example in Sec. (B) above.
    Then the line

    'RIXB    81'

    describes part B (core-&gt;unocc. transitions) of the second set of
    transitions (C1s) followed by 81 lines listing  quantities Eex(H), Osctot,
    OscR2, Oscx, Oscy, Oscz for each transition (all numbers of the first 6 and
    last 3 lines are cut off after 4 digits, quadrupole moments are listed on a
    separate line):

     9.88432  0.0008  0.0011  0.0000D+00  0.0000D+00 -0.1595D-01
         0.7321D-02  0.0000D+00  0.0000D+00  0.7321D-02  0.0000D+00  0.3828D-02

     9.92757  0.0075  0.0000  0.4782D-01 -0.3529D-15  0.0000D+00
         0.0000D+00  0.0000D+00 -0.1676D-02  0.0000D+00  0.1287D-16  0.0000D+00

     9.92757  0.0075  0.0000 -0.4396D-17  0.4782D-01  0.0000D+00
         0.0000D+00  0.0000D+00 -0.3201D-17  0.0000D+00 -0.1676D-02  0.0000D+00

    10.06097  0.0093  0.0000 -0.5278D-01 -0.4493D-16  0.0000D+00
         0.0000D+00  0.0000D+00  0.3556D-03  0.0000D+00  0.3323D-18  0.0000D+00

    10.06097  0.0093  0.0000 -0.1071D-15 -0.5278D-01  0.0000D+00
         0.0000D+00  0.0000D+00  0.1382D-17  0.0000D+00  0.3556D-03  0.0000D+00

    10.06599  0.0002  0.0000  0.0000D+00  0.0000D+00  0.8920D-02
        -0.6149D-03  0.0000D+00  0.0000D+00 -0.6149D-03  0.0000D+00 -0.3945D-02

    ..........................................................................

    65.23444  0.0000  0.0000  0.0000D+00  0.0000D+00  0.3562D-03
        -0.2217D-03  0.0000D+00  0.0000D+00 -0.2217D-03  0.0000D+00  0.5204D-03

   142.59961  0.0000  0.0001  0.0000D+00  0.0000D+00 -0.5483D-05
         0.8882D-03  0.0000D+00  0.0000D+00  0.8882D-03  0.0000D+00  0.2517D-03

   264.16325  0.0000  0.0000  0.0000D+00  0.0000D+00 -0.4110D-05
        -0.9673D-04  0.0000D+00  0.0000D+00 -0.9673D-04  0.0000D+00  0.2216D-03


-----------------------------------------------------------------------------
                                                      <a name="e.8)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.8)  TOPOlogical  [ORBital] [BALsac] [qcore  rhomin  qstep]</b>
-----------------------------------------------------------------------------

This keyword starts a topological charge (and orbital) analysis and prints atom
charges according to Becke (Becke atom integrals), Voronoi (charges inside
Voronoi cells of the cluster), and Bader (charges inside Bader atom cells
[B95]).

   ORBital   (optional) includes an orbital projection of atom charges (all
             occupied orbitals only). Note that for systems with symmetry and
             representations of dimension &gt; 1 (e. g. C4v symmetry and 2-dim. E
             representation) corresponding symmetry orbitals may give erroneous
             atom charges. Orbital projections are not included by default.

   BALsac    (optional) initiates BALSAC [H00] format file output to visualize
             and analyze total (i.e. not orbital-specific) atom charges derived
             from Becke, Voronoi, and Bader analyses. The different charge
             plots are saved in files

               - BeckeCh.plt  for total Becke atom charges
               - VoronCh.plt  for total Voronoi atom charges
               - BaderCh.plt  for total Bader atom charges

             The output files can be used as input to BALSAC where the atoms of
             a cluster/molecule are displayed as shaded balls. The ball radii
             are defined by the actual atom charges and positive/negative
             charges are shown by different colors (green/blue by default,
             corresponding to ball "charges" Z = 1 / = 2) in the plot.

   qcore     (optional, default = 0.8) determines the radius of a core sphere
             about each atom inside which charge is uniquely assigned to the
             atom. The definition of the core radius, as used in the Bader
             analysis, is given by Rcore = qcore * Rslater where Rslater is the
             Slater radius of the corresponding atom. Slater radii are
             defaulted internally but may be redefined with option
             SLATer_radii, see <a href="#c.13)">c.13)</a>.

   rhomin    (optional, default = 1.D-6 e/Bohr^3) defines the smallest value of
             the (weighted) charge density of an integration point to be
             included in the charge evaluation.

   secmin    (optional, default = 0.1 Bohr) defines the smallest section length
             of all polygons used to approximate Bader attractor paths. For a
             given point in space the length of a local polygon section depends
             non-linearly on the local charge gradient whith the section length
             ranging inside [secmin, 6*secmin].

NOTE that, depending on the system and parameter choices, this analysis can be
very time consuming.

Examples:

     &gt;TOPO
     &gt;TOPO  0.9
     &gt;TOPO  0.8  1.D-6  0.05
     &gt;TOPT ORB 2 7 8
     &gt;TOPO BAL 0.7
     &gt;TOPO BAL ORB .7 1.D-4 .2    equivalent with    &gt;TOPO ORB BAL .7 1.D-4 .2


-----------------------------------------------------------------------------
                                                      <a name="e.9)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.9)  NMROut</b>
-----------------------------------------------------------------------------

This keyword prepares output for subsequent NMR spectral data calculations on
units 70, 71, 72. Requires additional program (V. Malkin and O. Malkina).
NOTE that this option forces a diis level shift = 0 and uses the largest
possible angular integration grid.


-----------------------------------------------------------------------------
                                                      <a name="e.10)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.10)  EPROut</b>
-----------------------------------------------------------------------------

This keyword prepares output for subsequent EPR spectral data calculations on
units 73, 74, 75. Requires additional program (V. Malkin and O. Malkina).
NOTE that this option forces a diis level shift = 0 and uses the largest
possible angular integration grid.


-----------------------------------------------------------------------------
                                                      <a name="e.11)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.11)  VIBRations  [modes]  [basis]  [maxd]</b>
-----------------------------------------------------------------------------

This keyword defines details of the vibrational analysis, see also keyword
RUNType, option <a href="#c.1)">c.1)</a>. NOTE that in the input line any of the three options may
be left out but the option sequence, [modes] before [basis] before [maxd], must
be kept. Options

   modes =  ALL       evaluates vibrational modes of all symmetry
                      representations. This is the default if no modes keyword
                      is given.  NOTE that evaluating all vibrational modes may
                      be rather time consuming!)

         =  SELected  evaluates vibrational modes of specific representations
                      of the point symmetry group of the cluster (the group is
                      defined with the cluster coordinates, see <a href="#a.4)">a.4)</a>). The
                      representations have to be provided by corresponding
                      symmetry labels of the point symmetry group on the
                      subsequent input line (format is 12A, see examples).

                      NOTE that including the highest symmetry representation
                      (labels A, A1, or A1g) in the selectron may lead to
                      improved anharmonicity treatment in the analysis.

         =  BASis     evaluates vibrational displacement vectors of all
                      representations of the point symmetry group of the
                      cluster but does not calculate vibrational excitations.
                      The displacement vectors are saved on unit 60 and can be
                      used as input in a subsequent calculation of vibrational
                      excitations, see option basis = INPut below.

                      NOTE that this option, if combined with the restart
                      option (RUNType RESTart VIBRations, see <a href="#c.1)">c.1)</a>, does not
                      start an SCF run but takes geometry, symmetry, and
                      electronic parameter information from the restart file.

   basis =  GUEss     constructs a basis of the (symmetry adapted) displacement
                      vectors using an intelligent guess based on atom charges
                      and bond orders. This is the default if no basis keyword
                      is given.

         =  INPut     reads a basis of the (symmetry adapted) displacement
                      vectors from file (unit 60).

   maxd               maximum atom displacement used to evaluate force
                      derivatives by finite differences (maxd in Bohr or
                      Angstrom depending on the initial coordinate input, see
                      <a href="#a.1)">a.1)</a>. The default value, if no value given, is 0.01
                      Bohr).

The vibrational analysis creates, in addition to list output of vibrational
frequencies (in harmonic approximation), dynamical dipoles, and displacement
vectors, corresponding file output

  - in a generic StoBe format on file unit 65 which collects frequencies,
    dynamical dipoles, and symmetry labels of all vibrational excitation modes.
    These files can be used as input to utility irspec, see 2.7.7, to evaluate
    total and angle-resolved vibrational (infrared, IR) spectra for graphical
    output or for further processing. The file format is

        Line 1   (I5)   NLEVL

              NLEVL    number of vibrational levels

        Line(s) 2   (F10.3,4D15.6,A8)   EV,D2,Dx,Dy,Dz,SYLBL  , i= 1, ... NLEVL

              EV            energy (in cm-1) of vibrational level i
              D2            = Dx**2 + Dy**2 + Dz**2
              Dx, Dy, Dz    Cartesian components of the dynamical dipole moment
                            (in a.u.) of vibrational level i
              SYLBL         symmetry label of vibrational level i

  - in Molekel format on file unit 59 which can be used to visualize
    vibrational modes with the interactive graphics package Molekel [MOL03].
    Note that StoBe creates animation files for vibrational properties only in
    Molekel format

Examples:

     &gt;VIBRATE  BASIS                     (determine distorsion vector basis
                                          only, no mode calculation)

     &gt;VIBRATE  ALL  GUESS  0.01          (default setting)

     &gt;VIBRATE  SEL  0.005                (selected modes of representations
     &gt; A2 B2                              A2, B2 only (e.g. in a cluster of C4V
                                          symmetry; max. atom displacement =
                                          0.005 Angstrom)


-----------------------------------------------------------------------------
                                                      <a name="e.12)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.12)  NEBparameters</b>
-----------------------------------------------------------------------------

This keyword defines control parameters of a reaction path optimization using
the nudged-elastic-band (NEB) method, see <a href="#c.1)">c.1)</a>, where both the standard NEB
[MJ94, MJG95, JMJ98] and the climbing-image-NEB (CI-NEB) approach [HUJ00] are
implemented.

    Additional keyword lines are

        NIMAge   nneb
             defining the number of NEB images (integer nneb &gt;= nimg) of the
             NEB path evaluated in each optimization step. The default value of
             nneb (used if this line is omitted) is nneb = nimg where nimg &gt;= 2
             is obtained with the cartesian coordinate input, see <a href="#a.1)">a.1)</a>.

             For NEB runs from scratch, nneb images are calculated by linear
                coordinate interpolation between the nimg initial images given
                in the input file, see <a href="#a.1)">a.1)</a>.

             For NEB restart runs nneb = nimg is assumed and the nneb images
                are taken from the restart input files (ignoring the explicit
                coordinates of the input file).

        MAXPath  maxpath
             defining the (integer valued) maximum number of path iterations of
             a NEB optimization to obtain a converged path. The actual number
             of iterations may be smaller than maxpath if convergence is
             reached earlier, see below. The default value is maxpath = 1.

        NEBOpt [number  [scale]]
             defining the local optimization and path extrapolation method used
             in the NEB path optimization. The following methods are available:

              number = 0   Steepest descent (extrapolation mixing alpha= 1.0)
                       1   Steepest descent (extrapolation mixing alpha= 0.5)
                       2   Conjugate gradient (extrapolation mixing alpha= 1.0)
                       3   Conjugate gradient (extrapolation mixing alpha= 0.5)
                       4   Conjugate gradient, Polak-Ribiere variant
                       5   Quasi-Newton, Davidson-Fletcher-Powell variant
                       6   Quasi-Newton, Murtaugh - Sargent variant
                       7   Quasi-Newton, Broyden-Fletcher-Goldfarb-Shanno
                           variant (default), no line search available so far

              With extrapolation methods number 0, 1, 2, 3 the extrapolation
              mixing factor alpha may be set explicitly using the (optional)
              parameter scale. For values scale &lt; 0.5 this may result in an
              increased number of convergence steps but smoother convergence.


        SPRIng  sprng  sprngv
             defining the spring constants (R*8 values) used in the elastic
             coupling between adjacent images along the NEB reaction path. Here
             constant sprng is the basic spring constant while sprngv gives the
             variation of the spring constant for the lowest images (i.e. value
             sprng is replaced by sprng - sprngv). For sprngv = 0.0 a fixed
             spring constant will be applied. The default values of sprng,
             sprngv (used if this line is omitted) are sprng = 0.1,
             sprngv = 0.0.

        NEBConvergence  cvgneb  cvgnebci
             defining the convergence thresholds (R*8 values) used in the
             comparison of paths between subsequent path iterations of a NEB
             optimization. Here cvgneb is the NEB gradient convergence
             threshold which refers to Cartesian path gradients of dimension
             ntot*3 (x, y, z components of atoms 1 ... ntot in a.u.). Parameter
             cvgnebci denotes the climbing image convergence threshold (ntot*3
             dimesional gradient in a.u.) which becomes active after NEB
             gradient convergence is reached. For cvgnebci = 0.0 no climing
             image calculation will be performed. The default values of cvgneb,
             cvgnebci (used if this line is omitted) are cvgneb = 0.001,
             cvgnebci = 0.0.

        MAXStep  [stepmax]  [fscale]
             defining an upper bound to the allowed maximum displacement of
             atoms between successive steps in a NEB path optimization
             (stepmax in Bohr or Angstrom depending on the initial coordinate
             input, see <a href="#a.1)">a.1)</a>. Larger displacements will be reduced to the
             maximum while their direction remains unchanged. A reasonable
             value is 0.25 Bohr with the default = 0.5 Bohr. The second
             (optional) value allows to scale all displacements (evaluated
             initially according to forces) by a constant factor fscale (with
             default = 1.0). For values fscale &lt; 1.0 this may result in an
             increased number of convergence steps but smoother convergence.

        NEBInput  [FILE, READ]
             defining geometric (and electronic) structure of all images used
             to determine the initial path. By default, nimg different initial
             images, provided in the coordinate section of the input file (see
             <a href="#a.1)">a.1)</a>), are used to calculate a first path of nneb &gt; nimg images
             starting an NEB run from scratch. These initial images can also
             be provided by separate restart files from earlier StoBe runs,
             such as geometry optimizations. The keyword line

                NEBInput FILE
                      assumes all nimg initial images to be defined by StoBe
                      restart files available in file units nrbaseinp to
                      nrbaseinp+nimg-1 (nrbasinp = 100 by default), see <a href="#e.13)">e.13)</a>.
                      However, (dummy) coordinates of all images have to be
                      present in the input file and will be overwritten by
                      those of the restart files. Further, the electroinc
                      parameters of the restart files will be used as inital
                      input of the corresponding initial images (restart
                      case).

                NEBInput READ
                      assumes the atom coordinates of all nimg initial images
                      to be defined in the input file. The electronic
                      structure of the initial images will be calculated from
                      scratch. This is the default if keyword NEBInput is not
                      given in the input.

        NEBPrint  [COORdinates, FORCes, ALL]
             defining print output during the NEB path calculation. The
             keyword line

                NEBPrint COORdinates
                      prints atom coordinates of all images after completion
                      of a path step of nneb images.

                NEBPrint COORdinates
                      prints atom forces (both initial Pulay and NEB corrected
                      forces) of all images after completion of a path step
                      of nneb images.

                NEBPrint ALL
                      prints both atom coordinates and atom forces of all
                      images after completion of a path step of nneb images.

        END
             terminating the NEB parameter input. This line must be present
             even if default values for all NEB control parameters are chosen
             and the corresponding lines are omitted.

    NOTE that the 'END' line must always be present in the input.

Example:

     &gt;NEBP
     &gt;NIMAGE 9
     &gt;MAXPATH 50
     &gt;NEBOPT 2 1.
     &gt;SPRINGS .5 .1
     &gt;NEBCONVERGENCE  1.D-3 1.D-5
     &gt;MAXSTEPS .1
     &gt;NEBINPUT READ
     &gt;END


-----------------------------------------------------------------------------
                                                      <a name="e.13)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.13)  RESInput  nrbasinp</b>
-----------------------------------------------------------------------------

This allows to redirect the fortran unit number(s) of one or more restart
files.

For single image runs (nimg = 1, see <a href="#a.1)">a.1)</a>), nrbasinp (defaulted to
nrbasinp = 1) defines the (redirected) unit number nrbasinp assuming the
restart file to be linked to fort.{nrbasinp}.

For multiple image runs, such as NEB path runs (nimg &gt; 1, see <a href="#e.12)">e.12)</a>), nrbasinp
(defaulted to nrbasinp = 100) defines the offset of subsequent unit numbers,
i.e. units {nrbasinp}, {nrbasinp+1}, ..., {nrbasinp+nimg-1} will be used. This
assumes the restart files to be linked to fort.{nrbasinp}, fort.{nrbasinp+1},
..., fort.{nrbasinp+nimg-1}.

NOTE that redirecting unit numbers may conflict with existing units used for
other parameter files, see Sec. 2.6.

Example:

     &gt;RESINPUT  100


-----------------------------------------------------------------------------
                                                      <a name="e.14)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> e.14)  RESOutput  nrbasout</b>
-----------------------------------------------------------------------------

This allows to redirect the fortran unit number(s) of one or more restart
output files used for subsequent StoBe runs.

For single image runs (nimg = 1, see <a href="#a.1)">a.1)</a>), nrbasout (defaulted to
nrbasout = 2) defines the (redirected) unit number nrbasout for restart file
output assuming fort.{nrbasout} as output file.

For multiple image runs, such as NEB path runs (nimg &gt; 1, see <a href="#e.12)">e.12)</a>), nrbasout
(defaulted to nrbasout = 200) defines the offset of subsequent unit numbers,
i.e. units {nrbasout}, {nrbasout+1}, ..., {nrbasout+nn-1} will be used for
output where nn = nimg applies to regular multiple image runs and nn = nneb
to NEB runs, see <a href="#e.12)">e.12)</a>.

NOTE that redirecting unit numbers may conflict with existing units used for
other parameter files, see Sec. 2.6.

Example:

     &gt;RESOUTPUT  200


<a name="2.2.6."><b>2.2.6.</a>  MISCELLANEOUS KEYWORDS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

-----------------------------------------------------------------------------
                                                      <a name="f.1)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.1)  TITLe</b>
-----------------------------------------------------------------------------

Brief descriptive title of the present StoBe run on the lines following the
keyword. This title appears in the output file(s).

Example:

     &gt;TITLE
     &gt;h2o local opt
     &gt;test run

Note that, while the title input in the input file allows any number of lines,
restart files save only the first line of the title. In the above example only
the title line 'h2o local opt' would be saved. Continued title lines must not
start with a word identical to a keyword of StoBe input.


-----------------------------------------------------------------------------
                                                      <a name="f.2)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.2)  PRINtout [DISTances, BASIs, ORBItals, FORBitals, IORBitals, SORBitals,</b>
                 DIPOles, QUADrupoles, MULTipoles, POINtcharges, HESSian,
                 ZMATrix, TIMIng, SPACe, DEFAult, SHORt, FULL]
-----------------------------------------------------------------------------

This keyword allows more detailed print output for SCF runs and geometry
optimizations where any combination of option keywords from the above list is
allowed. Option keyword

     DISTances       includes a listing of all interatomic distances in the
                     output.

     BASIs           includes a listing of all orbital, auxiliary, model
                     potential, and augmented basis sets in the output.

     ORBItals        includes a listing of all orbitals at the end of SCF
                     calculations or geometry optimizations. If an orbital
                     component is &lt; .000001 in absolute value for all orbitals
                     within a symmetry respresentation it will not be listed.

     FORBitals       same as option ORBItals but all orbital components are
                     listed.

     IORBitals       includes a listing of all initial input orbitals at SCF
                     startup (restart or start from scratch). In geometry
                     optimizations this listing is given for each extrapolation
                     geometry.

                     If both keywords IORBitals and SORBitals appear in the
                     input only keyword SORBitals will be used since the
                     orbital listing of the first iteration step gives the
                     initial input orbitals.

     SORBitals       includes a listing of all input orbitals at each iteration
                     step of SCF calculations or geometry optimizations. In
                     particular, the listing at the first iteration step refers
                     to the input orbitals at startup (restart or start from
                     scratch).

     DIPOles         includes a listing of all dipole transition moments
                     (cartesian components, no quadrupole components) at the
                     end of SCF calculations where XAS or XES transitions are
                     evaluated.

     QUADrupoles     includes a listing of all quadrupole transition moments
                     (cartesian components, no dipole components) at the
                     end of SCF calculations where XAS or XES transitions are
                     evaluated.

     MULTipoles      includes a listing of all dipole and quadrupole transition
                     moments (cartesian components) at the end of SCF calculations
                     where XAS or XES transitions are evaluated.

     POINtcharges    includes a listing of all external point charges in the
                     input of SCF calculations or geometry optimizations
                     (place keyword BEFORE point charge listing, see keyword
                     PTCH).

     HESSian         includes a listing of eigenvectors of the Hessian matrix
                     at each iteration step of geometry optimizations.

     ZMATrix         includes a listing of all atom centers in Z-matrix
                     notation (internal coordinates) irrespective of the input
                     format, see <a href="#a.1)">a.1)</a>, <a href="#a.2)">a.2)</a>. For internal coordinate input this
                     listing is always included but does not appear for
                     cartesian coordinate input. Note that for cartesian
                     coordinate input dihedral angles may not be meaningful for
                     all atoms depending on the atom sequence (e. g. if three
                     subsequent atoms are collinear the fourth atom canot be
                     assigned a dihedral angle). In this case the dihedral
                     angle is given a value = 0.0 deg.

     TIMIng          includes additional timing information which may be
                     useful to optimize cpu usage. The timing printout mixes
                     with the actual StoBe results and is useful only for
                     testing.

     SPACe           includes information about the space the restart output
                     file (in bytes, unit 2) which may be useful to organize
                     file usage.

     DEFAult         combines option keywords ORBItals, MULTipoles,
                     POINtcharges and excludes HESSian, SORBitals, TIMIng.
                     This is the default if no PRINtout keyword line appears
                     in the input. The keyword DEFAult overrides all previous
                     settings. Thus, the following keyword lines are
                     equivalent:

                        &gt;PRINTOUT TIMING SORBITALS DEFAULT HESSIAN
                        &gt;PRINTOUT DEFAULT HESSIAN
                        &gt;PRINTOUT ORBITALS MULTIP HESSIAN

     SHORt           includes none of the above listing options. The keyword
                     SHORt overrides all previous settings. Thus, the following
                     keyword lines are equivalent:

                        &gt;PRINTOUT TIMING SORBITALS SHORT HESSIAN
                        &gt;PRINTOUT SHORT HESSIAN

     FULL            includes all of the above listing options. This option
                     generates an extremely large output listing file and is
                     meaningful only for testing purposes. The keyword FULL
                     overrides all previous settings. Thus, the following
                     keyword lines are equivalent:

                        &gt;PRINTOUT TIMING SORBITALS FULL HESSIAN
                        &gt;PRINTOUT FULL

Example:

     &gt;PRINTOUT  SORBITALS  TIMING  SPACE


-----------------------------------------------------------------------------
                                                      <a name="f.3)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.3)  SAVE  ns</b>
-----------------------------------------------------------------------------

This option allows periodic updates of the restart file (unit 2) in addition
to the restart output at the end of an SCF calculation or geometry
optimization. With this keyword line the restart file is updated (overwritten
by the most recent result) every ns iteration steps in the SCF cycle and for
geometry optimizations a restart file update is performed at the end of each
geometry step.

By default, restart file output happens only at the end of a calculation.
Intermediate restart file update is strongly suggested for large systems and
can save time in case of system crashes.


-----------------------------------------------------------------------------
                                                      <a name="f.4)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.4)  ORBItalchoice  [5D, 6D, 5D1S]</b>
-----------------------------------------------------------------------------

This keyword determines the internal representation of d basis functions.
Option keyword

     6D     uses the 6 cartesian gaussian d functions (x2, y2, z2, xy, xz,
            yz) to represent d orbital basis functions.

     5D1S   uses the 5 atomic gaussian d functions (dz2,dx2-y2, dxy, dxz,
            dyz) to represent d orbital basis functions and adds the 6th
            function (x2+y2+z2) to the s orbital basis function set. This
            representation is equivalent to option 6D but the distinction
            between atomic d and s function is more explicit.

     5D     (default) uses the 5 atomic gaussian d functions (dz2,dx2-y2,
            dxy, dxz, dyz) to represent d orbital basis functions. This
            eliminates linear dependencies associated with the s-component of
            the d-functions, facilitates analysis of the wave function and is
            strongly recommended!

Total energies from calculations using options 6D and 5D1S yield the same
results which are somewhat different from those using option 5D since the
latter uses in effect a smaller, but much safer, basis set. For atoms, the
choice of keywords 'FSYM' and option 6D switches to option 5D1S due to
rotational symmetry.


-----------------------------------------------------------------------------
                                                      <a name="f.5)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.5)  ECPRead</b>
-----------------------------------------------------------------------------

This keyword allows the use of an alternative set of one-electron integrals
(and nuclear repulsion contributions) in a StoBe calculation. The data are
read in from unit 52. Examples are calculations where the core potential is
modified from a previous calculation.


-----------------------------------------------------------------------------
                                                      <a name="f.6)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.6)  PNTGenerator  ng</b>
-----------------------------------------------------------------------------
This keyword allows the selection of different gridpoint generators in the
angular integration. For

     ng = 0      (default) a Gauss-Legendre grid for theta and an equidistant
                 grid for phi is used.

        = 1      a Gauss-Legendre grid for both theta and phi is used.

        = 2      a Gauss-Legendre grid for theta and an equidistant grid for
                 phi with twice the number of grid points (compared with
                 ng=0) is used


-----------------------------------------------------------------------------
                                                      <a name="f.7)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.7)  ALCHem                                      (NOT IMPLEMENTED)</b>
-----------------------------------------------------------------------------
This keyword initiates output of geometry, basis, and orbital coefficients on
a separate file, named ALCHEM.inp. The data is stored in ALCHEM format for
further processing by the visualization and analysis software ALCHEM.


-----------------------------------------------------------------------------
                                                      <a name="f.8)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.8)  FILEoutput [MOLDen] [GMOLDen] [MOLEkel]</b>
-----------------------------------------------------------------------------

This keyword generates analysis output files to be used as input for the
interactive visualization packages Molden [MOD03] and Molekel [MOL03]. Keyword
line

      FILEoutput MOLDen
                 generates file Molden.molf of generic Molden format which can
                 be used as input for the visualization software Molden.

      FILEoutput GMOLDen
                 generates file GMolden.mdf of Gaussian-94 format which can be
                 used as input for the visualization software Molden. This
                 option was used as default in previous StoBe versions and had
                 to be disabled by keyword NOMOlden (no Molden file output).
                 The obsolete keyword NOMOlden leads to a warning.

      FILEoutput MOLEkel
                 generates file Molekel.mkl of generic Molekel format which can
                 be used as input for the visualization software Molekel.

The keyword line allows also multi-file output of any combination of the three
format types. For example, keyword line

      &gt; FILE MOLDEN MOLEKEL

produces files Molden.molf and Molekel.mkl. By default all analysis file output
is disabled.

The interactive graphics package Molden [MOD03] visualizes geometric and
electronic properties as well as convergence parameters. The software has been
developed by Gijs Schaftenaar, CAOS/CAMM Center.

The interactive graphics package Molekel [MOL03] visualizes geometric,
electronic and vibrational properties. The software has been developed by
Stefan Portmann and Peter F. Fluekiger at CSCS/ETHZ/UNIGeneva.


-----------------------------------------------------------------------------
                                                      <a name="f.9)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.9)  VIRTuals  [ALL, NONE, nvirt]</b>
-----------------------------------------------------------------------------

This keyword allows to define the number of virtual (unoccupied) orbitals to be
included in the output listing of orbital energies, orbital coefficients, and
in a full Mulliken population analysis. By default, output listings contain all
occupied and empty orbitals with KS energies below the HOMO energy. Setting

     VIRTuals  ALL    includes all virtual orbitals of all symmetry
                      representations in the output listing.

     VIRTuals  NONE   includes no virtual orbitals with KS energies above the
                      HOMO energy in the output listing. Only occupied orbitals
                      (and empty orbitals below the HOMO) are listed.

     VIRTuals  nvirt  (where nvirt &gt; 0 is an integer) includes, for each
                      symmetry representation, up to nvirt orbitals in the
                      output listing. If in a given representation there are
                      nempt &gt; 0 empty orbitals below the HOMO these orbitals
                      will be listed and included in the virtual orbital count
                      such that max(nvirt,nempt) virtual orbitals appear in the
                      listing. If the total number of orbitals in a given
                      symmetry representation is too small the actual number of
                      included virtuals may be smaller than nvirt.

In spin polarized cases, orbitals which are occupied in only one spin subspace
(alpha or beta) are included also with their (unoccupied) spin complement in
the listing of orbital energies and  Mulliken populations, but not in the
listing of orbital coefficients.

By default up to 5 virtual orbitals are included in the output listing
(corresponding to 'VIRTuals 5').


-----------------------------------------------------------------------------
                                                      <a name="f.10)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.10)  CTRLoption  [ctrlfn]</b>
-----------------------------------------------------------------------------

With this keyword, StoBe saves a collection of important control parameters
from the input in a separate ASCII file (fortran unit 7). The (optional)
parameter ctrlfn denotes a file name (default is 'fort.7') to be used for
subsequent processing after the StoBe run.

During the StoBe run these control parameters are read in from the file
before each SCF iteration step (NOTE: lines 6, 7 are not yet included).
Editing the ASCII file allows changes of the control parameters while the
job is running. The ASCII file has the following structure

  Line 1  (A80)  RUNTIT
                 Title of the StoBe run, see <a href="#f.1)">f.1)</a>. Only the first line of the
                 title is saved.

  Line 2  (I5,2D20.10) NSCF,ECONV,DCONV

                 NSCF  = maximum number of SCF iterations, see <a href="#c.3)">c.3)</a>.

                 ECONV = energy convergence of the SCF procedure, see <a href="#c.4)">c.4)</a>.

                 DCONV = electron density convergence of the SCF procedure, see
                         <a href="#c.5)">c.5)</a>.

  Line 3  (I5,3D20.10) MAXG,GCONV,GSTEP,GSCALE

                 MAXG  = maximum number of geometry steps in a geometry
                         optimization procedure, see <a href="#d.3)">d.3)</a>. Note that in a
                         restart run this number includes previous geometry
                         steps.

                 GCONV = convergence threshold of gradients (in a.u.) in a
                         geometry optimization procedure, see <a href="#d.1)">d.1)</a>.

                 GSTEP = upper bound to the allowed average displacement (in
                         Bohr) of atoms between successive steps in a geometry
                         optimization , see <a href="#d.2)">d.2)</a>.

                GSCALE = scaling factor for atom displacements between
                         successive steps in a geometry optimization , see <a href="#d.2)">d.2)</a>.

  Line 4  (6I5) KPRORB,KPRDQP,KPRPCH,KPRHES,KPRSOR,KPRTIM

                 KPRORB = 1  prints all orbitals at the end of a StoBe run,
                             see <a href="#f.2)">f.2)</a>.
                        = 0  does not print orbitals.

                 KPRDQP = 1  prints all dipole and quadrupole moments
                             (cartesian components) at the end of a StoBe run,
                             see <a href="#f.2)">f.2)</a>.
                        = 0  does not print moments.

                 KPRPCH = 1  prints all external point charges in the input of
                             a StoBe run, see <a href="#f.2)">f.2)</a>.
                        = 0  does not print point charges.

                 KPRHES = 1  prints eigenvectors of the Hessian matrix at each
                             iteration step of a geometry optimization, see
                             <a href="#f.2)">f.2)</a>.
                        = 0  does not print eigenvectors of the Hessian matrix.

                 KPRSOR = 1  prints all orbitals at each iteration step of a
                             StoBe run, see <a href="#f.2)">f.2)</a>.
                        = 0  does not print orbitals at each step.

                 KPRTIM = 1  prints additional timing information, see <a href="#f.2)">f.2)</a>.
                        = 0  does not print timing.

  Line 5  (4I5) NMULL,NLOEW,IVIRT,NCYCLE

                 NMULL  =  0  prints neither Mulliken populations nor bond
                              orders.
                        = -1  prints total Mulliken populations and total Mayer
                              bond orders at the end of a StoBe run, see <a href="#e.1)">e.1)</a>.
                        =  1  prints total and orbital resolved Mulliken
                              populations as well as total Mayer bond orders at
                              the end of a StoBe run.
                        =  2  prints total and orbital resolved Mulliken
                              populations as well as total and orbital resolved
                              Mayer bond orders at the end of a StoBe run.

                 NLOEW  = -1, 0, 1, 2  Loewdin population analysis and
                              Mayer bond orders with parameter values analogous
                              to NMULL, see <a href="#e.2)">e.2)</a>.

                 IVIRT  =     number of virtual orbitals to be printed in the
                              final output, see <a href="#e.1)">e.1)</a>. A value IVIRT = -1
                              includes all computed virtuals, see <a href="#f.9)">f.9)</a>.

                 NCYCLE =     frequence of periodic updates of the restart
                              file (unit 2), see <a href="#f.3)">f.3)</a>.

  Line 6  (3I5,2F10.5) MAXPATH,NEBOPT,NEBPRT,CVGNEB,CVGNEBCI      (see <a href="#e.12)">e.12)</a>)

                 MAXPATH  =   maximum number of path iterations of a NEB
                              optimization.

                 NEBOPT   =   type of NEB path extrapolation method where
                          = 0   Steepest descent (extrap. mixing alpha= 1.0),
                          = 1   Steepest descent (extrap. mixing alpha= 0.5),
                          = 2   Conjugate gradient (extrap. mixing alpha= 1.0),
                          = 3   Conjugate gradient (extrap. mixing alpha= 0.5),
                          = 4   Conjugate gradient, Polak-Ribiere variant,
                          = 5   Quasi-Newton, Davidson-Fletcher-Powell variant,
                          = 6   Quasi-Newton, Murtaugh - Sargent variant,
                          = 7   Quasi-Newton, Broyden-Fletcher-Goldfarb-Shanno.

                 NEBPRT   =   printing during the NEB path calculation where
                          = 0   Neither atom coordinates nor forces printed,
                          = 1   Atom coordinates printed,
                          = 2   Atom forces (Pulay,NEB) printed,
                          = 3   Atom coordinates and atom forces printed.

                 CVGNEB   =   convergence threshold comparing subsequent NEB
                              path iterations.

                 CVGNEBCI =   convergence threshold comparing maximum images
                              of subsequent NEB paths in a climing image NEB
                              calculation.

  Line 7  (4F10.5) STPNEB,SCALNEB,SPRING,SPRINGV      (see <a href="#e.12)">e.12)</a>)

                 STPNEB   =   largest allowed displacement of atoms between
                              successive NEB steps (parameter stepmax in NEB
                              input, see <a href="#e.12)">e.12)</a>.

                 SCALNEB  =   additiponal scaling factor applied to all atom
                              displacements according to forces (parameter
                              fscale in NEB input, see <a href="#e.12)">e.12)</a>.

                 SPRING   =   spring constant used in the elastic coupling
                              between adjacent NEB images.

                 SPRINGV  =   variation of the spring constant for the lowest
                              images.

  Line 8  (4F10.5) DMIX,DMIXC,ESHIFT,EFRAC     (not yet implemented!)

                 DMIX   = density mixing factor (nd, keyword NORMAL) or
                          density matrix mixing factor (nd, keyword MDEN), see
                          <a href="#c.6)">c.6)</a>.

                 DMIXC  = exchange/correlation potential mixing factor
                          (nx, keyword NORMAL), see <a href="#c.6)">c.6)</a>.

                 ESHIFT = level shift value (esh in Hartree) separating
                          occupied and empty orbitals, see <a href="#c.8)">c.8)</a>.

                 EFRAC  = smear value (efrac in Hartree) determining energy
                          region of fractional orbital occupation numbers, see
                          <a href="#b.6)">b.6)</a>.

  Line 9  (2I5,F10.5) IDIIS,NISTEP,ESHIFD     (not yet implemented!)

                 IDIIS  = 0  DIIS scheme turned off
                        = 1  DIIS scheme turned on,  see <a href="#c.7)">c.7)</a>.

                 NISTEP = number of previous iteration steps used for the DIIS
                          scheme,  see <a href="#c.7)">c.7)</a>.

                 ESHIFD = level shift value (eshd in Hartree) separating
                          occupied and empty orbitals while the DIIS scheme is
                          applied, see <a href="#c.7)">c.7)</a>.

Example:

     &gt;CTRL                      (control file on unit 7)
     &gt;CTRL  Control.txt         (control file on unit 7 named 'Control.txt')


-----------------------------------------------------------------------------
                                                      <a name="f.11)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.11)  DOSOutput  [MULLiken, LOEWdin]</b>
-----------------------------------------------------------------------------

With this keyword, StoBe saves Kohn-Sham levels and Mulliken/Loewdin
populations on external files (unit 96 for Mulliken populations, keyword
MULLiken; unit 97 for Loewdin populations, keyword LOEWdin) to be used for
subsequent densities-of-states calculations with utility doscalc, see Sec.
2.7.5.

Example:

     &gt;DOSOUTPUT  MULLIKEN                    (stores Mulliken data on unit 96)
     &gt;DOSOUTPUT  LOEWDIN  MULLIKEN           (stores Mulliken data on unit 96
                                              and Loewdin data on unit 97)


-----------------------------------------------------------------------------
                                                      <a name="f.12)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.12)  SHoRTrestartfile</b>
-----------------------------------------------------------------------------

With this keyword (spelled as 'SHRT'), StoBe saves restart data on unit 2 in a
shortened format (short StoBe file format) where records 8, 9, 19 are replaced
by one-value dummies. This can reduce the restart file size considerably.
However, using restart files with short file format for input will recalculate
the missing data at startup which takes (little) more time compared to using
the full StoBe format.

Example:

     &gt;SHRT                    (uses short StoBe format for restart file output,
                               unit 2)


-----------------------------------------------------------------------------
                                                      <a name="f.13)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.13)  FORCes</b>
-----------------------------------------------------------------------------

With this keyword, StoBe evaluates forces on all atom centers after a single
point SCF run. The forces are listed in the output file. This is useful to
check whether an SCF run refers to an equilibrium geometry of the
cluster/molecule. In geometry optimizations or property runs this keyword is
ignored, see <a href="#c.1)">c.1)</a>.

Example:

     &gt;FORCES            (evaluates atom forces after a single point SCF run)


-----------------------------------------------------------------------------
                                                      <a name="f.14)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.14)  DYNAmics</b>
-----------------------------------------------------------------------------

Short-time dynamics simulation. This is NOT a full molecular dynamics (MD)
procedure, i.e. there is no equilibration or thermalization. The procedure
only computes forces on the atoms (as in ab initio MD) and then integrate
forward in time (as in MD). Initial velocities can be given, typically as a
sampling of the zero-point distribution. Applications have so far been to XES
on hydrogen-bonded systems. See, e.g., M.P. Ljungberg, A. Nilsson, and L.G.M.
Pettersson, Phys. Rev. B 82, 245115 (2010); M.P. Ljungberg, L.G.M. Pettersson,
and A. Nilsson, J. Chem. Phys. 134, 044513 (2011)].

Additional keyword lines are

        STEP  deltat
             defining the time between successive steps of the simulation in
             femtoseconds.

        TEND  tstop
             defining the end time after which the simulation is finshied in
             femtoseconds.

        VELO  ncent
             defining the number icent of centers of the cluster which are
             allowed to move during the simulation. This is followed by ncent
             lines

                 (I,3F)  (i, vx,vy,vz), i=1,ncent

             defining the starting velocities of the selected centers of the
             where i denotes the center index and (vx,vy,vz) is the velocity
             vectorcluster  in atomic units (a.u.).

        END
             terminates the simulation input. This line must always be present
             in the input.


-----------------------------------------------------------------------------
                                                      <a name="f.15)">(Goto</a> <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)
<b> f.15)  GEOFormat  [BALsac, XYZ, PDB, ALL]</b>
-----------------------------------------------------------------------------

Atom coordinates of molecules/clusters evaluated in StoBe runs can be saved in
geometry output files where different formats are available and are defined by
the parameters of the present option. Parameter

   BALsac    refers to the Balsac/Plot3D [H00] file format to be used for
             output of the cluster/molecule geometry. Corresponding files will
             contain the postfix ".plt", e.g. "strucfin.plt". This is the
             default setting if the option is not included in the input.

   XYZ       refers to the XYZ file format to be used for output of the
             cluster/molecule geometry. Corresponding files will contain the
             postfix ".xyz", e.g. "strucfin.xyz".

   PDB       refers to the Protein Data Bank format to be used for output of
             the cluster/molecule geometry. Corresponding files will contain
             the postfix ".pdb", e.g. "strucfin.pdb".

   ALL       combines output of with all three formats, i.e. each
             structure output creates three files, fname.plt, fname.xyz, and
             fname.pdb, to be used for postprocessing.

   NONE      ignores all geometry file output.

The different formats can be used simultaneously to create files of the same
structure. Option 'NONE' ignores all output irrespective of other choices in
the keyword line. Option 'ALL' (and no 'NONE') saves with all output formats
irrespective of other choices in the keyword line.

Examples:

     &gt;GEOFORMAT XYZ             only xyz format geometry file output
     &gt;GEOFORMAT BALSAC PDB      both Balsac/Plot3D and pdb format geometry
                                file output
     &gt;GEOFORMAT ALL             Balsac/Plot3D, xyz, and pdb format geometry
                                file output



<a name="2.2.7."><b>2.2.7.</a>  UNTESTED / OBSOLETE KEYWORDS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The following keywords have not been carefully tested or not yet implemented
in StoBe :

 INTEgration - method for angular grid integration
 LENNard - include Lennard-Jones potentials with external point charges
 MEPFit - calculate eff. atomic charges from MEPS fitting (not implemented)
 PNTGenerator - choice of gridpoint generator for angular integration
 WEDGe - restrict angular grid of Gauss-Legendre integration



<a name="2.3."><b>2.3.</a>  BASIS SET INPUT</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The list of all StoBe keywords and corresponding numerical parameters
(explained in Sec. 2.2.) is terminated by the END line. The remaining part of
the input file defines the basis sets (orbital bases, auxiliary bases, model
core potential (MCP or ECP) definitions, and augmentation bases for core
electron spectroscopy, NEXAFS, if applicable) to be used in the calculations.
The general sequence of basis sets is

  - auxiliary basis sets (A-...) for all (symmetry non-equivalent) atom centers
    using the order defined by the coordinate list, see <a href="#a.1)">a.1)</a> and including all
    dummy atoms, see <a href="#a.1)">a.1)</a>, or using a global definition, see below.

  - orbital basis sets (O-...) for all (symmetry non-equivalent real and dummy)
    atom centers using the same order as for auxiliary basis sets, or using a
    global definition, see below.

  - orbital basis sets combined with (parametrized) Dolg effective core
    potentials (D-...) for all (symmetry non-equivalent real and dummy) atom
    centers using the same order as for auxiliary basis sets. No global
    definition available do far.

  - (optional) model core potential definitions (P-...) for selected atom
    centers using the same order as for auxiliary basis sets (omitting centers
    without model core potentials), see below. A model core potential is
    assumed for an atom center whose effective nuclear charge ZZ defined in the
    coordinate list, see <a href="#a.1)">a.1)</a>, is different from its atomic number and is
    non-zero.

  - (required for XAS) augmentation basis sets including all (symmetry
    non-equivalent) atom centers using the order defined by the coordinate
    list, see below and keyword XRAY, <a href="#e.7)">e.7)</a>.

The basis set input allows different formats depending on the basis set type as
described in the following.

  (A)  Orbital basis sets

  (A.1) Explicit definition
        Here the basis set of each atom center is defined by a one-line title
        which refers to an entry in the basis set file provided with the input
        (fort.3). Possible titles are of the form [A92,GSA92]

           &gt;O-ELEMENT (n1s,n2s,...,nKs/n1p,n2p,...,nLp/n1d,n2d,...,nMd)

        where ELEMENT is a name which helps the user to identify the basis
        (typically the element name). Further, K denotes the number of s-type
        Gaussians with n1s,n2s,...,nKs primitives respectively, L contractions
        of p-type Gaussians with n1p, n2p,...,nLp primitives, and M
        contractions of d-type Gaussians with n1d,n2d,...nMd primitives
        respectively. Examples of orbital basis sets (the star at the end
        denotes that a diffuse function is added) are

           &gt;O-OXYGEN (621/41/1)
           &gt;O-HYDROGEN (41/1*)
           &gt;O-NITROGEN (7111/411/1)

  (A.2) Global definition
        Here basis set definitions are given by global keywords which apply to
        all atom centers and refer to a general basis set quality (exceptions
        for selected centers can be defined, see below). The definition
        consists of one keyword line

           &gt;GLOBal  [orbbasglobal auxbasglobal]

        where orbbasglobal and auxbasglobal define the quality of orbital and
        auxiliary basis sets with valid names (for corresponding explicit
        definitions see 2.3.1.)

              ----------------------------------------------------------------
               orbbasglobal      quality
              ----------------------------------------------------------------
                  DZVP           double zeta + valence polarization (default)
                  DEF            same as DZVP
                  TZVP           triple zeta + valence polarization
              ----------------------------------------------------------------
        and
              ----------------------------------------------------------------
                auxbasglobal      quality
              ----------------------------------------------------------------
                  A1             A1 type (default)
                  A5             A5 type
                  DEF            same as A1
                  GENAx          Ax type, x=2, 3, 4, computed from the
                                 corresponding orbital basis set
                  GENAx+         Ax+ type, x=2, 3, 4, computed from the
                                 corresponding orbital basis set
              ----------------------------------------------------------------

        NOTE that keywords orbbasglobal and auxbasglobal can only appear as
        pairs or have to be left out both. These keywords have to be given with
        upper case characters only. Examples of global definitions are

           &gt;GLOBAL  TZVP  A5
           &gt;GLOBAL  DZVP  GENA4
           &gt;GLOBAL  DZVP  GENA2+
           &gt;GLOBAL                   (equivalent with GLOBAL  DZVP  A1)

        Selected atom centers (defined by their atom labels) can be exempt from
        the global basis set definition. Their orbital and auxiliary basis sets
        have to be defined separately. This requires a keyword line

           &gt;SUBStitute  atomlabel

        where atomlabel defines the label of the corresponding atom which must
        appear (with the same notation) in the previous list of coordinates,
        see keyword <a href="#a.1)">a.1)</a> of 2.2.1. This has to be followed by two lines giving
        the explicit titles of auxiliary and orbital basis sets (the former may
        also be a computed auxiliary basis set, see B.3). An example is

           &gt;GLOBAL DZVP A1
           &gt;SUBSTITUTE O
           &gt;A-OXYGEN (4,4;4,4)
           &gt;O-OXYGEN (721/51/1*)

        The global basis set input has to be finished by an END line. After
        this all basis set input of model core potentials and augmentation
        bases follows, using the explicit basis set definitions, see C, D
        below.

  (A.3) Explicit definition of valence basis with Dolg effective core potential
        There is a full collection of valence basis sets together with
        (parametrized) relativistic effective core potentials according to Dolg
        et al. [DD82-95] for all elements from Li (Z = 3) to Fermium (Z = 100)
        following the parametrization/representation of the Toulouse group
        (J.-L. Heully [?]). The basis set of each atom center is defined by a
        one-line title which refers to an entry in the basis set file provided
        with the input (fort.3). Possible titles are of the form

           &gt;D-TITLE

        where TITLE is a name which helps the user to identify the basis.
        Examples of orbital basis sets are

           &gt;D-B.ECP.Dolg.4s4p.2s2p.3e-MWB.
           &gt;D-Fe.ECP.Dolg.8s7p6d1f.6s5p3d1f.16-MDF.
           &gt;D-Pu.ECP.Dolg.12s11p10d8f.8s7p6d4f.34e-MWB.

        Note that combined Dolg basis sets and effective core potentials do not
        require additional definitions of effective core parameters as opposed
        to valence basis sets combined with model core potential, see (C.1)
        below. Further, Dolg orbital basis sets do not come with explicit
        auxiliary basis sets which have to be generated, see (B.3) below.


  (B)  Auxiliary basis sets

  (B.1) Explicit definition
        Here the basis set of each (non-equivalent) atom center is defined by a
        one-line title which refers to an entry in the basis set file provided
        with the input. Possible titles are of the form [A92,GSA92]

           &gt;A-ELEMENT (ns(CD),nspd(CD); ns(XC),nspd(XC))

        where ELEMENT is a name which helps the user to identify the basis
        (typically the element's name), ns(CD) is the number of s-type
        Gaussians used to fit the charge density (CD), nspd(CD) is the number
        of s-, p- and d- type Gaussians (sharing the same exponent) used to fit
        the valence charge density; ns(XC) and nspd(XC) have definitions
        similar to ns(CD) and nspd(CD), while referring to the Gaussians used
        to fit the exchange and correlation potentials. Examples of auxiliary
        basis sets are

           &gt;A-NITROGEN (4,4;4,4)
           &gt;A-OXYGEN (5,2;5,2)
           &gt;A-HYDROGEN (5,1;5,1)

  (B.2) Global definition
        Here basis set definitions are given by global keywords which apply to
        all atom centers and refer to a general basis set quality (exceptions
        for selected centers can be defined, see below). The definition
        consists of one keyword line

           &gt;GLOBal  [orbbasglobal] [auxbasglobal]

        at the beginning of the basis set section as described in A.2 above.

  (B.3) Internal construction from orbital basis sets
        Auxiliary basis sets can be generated from corresponding orbital basis
        sets following procedures described in [KH01] and below. The input
        line for a computed auxiliary basis set reads

           &gt;GENAxy orbitalbasistitle

        where orbitalbasistitle is the title of an orbital basis set which
        refers to an entry in the basis set input file and xy = 2, 3, 4 or 2+,
        3+, 4+ denotes the quality of the auxiliary basis set. NOTE that
        keyword GENAx and the orbital basis title must be separated by at least
        one blank character. Examples of computed auxiliary basis sets are

           &gt;GENA2 O-OXYGEN (621/41/1)
           &gt;GENA4+ O-OXYGEN (721/51/1*)

        The internal generator of auxiliary basis sets from orbital basis
        produces even tempered basis sets (linear progression) according to
        empirical recipes

          (a) GENAx, x = 2,3,4
              This procedure determines the range of all exponents [zmin, zmax]
              of the orbital basis set irrespective of quantum number. Then the
              range [2*zmin, 2*zmax] is spanned by an even tempered sequence of
              N exponents from the top. Then the first N/2 exponents are
              assigned to an s basis set and the second to a mixed s, p, d
              basis set describing the density basis. The corresponding
              exchange/correlation basis is determinated from the density basis
              by dividing all exponents by 3. Number x  = 2,3,4 determines the
              progression factor in the exponent sequence (alp(i)= alp(i-1)/R,
              R = 6 - x).

          (b) GENAx+, x = 2,3,4
              This procedure according to [H03] determines in addition to
              [zmin, zmax], see (a), also the range of all p, d exponents
              [zmin', zmax'] of the orbital basis set. Then the range
              [2*zmin', 2*zmax'] is spanned by an even tempered sequence of N
              exponents from the top. These exponents are assigned to a mixed
              s, p, d basis set describing the density basis. The sequence is
              continued at the top and bottom to cover the full range
              [2*zmin, 2*zmax] where additional exponents, not included in the
              spd basis are assigned to a separate s basis. The corresponding
              exchange/correlation basis is determinated as in (a).
              Number x  = 2,3,4 determines the progression factor in the
              exponent sequence (alp(i)= alp(i-1)/R, R = 6 - x).

        A line

           &gt;GENAxy ALL

        at the beginning of the basis set input section (with explicit orbital,
        MCP, and/or augmentation basis set definitions following) computes, for
        all atoms, auxiliary basis sets of Ax or Ax+ quality, x=2,3,4, from
        corresponding orbital bases. NOTE that this definition does not allow
        further explicit auxiliary basis set definitions.


  (C)  Model core potential definitions

  (C.1) Explicit definition
        The model core potential (MCP) of each (non-equivalent) atom center is
        defined by a one-line title which refers to an entry in the basis set
        file provided with the input. The definition of the MCPs follows
        Huzinaga's procedure as described e. g. in [PWG87]. At present, this is
        the only way to define MCP's. Possible MCP titles are of the form

           &gt;P-LABEL(Zeff) (nv(mcp): ns(mcp),np(mcp),nd(mcp))

        where nv(mcp) is the number of s-type Gaussians used to fit the
        potential seen by the valence electrons, ns(mcp),np(mcp) and nd(mcp)
        are respectively the number of s-, p-, and d-type Gaussians used to
        describe the s,p and d core orbitals and Zeff is the effective nuclear
        charge after removal of the core electrons. Examples of MCP basis sets
        are

           &gt;P-PALLADIUM(+16) (6:9,6,4)        &gt;P-ALUMINUM(+3) (4:6,4)
           &gt;P-PHOSPHORUS(+5) (4:6,4)          &gt;P-GERMANIUM(+14) (3:7,5)
           &gt;P-SULFUR(+6) (4:6,4)              &gt;P-CHLORINE(+7) (4:6,4)
           &gt;P-NICKEL(+16) (5:7,4)             &gt;P-SILICON(+4) (4:6,4)
           &gt;P-RHODIUM(+15) (6:9,6,4)          &gt;P-NIOBIUM(+11) (5:8,6,4)
           &gt;P-PLATINUM(+16) (7:12,9,7,5)      &gt;P-MOLYBDENUM(+14) (5:8,6,4)


  (D)  Augmentation basis sets

  (D.1) Explicit definition
        The model augmentation basis set of each (non-equivalent) atom center
        is defined by a one-line title which refers to an entry in the basis
        set file provided with the input. At present, this is the only way to
        define augmentation basis sets. Possible titles are

           &gt;X-FIRST   or   &gt;X-SECOND   or   &gt;X-DUMMY

        where X-FIRST is sufficient for first-row systems and X-SECOND is
        somewhat more extended. X-DUMMY is used for all atom centers except
        those where the core excitation originates from.

        NOTE: The order of the augmentation basis input must follow that of the
        geometry input, i.e. as for the auxiliary and orbital bases. After the
        basis set for the core-excited center has been specified (i.e. X-FIRST
        or X-SECOND) additional "trailing" X-DUMMY need not be given.



<a name="2.3.1."><b>2.3.1.</a>  GLOBAL BASIS SET DEFINITIONS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The following tables list explicit basis set titles for each element (if
available) which are used in the global definitions.

(a) Orbital basis sets (DZVP, TZVP)

 ------------------------------------------------------------------------------
   element    DZVP                                 TZVP
 ------------------------------------------------------------------------------
      1 H     O-HYDROGEN (41/1*)                   ---
      2 He    O-HELIUM (51)                        ---
      3 Li    O-LITHIUM (621/1/1)                  ---
      4 Be    O-BERYLLIUM (621/1/1)                ---
      5 B     O-BORON (621/41/1)                   ---
      6 C     O-CARBON (621/41/1)                  O-CARBON (7111/411/1)
      7 N     O-NITROGEN (621/41/1)                O-NITROGEN (7111/411/1)
      8 O     O-OXYGEN (621/41/1)                  O-OXYGEN (7111/411/1)
      9 F     O-FLUORINE (621/41/1                 O-FLUORINE (7111|1+/411/1*|1+) (TZVP-FIP1)
     10 Ne    O-NEON (621/41/1)                    ---
     11 Na    O-SODIUM (6321/411/1)                O-SODIUM (6321/411/1)
     12 Mg    O-MAGNESIUM (6321/411/1)             O-MAGNESIUM (6321/411/1)
     13 Al    O-ALUMINUM (6321/521/1)              O-ALUMINUM (73111/6111/1)
     14 Si    O-SILICON (6321/521/1)               O-SILICON (73111/6111/1)
     15 P     O-PHOSPHORUS (6321/521/1)            O-PHOSPHORUS (73111/6111/1)
     16 S     O-SULFUR (6321/521/1)                O-SULFUR (73111/6111/1)
     17 Cl    O-CHLORINE (6321/521/1)              O-CHLORINE (73111/6111/1)
     18 Ar    O-ARGON (6321/521/1)                 O-ARGON (73111/6111/1)
     19 K     O-POTASSIUM (63321/5211/1)           O-POTASSIUM (63321/5211/1)
     20 Ca    O-CALCIUM (63321/5211/41)            O-CALCIUM (63321/5211/41)
     21 Sc    O-SCANDIUM (63321/531/311)           O-SCANDIUM (63321/531/311)
     22 Ti    O-TITANIUM (63321/531/311)           O-TITANIUM (63321/531/311)
     23 V     O-VANADIUM (63321/531/311)           O-VANADIUM (63321/531/311)
     24 Cr    O-CHROMIUM (63321/531/311)           O-CHROMIUM (63321/531/311)
     25 Mn    O-MANGANESE (63321/531/311)          O-MANGANESE (63321/531/311)
     26 Fe    O-IRON (63321/531/311)               O-IRON (63321/531/311)
     27 Co    O-COBALT (63321/531/311)             O-COBALT (63321/531/311)
     28 Ni    O-NICKEL (63321/531/311)             O-NICKEL (63321/531/311)
     29 Cu    O-COPPER (63321/531/311)             O-COPPER (63321/531/311)
     30 Zn    O-ZINC (63321/531/311)               O-ZINC (63321/531/311)
     31 Ga    O-GALLIUM (63321/5321/41)            ---
     32 Ge    O-GERMANIUM (63321/5321/41)          ---
     33 As    O-ARSENIC (63321/5321/41)            ---
     34 Se    O-SELENIUM (63321/5321/41)           ---
     35 Br    O-BROMINE (63321/5321/41)            ---
     36 Kr    O-KRYPTON (63321/5321/41)            ---
     37 Rb    O-RUBIDIUM (633321/53211/51)         ---
     38 Sr    O-STRONTIUM (633321/53211/531)       ---
     39 Y     O-YTTRIUM (633321/53211/531)         ---
     40 Zr    O-ZIRCONIUM (633321/53211/531)       ---
     41 Nb    O-NIOBIUM (633321/53211/531)         ---
     42 Mo    O-MOLYBDENUM (633321/53211/531)      ---
     43 Tc    O-TECHNETIUM (633321/53211/531)      ---
     44 Ru    O-RUTHENIUM (633321/53211/531)       ---
     45 Rh    O-RHODIUM (633321/53211/531)         ---
     46 Pd    O-PALLADIUM (633321/53211/531)       ---
     47 Ag    O-SILVER (633321/53211/531)          ---
     48 Cd    O-CADMIUM (633321/53211/531)         ---
     49 In    O-INDIUM (633321/53321/531)          ---
     50 Sn    O-TIN (633321/53321/531)             ---
     51 Sb    O-ANTIMONY (633321/53321/531)        ---
     52 Te    O-TELLURIUM (633321/53321/531)       ---
     53 I     O-IODINE (633321/53321/531)          ---
     54 Xe    O-XENON (633321/53321/531)           ---
 ------------------------------------------------------------------------------


(b) Auxiliary basis sets (A1, A5)

 ------------------------------------------------------------------------------
   element    A1                                   A5
 ------------------------------------------------------------------------------
      1 H     A-HYDROGEN (4,2;4,2)                 A-HYDROGEN (5,1;5,1)
      2 He    A-HELIUM (3,1;3,1)                   A-HELIUM (3,1;3,1)
      3 Li    A-LITHIUM (4,3;4,3)                  A-LITHIUM (4,3;4,3)
      4 Be    A-BERYLLIUM (4,3;4,3)                A-BERYLLIUM (4,3;4,3)
      5 B     A-BORON (4,3;4,3)                    A-BORON (5,5;5,5)
      6 C     A-CARBON (4,3;4,3)                   A-CARBON (5,2;5,2)
      7 N     A-NITROGEN (4,3;4,3)                 A-NITROGEN (5,2;5,2)
      8 O     A-OXYGEN (4,3;4,3)                   A-OXYGEN (5,2;5,2)
      9 F     A-FLUORINE (4,3;4,3)                 A-FLUORINE (5,2;5,2)
     10 Ne    A-NEON (4,3;4,3)                     A-NEON (4,4;4,4)
     11 Na    A-SODIUM (5,4;5,4)                   A-SODIUM (5,4;5,4)
     12 Mg    A-MAGNESIUM (5,4;5,4)                A-MAGNESIUM (5,4;5,4)
     13 Al    A-ALUMINUM (5,4;5,4)                 A-ALUMINUM (5,4;5,4)
     14 Si    A-SILICON (5,4;5,4)                  A-SILICON (5,4;5,4)
     15 P     A-PHOSPHOROUS (5,4;5,4)              A-PHOSPHOROUS (5,4;5,4)
     16 S     A-SULFUR (5,4;5,4)                   A-SULFUR (5,4;5,4)
     17 Cl    A-CHLORINE (5,4;5,4)                 A-CHLORINE (5,4;5,4)
     18 Ar    A-ARGON (5,4;5,4)                    A-ARGON (5,4;5,4)
     19 K     A-POTASSIUM (5,5;5,5)                A-POTASSIUM (5,5;5,5)
     20 Ca    A-CALCIUM (5,5;5,5)                  A-CALCIUM (5,5;5,5)
     21 Sc    A-SCANDIUM (5,5;5,5)                 A-SCANDIUM (5,5;5,5)
     22 Ti    A-TITANIUM (5,5;5,5)                 A-TITANIUM (5,5;5,5)
     23 V     A-VANADIUM (5,5;5,5)                 A-VANADIUM (5,5;5,5)
     24 Cr    A-CHROMIUM (5,5;5,5)                 A-CHROMIUM (5,5;5,5)
     25 Mn    A-MANGANESE (5,5;5,5)                A-MANGANESE (5,5;5,5)
     26 Fe    A-IRON (5,5;5,5)                     A-IRON (5,5;5,5)
     27 Co    A-COBALT (5,5;5,5)                   A-COBALT (5,5;5,5)
     28 Ni    A-NICKEL (5,5;5,5)                   A-NICKEL (5,5;5,5)
     29 Cu    A-COPPER (5,5;5,5)                   A-COPPER (5,5;5,5)
     30 Zn    A-ZINC (5,5;5,5)                     A-ZINC (5,5;5,5)
     31 Ga    A-GALLIUM (5,5;5,5)                  A-GALLIUM (5,5;5,5)
     32 Ge    A-GERMANIUM (5,5;5,5)                A-GERMANIUM (5,5;5,5)
     33 As    A-ARSENIC (5,5;5,5)                  A-ARSENIC (5,5;5,5)
     34 Se    A-SELENIUM (5,5;5,5)                 A-SELENIUM (5,5;5,5)
     35 Br    A-BROMIUM (5,5;5,5)                  A-BROMIUM (5,5;5,5)
     36 Kr    A-KRYPTON (5,5;5,5)                  A-KRYPTON (5,5;5,5)
     37 Rb    A-RUBIDIUM (5,5;5,5)                 A-RUBIDIUM (5,5;5,5)
     38 Sr    A-STRONTIUM (5,5;5,5)                A-STRONTIUM (5,5;5,5)
     39 Y     A-YTTRIUM (5,5;5,5)                  A-YTTRIUM (5,5;5,5)
     40 Zr    A-ZIRCONIUM (5,5;5,5)                A-ZIRCONIUM (5,5;5,5)
     41 Nb    A-NIOBIUM (5,5;5,5)                  A-NIOBIUM (5,5;5,5)
     42 Mo    A-MOLYBDENUM (5,5;5,5)               A-MOLYBDENUM (5,5;5,5)
     43 Tc    A-TECHNETIUM (5,5;5,5)               A-TECHNETIUM (5,5;5,5)
     44 Ru    A-RUTHENIUM (5,5;5,5)                A-RUTHENIUM (5,5;5,5)
     45 Rh    A-RHODIUM (5,5;5,5)                  A-RHODIUM (5,5;5,5)
     46 Pd    A-PALLADIUM (5,5;5,5)                A-PALLADIUM (5,5;5,5)
     47 Ag    A-SILVER (5,5;5,5)                   A-SILVER (5,5;5,5)
     48 Cd    A-CADMIUM (5,5;5,5)                  A-CADMIUM (5,5;5,5)
     49 In    A-INDIUM (5,5;5,5)                   A-INDIUM (5,5;5,5)
     50 Sn    A-TIN (5,5;5,5)                      A-TIN (5,5;5,5)
     51 Sb    A-ANTIMONY (5,5;5,5)                 A-ANTIMONY (5,5;5,5)
     52 Te    A-TELLURIUM (5,5;5,5)                A-TELLURIUM (5,5;5,5)
     53 I     A-IODINE (5,5;5,5)                   A-IODINE (5,5;5,5)
     54 Xe    A-XENON (5,5;5,5)                    A-XENON (5,5;5,5)
 ------------------------------------------------------------------------------



<a name="2.4."><b>2.4.</a>  SYMMETRY BASIS SET INPUT</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

Symmetry group file 'symbasis' (associated with fort.4 in the program) contains
symmetry transformations and irreducible representation tables of a large number
of point symmetry groups. At present, the following 48 point groups are included

     1. C1           2. Ci           3. Cs           4. Csxz
     5. Csy          6. Csyz         7. Csx          8. Csxy
     9. Csz         10. C2          11. C3   (!)    12. C4   (!)
    13. C5   (!)    14. C6   (!)    15. S4   (!)    16. S6   (!)
    17. D2          18. D3          19. D4          20. D5
    21. D6          22. C2v         23. C2vb        24. C3v
    25. C4v         26. C5v         27. C6v         28. C2h
    29. C3h  (!)    30. C4h  (!)    31. C5h  (!)    32. C6h  (!)
    33. D2h         34. D3h         35. D4h         36. D5h
    37. D6h         38. D2d         39. D3d         40. D4d
    41. D5d         42. D6d         43. T    (!)    44. Th   (!)
    45. Td          46. O           47. Oh          48. ATOM

Note that file symbasis uses symmetry labels in upper case notation (e.g. C4V)
only while in StoBe input these labels can be given by mixed case (e.g. C4v) or
only upper case characters (e.g. C4V).

Note further that

  - All point symmetry groups (except C1) refer to a symmetry origin at
    (0, 0, 0) in absolute cartesian coordinates.

  - Point groups with labels (!) are not fully reducible for real valued basis
    functions and are incompletely reduced.

  - Symmetry label ATOM which denotes the full rotational point group (up to d
    functions) is restricted to free atoms.

  - Symmetry label C2vb denotes the C2v symmetry group where the two mirror
    planes contain the z axis and the xy diagonal axes.

  - Groups with only mirror symmetry (Cs..) refer to mirror plane normals
      (0, 1, 0) for Cs, Csxz, Csy (corresponding to the xz plane),
      (1, 0, 0) for Csyz, Csx     (corresponding to the yz plane),
      (0, 0, 1) for Csxy, Csz     (corresponding to the xy plane),
    in absolute cartesian coordinates.

  - Groups with one rotational axis only (groups # 10-16, 22-32) assume that
    this axis points along (0, 0, 1), i. e. the z axis in absolute cartesian
    coordinates.

  - Groups with more than one rotational axis (i. e. groups # 17-21, 33-47)
    assume that (one of) the rotational axis (axes) of highest order points
    along (0, 0, 1), i. e. the z axis in absolute cartesian coordinates.

  - For groups with a rotational axis (of highest order, pointing along the
    z direction (0, 0, 1)) and with mirror planes only parallel or
    perpenducular to the rotational axis (groups # 22,24-42, for group # 23
    see exception above), one of the mirror planes containing the axis is
    assumed to form the xz plane, i. e. the mirror plane is spanned by unit
    vectors (1, 0, 0) and (0, 0, 1).

  - Tetrahedral groups (groups # 43-45) assume 2-fold rotation axes along the
    cartesian axes (1, 0, 0), (0, 1, 0), (1, 0, 0), and 3-fold rotation axes
    along diagonals (+/-1, +/-1, +/-1). Possible mirror plane normals point
    along (1, 0, 0), (0, 1, 0), (1, 0, 0).

  - Octahedral group # 46 (O) assumes 4-fold rotation axes along the cartesian
    axes (1, 0, 0), (0, 1, 0), (1, 0, 0), and 3-fold rotation axes along
    diagonals (+/-1, +/-1, +/-1).

  - Octahedral group # 47 (Oh) assumes 4-fold rotation axes along the cartesian
    axes (1, 0, 0), (0, 1, 0), (1, 0, 0), and 3-fold rotation axes along
    diagonals (+/-1, +/-1, +/-1). Mirror plane normals point along (1, 0, 0),
    (0, 1, 0), (1, 0, 0) and along +/-(1, 1, 0), +/-(1, 0, 1), +/-(0, 1, 1).

Format details of the ASCII type symmetry group file are discussed in Sec.
2.4.1.



<a name="2.4.1."><b>2.4.1.</a>  FORMAT OF SYMMETRY GROUP FILE</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The ASCII type symmetry group file 'symbasis', see previous Sec. 2.4., contains
symmetry transformations and irreducible representation tables of a large number
of point symmetry groups. The file format for a given symmetry group is as
follows (notation according to standard Fortran 77)

Line  1.     (A4)  SYMLAB

   SYMLAB   := label of the symmetry group in upper case characters or numbers.
               At present 48 different symmetry groups are included, see
               previous Sec. 2.4.


Line  2.     (2I5)  NSYM,INVER

   NSYM     := total number of symmetry operations.

   INVER    := number of symmetry operations which conserve the handedness
               of the Cartesian coordinate system (identity, proper rotations).
               The listing of all symmetry operations in the following line(s) 3
               is given in the sequence of INVER operations conserving
               handedness (identity, proper rotations), followed by (NSYM-INVER)
               operations changing handedness (improper rotations: inversion,
               mirroring).


NSYM lines 3 follow.

Line(s)  3.  (3F,A)  E1,E2,E3,SYMOP
                 Free Fortran input format with fractions allowed as 'K/L'
                 (K, L integer; example '4/3' = 1.333...).

   E1,E2,E3   := Euler rotation angles of each symmetry operation in multiples
                 of Pi. The three Euler angles A (alpha), B (beta), C (gamma)
                 are given as

                  A = E1 x Pi, B = E2 x Pi, C = E3 x Pi,  Pi = 3.1415926535898

                 Then the general (3x3) transformation matrix T of a symmetry
                 operation transforming Cartesian coordinates is defined by a
                 product of three rotation matrices and a prefactor q, i. e.
                 by

                          ( t11  t12  t13 )         ( cos A   -sin A   0 )
                    T  =  ( t21  t22  t23 )  =  q x ( sin A    cos A   0 ) x
                          ( t31  t32  t33 )         (   0        0     1 )

                          ( cos B    0    sin B )   ( cos C   -sin C   0 )
                       x  (   0      1     0    ) x ( sin C    cos C   0 )
                          (-sin B    0    cos B )   (   0        0     1 )

                 The prefactor q is set to q = 1 for proper rotations,
                 operations I = 1, INVER and to q = -1 for operations
                 I = INVER+1, NSYM (improper rotations: inversion, mirroring).

   SYMOP      := ASCII label of each symmetry operation. The identity is labeled
                 E, inversion is labeled I, rotation labels start with Cn (n
                 denoting the foldedness), mirror operations start with S.


Line  4.     (I5)  NREP

   NREP   :=   Number of irreducible representations of the symmetry group.


NREP lines 5 follow.

Line(s)  5.     (A4,I3) REPOP,IRPDIM

   REPOP    :=   ASCII label of irreducible representation.

   IRPDIM   :=   Dimension of irreducible representation.


NREP sequences of (IRPDIM x IRPDIM) lines 6 follow. Each sequence addresses one
representation, labeled REPOP, with NSYM representation matrices RMAT of
dimension (IRPDIM x IRPDIM). The format is

Line(s)  6.  (NSYM*A)   (((RMAT(I,J,ISY),ISY=1,NSYM), J=1,IRPDIM), I=1, IRPDIM)

   RMAT     := component (I,J) of representation matrix reflecting symmetry
               operation ISY. Components are given with only 7 digits in the
               symmetry group file but are corrected to yield machine accuracy
               (function FRATIO) to reflect the most accurate symmetry
               description. As examples, fractions, square roots, and some
               trigonometric function values (e.g. cos(72)) are corrected.


Line  7.  (A4)   'STOP'

   This finishes a symmetry group description in the symmetry group file


As an example the different lines of symmetry group C4v as given in the file are
shown with line comments to the right.

C4V                                                   line    1
    8    4                                            line    2
         0         0         0         E              8 lines 3
         0         0         1        C2Z                ...
         0         0      -1/2        C4Z-               ...
         0         0       1/2        C4Z+               ...
         0         1         0        SIGY               ...
         0         1         1        SIGX               ...
         0         1       1/2        SGDA               ...
         0         1      -1/2        SGDB               ...
    5                                                 line    4
A1    1                                               5 lines 5
A2    1                                                  ...
B1    1                                                  ...
B2    1                                                  ...
E     2                                                  ...
1   1    1    1    1    1    1    1                   line 6, 1-dim rep. 1: 1,1
1   1    1    1   -1   -1   -1   -1                   line 6, 1-dim rep. 2: 1,1
1   1   -1   -1    1    1   -1   -1                   line 6, 1-dim rep. 3: 1,1
1   1   -1   -1   -1   -1    1    1                   line 6, 1-dim rep. 4: 1,1
1  -1    0    0    1   -1    0    0                   line 6, 2-dim rep. 5: 1,1
0   0    1   -1    0    0   -1    1                   line 6, 2-dim rep. 5: 1,2
0   0   -1    1    0    0   -1    1                   line 6, 2-dim rep. 5: 2,1
1  -1    0    0   -1    1    0    0                   line 6, 2-dim rep. 5: 2,2
STOP



<a name="2.5."><b>2.5.</a>  FORMAT OF RESTART FILE</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

This section describes the format of restart files generated by StoBe runs and
saved on unit 2. Restart files can be used with input unit 1 to continue /
restart unfinished runs or to start new runs with different input parameters.
The basic format of a restart file is binary, see also utility transf
of Sec. 2.7.2, consisting of different records as follows
(parameter types are I4=INTEGER*4, R8=REAL*8, Cn=CHARACTER*n):

Record   1
   (I4)          MAXG         max. number of geometries (+)
   (C80)         RUNTIT       run title
   (R8)          ENERGY       total energy of present configuration

Record   2
   (R8)          CONSTD       measure of density convergence
   (I4)          NRESFM       restart file format
                                = 0 for old StoBe file format, see Sec. 2.5.1.
                                = 1 for new StoBe file format (default)
                                = 2 for new short StoBe file format (recs. 8,
                                    9, 19 replaced by dummy values, see <a href="#f.12)">f.12)</a>
   (I4)          NVBPOS       position index of the SCF to be continued in the
                              vibrational analysis (only for vibrational
                              analysis, NVBPOS-1 SCF runs are assumed to be
                              completed, see records 28)

   (I4)          NVBALL       total number of SCF runs needed for the
                              vibrational analysis to be continued in the
                              vibrational analysis (vibrational analysis
                              continued only)

Record   3
   (I4)          NLA          total number of occupied alpha orbitals,
                              for excited states this may include zero
                              occupation orbitals, see record 4.
   (I4)          NLB          total number of occupied beta  orbitals
                              for excited states this may include zero
                              occupation orbitals, see record 4.
   (I4)          NCNTRT       total number of basis contractions
   (I4)          NCENTR       total number of centers (including symmetry
                              equivalents)
   (I4)          NBCH         total number of aux. basis functions for charge
                              density fit
   (I4)          NBXC         total number of aux. basis functions for XC
                              potential fit
   (NCENTR*R8)   CHARGE       atom charges (valence charges if ECPs used)
   (NCENTR*C4)   LABCEN       atom labels (element names)
   (I4)          NBCHS        number of aux. basis functions (separate s
                              functions only) for charge density fit
   (I4)          NBXCS        number of aux. basis functions (separate s
                              functions only) for XC potential fit

Record   4
   (NCNTRT*R8)   DOCA         occupations of all alpha orbitals. The internal
                              order follows the scheme described for the MO
                              coefficients, see record 11.

Record   5
   (NCNTRT*R8)   ELGALP       Kohn-Sham energies of all alpha orbitals. The
                              internal order follows the scheme described for
                              the MO coefficients, see record 11.

Record   6
   (NCNTRT*R8)   DOCB         occupations of all beta orbitals. The internal
                              order follows the scheme described for the MO
                              coefficients, see record 12.

Record   7
   (NCNTRT*R8)   ELGBET       Kohn-Sham energies of all beta orbitals. The
                              internal order follows the scheme described for
                              the MO coefficients, see record 12.

Record   8
   (NT*R8)       AMAT         (extrapolated) density matrix of alpha orbitals
                              in triangular form, NT = NCNTRT*(NCNTRT+1)/2
                              This matrix is replaced by a dummy value (=0.D0)
                              for short StoBe file format, see <a href="#f.12)">f.12)</a>.

Record   9
   (NT*R8)       BMAT         (extrapolated) density matrix of beta orbitals
                              in triangular form, NT = NCNTRT*(NCNTRT+1)/2
                              This matrix is replaced by a dummy value (=0.D0)
                              for short StoBe file format, see <a href="#f.12)">f.12)</a>.

Record  10
   (3*NCENTR*R8) CENT         (x,y,z) of each center (including symmetry
                              equivalents), latest geometry step
   (NCENTR*R8)   AMASS        atom mass of each center (including symmetry
                              equivalents)

Records 11
   (NCNTRT*R8)   CALPHA(i,j)  coefficients of alpha orbitals, latest geometry
                              step, j=1,...NCNTRT. The orbitals appear in the
                              order
                                 NOCCA(1) occ. orbitals, symmetry 1
                                 NOCCA(2) occ. orbitals, symmetry 2
                                 ...
                                 NOCCA(NSYM) occ. orbitals,symmetry NSYM
                                 NBAS(1)-NOCCA(1) virt. orbitals, symmetry 1
                                 NBAS(2)-NOCCA(2) virt. orbitals, symmetry 2
                                 ...
                                 NBAS(NSYM)-NOCCA(NSYM) virt. orbitals,
                                                                  symmetry NSYM

                 NOTE that for excited states empty orbitals of a symmetry
                 representation below the representation HOMO are considered as
                 occupied orbitals. The application of supersymmetries (see
                 <a href="#c.16)">c.16)</a> does not affect the orbital order.

Records 12
   (NCNTRT*R8)   CBETA(i,j)   coefficients of beta orbitals, latest geometry
                              step, j=1,...NCNTRT.
                              The orbitals appear in the order

                                 NOCCB(1) occ. orbitals, symmetry 1
                                 NOCCB(2) occ. orbitals, symmetry 2
                                 ...
                                 NOCCB(NSYM) occ. orbitals,symmetry NSYM
                                 NBAS(1)-NOCCB(1) virt. orbitals, symmetry 1
                                 NBAS(2)-NOCCB(2) virt. orbitals, symmetry 2
                                 ...
                                 NBAS(NSYM)-NOCCB(NSYM) virt. orbitals,
                                                                  symmetry NSYM

                 NOTE that for excited states empty orbitals of a symmetry
                 representation below the representation HOMO are considered as
                 occupied orbitals. The application of supersymmetries (see
                 <a href="#c.16)">c.16)</a> does not affect the orbital order.

Record  13
   (NBCH*R8)     CDCOEF       coefficients of charge density fit, latest
                              geometry step

Record  14
   (NBXC*R8)     XCOEFA       coefficients of XC potential fit (spin alpha),
                              latest geometry step

Record  15
   (NBXC*R8)     XCOEFB       coefficients of XC potential fit (spin beta),
                              latest geometry step

Record  16
   (NBXC*R8)     XCOEFE       coefficients of XC energy fit,
                              latest geometry step

Record  17
   (I4)          NSYM         number of irreducible representations
   (24*I4)       NBAS         number of orbital components for each
                              representation
   (I4)          NTOT         total number of orbital components,
                              sum(NBAS) = NCNTRT - NDEL, where NDEL denotes
                              symmetry removals (e.g. x2+y2+z2)
   (24*I4)       NOCCA        number of occupied alpha orbitals for each
                              representation (for excited states
                              empty orbitals of a symmetry representation
                              below the representation HOMO are considered as
                              occupied, see records 11)
   (24*I4)       NOCCB        number of occupied beta orbitals for each
                              representation (for excited states
                              empty orbitals of a symmetry representation
                              below the representation HOMO are considered as
                              occupied, see records 12)

Record  18
   (C4)          SYMLAB       point group symmetry label
   (NSYM*C4)     IRRSYM       label of each irreducible representation

Record  19
   (NT*R8)       SXC          charge fitting matrix, triangular matrix
                              &lt;&lt;gi(r) gj(r') /|r-r'| &gt;&gt;,  NT = NBCH*(NBCH+1)/2
                              This matrix is replaced by a dummy value (=0.D0)
                              for short StoBe file format, see <a href="#f.12)">f.12)</a>.

Record  20
   (3*NCENTR*R8) CENT0        (x,y,z) of each center (including symmetry
                              equivalents), 2nd latest geometry step in
                              optmization or initial equilibrium geometry in
                              vibrational analysis

Record  21
   (3*NCENTR*R8) HF           forces (fx,fy,fz) on each center (including
                              symmetry equivalents), latest geometry step

Record  22
   (3*NCENTR*R8) HF0          forces (fx,fy,fz) on each center (including
                              symmetry equivalents), 2nd latest geometry step

Record  23
   (R8)          GRADKM1      average gradient between latest and 2nd latest
                              geometry step
   (R8)          GRADMAX1     maximum gradient between latest and 2nd latest
                              geometry step

Records 24
   (3*NCENTR*R8) HESS(i,j)    Hessian matrix, j=1,...3*NCENTR

Record  25
   (I4)          NNNS         number of s components in orbital basis
   (I4)          NNNP         number of p components in orbital basis
   (I4)          NNND         number of d components in orbital basis
   (NCNTRT*I4)   NCNTBK       center pointer for each component in orbital
                               basis, NCNTRT = NNNS + 3*NNNP + 6*NNND

Record  26
   (NT*R8)       OVLP         overlap matrix in triangular form,
                              NT = NCNTRT*(NCNTRT+1)/2

The following records 27 to 28 appear only if the restart file results from a
vibrational analysis, see options <a href="#e.11)">e.11)</a> and <a href="#c.1)">c.1)</a>.

Record  27
   (I4)          NSYMV        number of symmetry representations used in the
                              vibrational analysis.
Record  27 is followed by I = NSYMV groups of records 27a, b, c (I = 1, NSYMV
in the following).

Record(s) 27a
   (C4)          IRRSYM(I)    symmetry label of representation I, I = 1, NSYMV
   (I4)          NBAS(I)      number of vibrational distorsion vectors (true
                              vibrations only) of representation I.
Each record 27a is followed by NBAS(I) groups of records 27b, c (J = 1, NBAS(I)
in the following).

Record(s) 27b
   (I4)          KSYMOP       vibrational symmetry index, see below.
   (3*NCENTR*R8) VBAS(J,I)    vibrational distorsion vectors with 3*NCENTR
                              components each

Records(s) 27c         (appears only if KSYMOP &gt; 0 in record 27b)
   (9*R8)        AROT         3x3 symmetry transformation matrix of the
                              vibrational mode
   (NCENTR*I4)   MAPP         atom center pointers of symmetry transformation
                              AROT

Record(s)  28    ( N = 1, NVBPOS, see record 2 )
   (R8)          ENERGY       total energy of N-th SCF run
   (3*NCENTR*R8) HF           forces (fx,fy,fz) on each center (including
                              symmetry equivalents) of N-th SCF run
   (3*R8)        DIPOLE(I)    dipole moment (dx, dy, dz) of N-th SCF run


Restart cases for single point SCF calculations use only records 1 - 19 for
input, continued geometry optimizations use the extended set, records 1 - 26,
and contunued vibrational analyses use the full set, records 1 - 28. The
properties calculation, see RUNType CPROperties, of StoBe and the external
analysis of the restart file, see utility anlyz in Sec. 2.7.1, uses the
extended set,  records 1 - 26. Records 27 - 27c are exact copies of the
displacement vector file (unit 60) while records 28 copy the internal
vibrational analysis file (unit 61).


<a name="2.5.1."><b>2.5.1.</a>  PREVIOUS RESTART FILE FORMATS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

In the following we describe the format used in previous StoBe runs. This
format is obsolete and of interest only if very old restart files of large
systems are to be revived for runs with the new StoBe version.

Note that a previous local Berlin version of StoBe used the new format
described in 2.5.1, however, with records 20a,b of the old format (obsolete).

The old (obsolete) file format is identical with the latest format in records
1, 3, 8, 9, 11-18, 20, 21-26.

Different records and/or formats:

Record   2
   (R8)          CONSTD       measure of density convergence
   (I4)          NRESFM       restart file format ( = 0 for old format)
Record   4
   (NLA*R8)      DOCA         occupations of occupied alpha orbitals
Record   5
   (NLA*R8)      ELGALP       Kohn-Sham energies of occupied alpha orbitals
Record   6
   (NLB*R8)      DOCB         occupations of occupied beta orbitals
Record   7
   (NLB*R8)      ELGBET       Kohn-Sham energies of occupied beta orbitals
Record  10
   (3*NCENTR*R8) CENT         (x,y,z) of each center (including symmetry
                              equivalents), latest geometry step
Record  19
   (NT*R8)       SXC          exchange-correlation fitting matrix,
                              full square matrix  NT = NBCH*NBCH
Record  19a
   (NT*R8)       SXCINV       inverse of SXC matrix,
                              full square matrix  NT = NBCH*NBCH
Records 20a
   (NLA*R8)      GSHMTA(i,j)  Difference vector on alpha orbitals used in the
                              vibrational analysis, j=1,...NLA
Records 20b
   (NLB*R8)      GSHMTB(i,j)  Difference vector on beta orbitals used in the
                              vibrational analysis, j=1,...NLB



<a name="2.6."><b>2.6.</a>  INPUT/OUTPUT FILE UNITS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The following list contains all predefined input/output units used by StoBe.
In addition, separate units for file input/output may be defined with the
input. Unit types are input to StoBe (I), output of StoBe (O), or both input
and output (I/O).

-----------------------------------------------------------------------------
 Units   Type    Definition
-----------------------------------------------------------------------------
   1      I      Restart input file for SCF or optimization runs
   2      O      Restart output file from SCF or optimization runs
   3      I      Basis set file
   4      I      Symmetry information file (symbasis)
   7     I/O     Interactive control parameter file, see <a href="#f.10)">f.10)</a>
   8     I/O     Three-center Coulomb integrals in conventional SCF
   9     I/O     Exchange-correlation fitting integrals in conv. SCF
   9     I/O     Default unit for surface definition in drawing MEPs
  11      O      XAS/XES/RIXS spectrum file (required as input to xrayspec)
  12      O      Structure file output (pdb, balsac format)
         I/O     Intermediate input/output Dolg pseudopotential titles
  17     I/O     Auxiliary Coulomb matrix for total energy evaluation
  18     I/O     Scratch unit for disk-version of matrix inversion (MATINV1)
                 used to build charge-density fit matrix and its inverse;
                 Inverse of charge density fit matrix
  19     I/O     Scratch unit for symmetrization I  (ASYM)
  20     I/O     Inverse of exchange-correlation fit matrix (SSXC)
  21     I/O     Scratch unit for geometry optimization I   (BROYD3)
  22     I/O     Scratch unit for geometry optimization II  (BROYD3)
  23     I/O     Scratch unit for geometry optimization III (BROYD3)
  24     I/O     Scratch unit for geometry optimization IV  (BROYD3)
  25     I/O     Scratch unit for geometry optimization V   (BROYD3)
  26     I/O     Scratch unit for geometry optimization VI  (BROYD3)
  30     I/O     Intermediate scratch unit for geometry optimization
  31     I/O     Scratch unit for point grids  (DENSTY)
  32      O      Scratch unit for BALSAC population output
  33      O      Fukui matrix file
  41     I/O     Square root of overlap matrix (for Loewdin analysis)
  42      O      Scratch unit for Gaussian-94 format (to be used in Molden) and
                 generic Molden format file output as well as Molekel format
                 file output, intermediate file store for vibrational analysis.
  43     I/O     Overlap matrix
  44     I/O     Orbital symmetrization matrix
  52      I      Input unit for external 1-electron integrals (SCFDOO, STEX)
  59      O      Output of vibrational modes in Molekel [MOL03] format to be
                 used for (animated) visualization.
  60     I/O     Input/output unit of displacement basis (vibrational analysis)
  61     I/O     Scratch unit for vibrational analysis (energies, forces)
  62     I/O     Scratch unit for vibrational analysis (sel. displacements)
  63     I/O     Scratch unit for vibrational analysis (sel. energies, forces)
  64     I/O     Scratch unit for vibrational analysis (copy of unit 60)
  65      O      Vibrational (IR) spectrum file (required as input to irspec)
  66     I/O     Scratch unit for plotting output (SURFAC)
  70      O      File output # 1 (binary) used for NMR analysis
  71      O      File output # 2 (binary)      "
  72      O      File output # 3 (binary)      "
  73      O      File output # 1 (binary) used for EPR analysis
  74      O      File output # 2 (binary)      "
  75      O      File output # 3 (binary)      "
  81     I/O     Scratch unit for spin alpha fock matrix (DIIS)
  82     I/O     Scratch unit for spin alpha DIIS error matrix (DIIS)
  88      O      Binary file output of plotting (DRAW, MEP)
  89      O      Scratch unit for plotting output (DENSDES)
  91     I/O     Scratch unit for spin beta fock matrix (DIIS)
  92     I/O     Scratch unit for spin beta DIIS error matrix (DIIS)
  95      O      File output (ASCII) of MO energies and coefficients
  96      O      File output (ASCII) of MO energies and Mulliken populations
  97      O      File output (ASCII) of MO energies and Loewdin populations
  98      O      File output (ASCII) of plotting (DRAW, MEP)
  99      O      Scratch unit (binary) for plotting (DRAW, MEP)
 100...   I      Restart input files 100 ... 100+nimg for continuing a
                 multi-image SCF run or a NEB path optimization, see <a href="#a.1)">a.1)</a>,
                 <a href="#e.12)">e.12)</a>. The file units can be redirected by resetting the unit
                 offset (default = 100), see <a href="#e.13)">e.13)</a>.
 200...   I/O    Restart intermediate and output files 200 ... 200+nn for
                 a subsequent multi-image SCF run (nn = nimg, see <a href="#a.1)">a.1)</a>) or for
                 continuing a NEB path optimization (nn = nneb, see <a href="#e.12)">e.12)</a>). The
                 file units can be redirected by resetting the unit offset
                 (default = 200), see <a href="#e.14)">e.14)</a>.

Named files:
 GMolden.mdf     Output file (Gaussian-94 format) to be used in Molden [MOD03]
 Molden.molf     Output file (Molden format) to be used in Molden [MOD03]
 Molekel.mkl     Output file to be used in Molekel [MOL03]
 struc000.plt    Structure plot for BALSAC
 strucfin.plt    Structure plot for BALSAC (final geometry)
 strucfin.pdb    Structure file (Protein Data Bank format)
 XrayTnnn.out    XAS/XES/RIXS (total curves) spectrum file from xrayspec,
                 nnn = task number in xrayspec input (e.g. XrayT002.out)
 XrayAnnn.out    XAS/XES/RIXS (angle-resolved curves) spectrum file from
                 xrayspec, nnn = task number in xrayspec input (e.g.
                 XrayA003.out)
 XrayPnnn.out    XAS/XES/RIXS (polarization-resolved curves) spectrum file from
                 xrayspec, nnn = task number in xrayspec input (e.g.
                 XrayP004.out)
 dosTnnn.out     DOS output (total DOS's) file from doscalc,
                 nnn = task number in doscalc input (e.g. dosT004.out)
 dosPnnn.out     PDOS output (partial DOS's) file from doscalc,
                 nnn = task number in doscalc input (e.g. dosP003.out)
-----------------------------------------------------------------------------



<a name="2.7."><b>2.7.</a>  UTILITIES</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

<a name="2.7.1."><b>2.7.1.</a>  ANALYZE RESTART FILES (ANLYZ)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

Utility anlyz allows the analysis of a calulation based on its (binary) restart
file. The calling line reads

      anlyz.x -[options] sourcefile

   or

      anlyz.x sourcefile &lt; inputfile

where 'sourcefile' is a StoBe restart file and 'options' are combinations of
characters c, e, o, m, M, l, L, d, D, s, i or a with

      c         :  listing of  all centers, Balsac/Plot3D (file Structure.plt),
                   XYZ (file Structure.xyz), PDB (files Structure.pdb) format
                   output files for postprocessing.
      e         :  listing of all level energies.
      o         :  listing of all orbital coefficients.
      m5 (m6)   :  Short Mulliken, no Loewdin population analysis
                   (5 true component (6 cartesian) d basis functions)
      M5 (M6)   :  Full Mulliken, no Loewdin population analysis, no bond
                   orders for orbitals (5 true component (6 cartesian) d basis
                   functions)
      l5 (l6)   :  Short Loewdin, no Mulliken population analysis
                   (5 spherical (6 cartesian) d basis functions)
      L5 (L6)   :  Full Loewdin, no Mulliken population analysis, no bond
                   orders for orbitals (5 true component (6 cartesian) d basis
                   functions)
      ml5 (ml6) :  Short Mulliken, short Loewdin population analysis
                   (5 true component (6 cartesian) d basis functions)
      Ml5 (Ml6) :  Full Mulliken, short Loewdin population analysis, no bond
                   orders for orbitals (5 true component (6 cartesian) d basis
                   functions)
      mL5 (mL6) :  Short Mulliken, full Loewdin population analysis, no bond
                   orders for orbitals (5 true component (6 cartesian) d basis
                   functions)
      ML5 (ML6) :  Full Mulliken, full Loewdin population analysis, no bond
                   orders for orbitals (5 true component (6 cartesian) d basis
                   functions)
      dx        :  saves energies and populations on units 96/97 for subsequent
                   (P)DOS calculations (using 5 true component d basis
                   functions).
                         x = 1  Mulliken analysis, output on unit 96.
                           = 2  Loewdin analysis, output on unit 97.
                           = 3  both Mulliken / Loewdin analysis,
                                output on units 96, 97.
      Dx        :  same as option dx but using 6 cartesian d basis functions).
      a         :  combines options c, e, o, M5, L5, d3.
      s         :  short analysis of restart file (syntax check only).
      i         :  include records 20a,b in restart file read.

Option parameters can also be provided by an ASCII input file (unit 5)
consisting of a series of keywords analogous to the original StoBe input and
described in the following. The keyword input has to be finished by a line
reading 'END'.
                                                                 ,
-----------------------------------------------------------------------------
 1)  CENTers
-----------------------------------------------------------------------------

This keyword includes a listing of all center coordinates. In addition,
Balsac/Plot3D (file Structure.plt), XYZ (file Structure.xyz),
PDB (files Structure.pdb) format output files are saved for postprocessing.
This keyword is equivalent to option 'c' in the command line input.

-----------------------------------------------------------------------------
 2)  LEVEls
-----------------------------------------------------------------------------

This keyword includes a listing of all energy levels, both in their order
included in the restart file and in straight energetic order. This is
equivalent to option 'e' in the command line input.

-----------------------------------------------------------------------------
 3)  PORBitals
-----------------------------------------------------------------------------

This keyword includes a listing of all orbital coefficients and is equivalent
to option 'o' in the command line input.

-----------------------------------------------------------------------------
 4)  MULLiken  [OFF  /  ON  [FULL, ORBItal] ]
-----------------------------------------------------------------------------

This keyword includes a listing of the gross Mulliken population analysis and
Mayer bond orders. Both total and orbital resolved data can be requested where,
in the case of orbital values, the analysis is performed for all occupied and
virtual orbitals included in the listing, see also StoBe option <a href="#f.9)">f.9)</a>. By
default, no populations nor bond orders are included. The analysis is performed
in spherical or cartesian gaussians depending on the internal representation of
d basis functions used in the electronic state calculation, see option
ORBItalchoice 6). Keyword line

   MULLiken OFF           lists neither populations nor bond orders. This is
                          the default if no keyword is given.

   MULLiken ON            (or MULLiken) lists total Mulliken populations and
                          total Mayer bond orders.

   MULLiken ON ORBItal   lists total and orbital resolved Mulliken populations
                         as well as total Mayer bond orders.

   MULLiken ON FULL      lists total and orbital resolved Mulliken populations
                         as well as total and orbital resolved Mayer bond
                         orders.

-----------------------------------------------------------------------------
 5)  LOEWdin  [ ON  [FULL, ORBItal] ]
-----------------------------------------------------------------------------

This keyword includes a listing of the Loewdin population analysis and Mayer
bond orders. Both total and orbital resolved data can be requested where, in
the case of orbital values, the analysis is performed for all occupied and
virtual orbitals included in the listing, see also StoBe option <a href="#f.9)">f.9)</a>. By
default, no populations nor bond orders are included. The analysis is performed
in spherical or cartesian gaussians depending on the internal representation of
d basis functions used in the electronic state calculation, see option
ORBItalchoice 6). Keyword line

   LOEWdin OFF           lists neither populations nor bond orders. This is
                         the default if no keyword is given.

   LOEWdin ON            (or LOEWdin) lists total Loewdin populations and
                         total Mayer bond orders.

   LOEWdin ON ORBItal   lists total and orbital resolved Loewdin populations
                        as well as total Mayer bond orders.

   LOEWdin ON FULL      lists total and orbital resolved Loewdin populations
                        as well as total and orbital resolved Mayer bond
                        orders.

-----------------------------------------------------------------------------
 6)  ORBItalchoice
-----------------------------------------------------------------------------

This keyword determines the internal representation of d basis functions used
in the Mulliken or Loewdin population analysis, see 4), 5). Option keyword

     5D     (default) uses the 5 true atomic gaussian d functions (dz2,dx2-y2,
            dxy, dxz, dyz) to represent d orbital basis functions.

     6D     uses the 6 cartesian gaussian d functions (x2, y2, z2, xy, xz,
            yz) to represent d orbital basis functions.

-----------------------------------------------------------------------------
 7)  DOSOutput  [MULLiken, LOEWdin]  [5D, 6D]
-----------------------------------------------------------------------------

This keyword saves Kohn-Sham levels and Mulliken/Loewdin populations on
external files (unit 96 for Mulliken populations, keyword MULLiken; unit 97 for
Loewdin populations, keyword LOEWdin, see also StoBe option <a href="#f.11)">f.11)</a> to be used
for subsequent densities-of-states calculations with utility doscalc, see Sec.
2.7.5. Option keywords 5D, 6D determine the internal representation of d basis
functions used in the Mulliken or Loewdin population analysis, see 6).

-----------------------------------------------------------------------------
 8)  REC20include
-----------------------------------------------------------------------------

This keyword allows to process old restart files which still contain records
20a, b, see 2.5.1.

-----------------------------------------------------------------------------
 9)  SYNTax
-----------------------------------------------------------------------------

This keyword performs a syntax check of the restart file ignoring all other
option keywords.

-----------------------------------------------------------------------------
10)  ALL
-----------------------------------------------------------------------------

This keyword performs a global analysis of the restart file combining options
1) - 7) and corresponding to an input sequence

       &gt; CENTERS
       &gt; LEVELS
       &gt; PORBITALS
       &gt; MULLIKEN ON FULL
       &gt; LOEWDIN ON FULL
       &gt; ORBITALCHOICE 5D
       &gt; DOSOUTPUT MULLIKEN LOEWDIN 5D


Examples:

       &gt; anlyz.x  -d3ceM5l5o  NH3.res  &gt; NH3anlyz.out

    or equivalently

       &gt; anlyz.x  NH3.res  &lt; infile  &gt; NH3anlyz.out

       with an input file 'infile' reading

         ----infile----------------
           DOSO MULLIKEN LOEWDIN
           CENTERS
           LEVELS
           MULLIKEN ON ORBITAL
           LOEWDIN ON
           ORBITAL 5D
           PORBITAL
           END
         ----infile----------------



<a name="2.7.2."><b>2.7.2.</a>  CONVERT/COPY/COMPARE RESTART FILES (TRANSF)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

Utility transf allows to convert restart files from binary to ASCII format, to
copy respective binary / ASCII format restart files, or to compare restart
files. This option is useful if restart files have to be transfered between
systems with incompatible binary number representation. The calling line reads

      transf.x -[options]  sourcefile  targetfile

where 'sourcefile' is a StoBe restart file, 'targetfile' is the output or
another StoBe restart file, and 'options' define the input/output file format
as

      aa :  source  ASCII, target  ASCII
      ab :  source  ASCII, target binary
      ba :  source binary, target  ASCII
      bb :  source binary, target binary

If a character

     "l" is attached to the option ("ab" -&gt; "abl") then the output listing will
         include transfer details.

     "c" is attached to the option ("bb" -&gt; "bbc") then the utility will
         compare all records of the input file with those of the (existing
         output file) and list numerical differences.

     "s" is attached to the option ("ab" -&gt; "abs") then the output file is
         saved in short StoBe restart file format.

NOTE that this utility works only with the new (short) StoBe restart file
format detailed in Sec. 2.5.



<a name="2.7.3."><b>2.7.3.</a>  PLOTTING UTILITY (KHPLTPS)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

Utility khpltps (executable khpltps.x) allows to use binary output files from
StoBe runs to generate PostScript output of (shaded) contour plots showing
variations of

  - electrostatic potentials              (IPROP=  2,  DRAW  MEPS PLANe)
  - orbital wavefunctions                 (IDESS=  1,  DRAW  DENSity  ORBItal)
  - orbital densities                     (IDESS=  2,  DRAW  DENSity  ORBItal)
  - total electron densities              (IDESS=  3,  DRAW  DENSity  TOTAl)
  - Ex, Ec, Exc energy densities          (IDESS=  4,  DRAW  DENSity  EXchange)
  - XC energies (Ex*rho,Ec*rho,Exc*rho)   (IDESS=  5,  DRAW  XCENergy)
  - spin difference density               (IDESS=  6,  DRAW  SFUNction)
  - X, C and XC potentials                (IDESS=  7,  DRAW  XCPOtential)
  - Fukui function (relaxed orbitals)     (IDESS=  9,  DRAW  FUKUI)
  - Fukui function (frozen orbitals)      (IDESS= 10,  DRAW  FFUKUI)
  - Voronoi indices                       (IDESS= 11,  DRAW  VOROnoi)
  - Bader indices                         (IDESS= 12,  DRAW  BADEr)


in planar sections of a molecule/cluster, see keyword DRAW, <a href="#e.5)">e.5)</a>. The utility
requires binary input (unit 4) from StoBe runs (StoBe output unit 88 created by
DRAW options) as well as ASCII input (unit 5) consisting of a series of
keywords analogous to the original StoBe input and described in the following.
The ASCII input has to be finished by a line 'END'.

-----------------------------------------------------------------------------
 1)  ANALyze
-----------------------------------------------------------------------------

This keyword (used by itself) performs an analysis of the binary input
file (unit 4) from a StoBe run to be used for plotting.

-----------------------------------------------------------------------------
 2)  [PRINtplot, CONTours, SHADes, SHCOntours]  nset
-----------------------------------------------------------------------------

Any combination of these keywords uses set no. nset of the binary input
file to generate PostScript or print plot output with

    PRINtplot    giving a graphical representation of the function of
                 set no. nset.

    CONTours     producing PostScript file output (unit 10) with a contour
                 plot of the function of set no. nset.

    SHADes       producing PostScript file output (unit 10) with a shading
                 plot of the function of set no. nset.

    SHCOntours   producing PostScript file output (unit 10) with a
                 shaded contour plot of the function of set no. nset.

PostScript file output (shading, contours) requires one additional line
following the keyword line with

  KEY  KZERO  IZENT  KNUCC  KPRT  VALMIN  DELTA  VALMAX  RELY

              where

                 KEY    = 'ABS'  the absolute values of parameters VALMIN,
                                 DELTA, VALMAX are used for contour values,
                                 |DELTA| is used as an additive increment.
                        = 'REL'  VALMIN, DELTA, VALMAX are taken as fractions
                                 of the largest absolute value of the function
                                 calculated for the plot, |DELTA| is used as an
                                 additive increment.
                        = 'LOG'  the absolute values of parameters VALMIN,
                                 DELTA, VALMAX are used for contour values,
                                 |DELTA| &gt; 1 is used as a multiplicative
                                 increment.

                 KZERO  = 1      suppress zero value contour line.
                        = 0      draw all contour lines as defined.

                 IZENT  = 1      if VALMIN and VALMAX differ in sign, the
                                 values are shifted internally such that at
                                 least one contour line corresponds to the
                                 exact value zero.
                        = 0      option not used.

                 KNUCC  = 1      mark centers on a plot.
                        = 0      no marked centers on a plot.

                 KPRT   = 0      no coordinate printing.
                        = 1      print value and number of points for each
                                 contour line
                        = 2      print excplicit contour line coordinates (for
                                 testing purposes only, large output!).

                 VALMIN          smallest value of contour lines to be
                                 plotted. For keyword LOG +/-|VALMIN| will be
                                 used for positive/negative array values, only
                                 VALMIN &gt; 0 is meaningful.

                 DELTA           increment value between adjacent contour
                                 lines to be plotted. For keywords ABS/REL the
                                 value must be &gt; 0.0, incrementing happens
                                 additively evaluating contours for
                                    VALMIN, VALMIN+DELTA, VALMIN+2*DELTA,
                                    ... VALMAX.
                                 For keyword LOG the increment value must be
                                 &gt; 1.0, incrementing happens multiplicatively
                                 evaluating contours for
                                  +/-|VALMIN|, +/-|VALMIN|*DELTA,
                                  +/-|VALMIN|*DELTA**2, ... +/-|VALMAX|.

                 VALMAX          largest value of contour lines to be
                                 plotted. For keyword LOG +/-|VALMAX| will be
                                 used for positive/negative array values, only
                                 VALMAX &gt; VALMIN &gt; 0 is meaningful.

                 RELY            absolute value of plot size along y
                                 direction given in cm (default = 25.0 cm).

-----------------------------------------------------------------------------
 3)  PSFIle
-----------------------------------------------------------------------------

This keyword followed by one ASCII line (A72) denotes the file name for
PostScript print output of the present run. If no name is given the standard
name of fortran unit 10, e.g. fort.10, is used instead.

-----------------------------------------------------------------------------
 4)  ORIEntation   [SEPArate]
-----------------------------------------------------------------------------

This keyword allows to print an orientation plot showing the positions of all
atom centers with projections inside the plot area of the previous plot. The
option keyword SEPArate prints the orientation plot on a separate page. Note
that this option requires a PostScript plot to be finished before it can be
used.

-----------------------------------------------------------------------------
 5)  NEWPage
-----------------------------------------------------------------------------

This keyword starts a new page in the PostScript output allowing to separate
groups of plots. The keyword NEWPage must appear directly after a PostScript
plot request, see options CONTours, SHADes, SHCOntours in 2).


The binary file used as input (unit 4) is created by a StoBe run (unit 88) when
the DRAW keyword is used, see <a href="#e.5)">e.5)</a>. It consists of different records as follows
(parameter types are I4=INTEGER*4, R8=REAL*8, Cn=CHARACTER*n):

Record   n.1
   (C80)             RUNTIT       run title of set n

Record   n.2
   (2*R8)        XA, XE           start and end point of plot section along x
                                  (real space molecular coordinates). The
                                  section length along x is given by (XE - XA).
   (2*R8)        YA, YE           start and end point of plot section along y
                                  (real space molecular coordinates). The
                                  section length along y is given by (YE - YA).
   (I4)              NX           number of calculated points along x
   (I4)              NY           number of calculated points along y
   (I4)              NPTS         block size of storing function array f(i,j)

Records  n.3
   (NX*NY*R8)        FUNCT        function array f(i,j), i=1,NX, j=1,NY in
                                  blocks of NPTS values (except last block)

Record  n.4
   (I4)              NCENT        total number of atom centers of the system

Record  n.5
   (NCENT*(C4,3R8))  LAB,X,Y,Z    atom labels and coordinates of all atom
                                  centers wrt. plot plane

where a sequence of records n.1, n.2, n.3 occurs in the file depending on the
number of plot arrays generated.

Example input:

     &gt;ANALYZE
     &gt;PRINTPLOT  3
     &gt;CONTOUR  SHCONTOUR  4
     &gt;ABS  0  0  0  .01  .01  .1  10.
     &gt;PRINT  SHCONT  1
     &gt;ABS  0  0  0  .01  .01  .1  15.
     &gt;ORIENT SEPARATE
     &gt;SHADE  2
     &gt;REL  1 0 0 .01  .01  .1  12.
     &gt;PSFILE
     &gt;newfile.eps
     &gt;END

produces
   - a print plot of set 3,
   - a contour plot and a shaded contour plot of set 4  (absolute contours
     between 0.01 and 0.1 with increments 0.01), real plot size along y = 10
     cm,
   - a print plot and shaded contour plot of set 1 (absolute contours between
     0.01 and 0.1 with increments 0.01), real plot size along y = 15 cm,

   - an orientation plot of all atom centers on a separate page,

   - a shading plot of set 2 (relative shding values between 0.01 and 0.1
     with increments 0.01), real plot size along y = 12 cm,

   - and all PostScript print output is saved on file newfile.eps .



<a name="2.7.4."><b>2.7.4.</a>  DOING RESONANT INELASTIC X-RAY SCATTERING (RIXS) ANALYSIS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The keyword RIXS prints both the occupied and unoccupied dipole transition
moments. If a true RIXS treatment of the data is desired, this is done in
separate programs e.g. RIXS_detune.x as supplied on Source/XRAY/RIXS. Here, the
spectrum is spherically averaged according to the group theory formulation by
Y. Luo et al (J. Phys. B27, 4169 (1994); Phys. Rev. B52, 14478 (1995)).

Input example:

First line: Gamma, Gamm_L, where Gamma is the life time broadening (eV) and
Gamm_L is the fwhm width of the incoming photon distribution (eV).
Second line: 0.5 eV detuning, 2 core orbs, 2 occ orbs, 5 unocc orbs, start,
end, atom for which the excitation is considered, resonant level number, shift
(should be 0.0 except for test cases)

The example below will give 0.5 eV detuning from the unoccupied level at
-3.956 eV.

--------------------------------------------------------------------------
0.08 0.2                            %Gamma, Gamm_L
0.5 2 2 5 242. 265. 3 1 0.0         % See explanation above
 -267.37                            %Core level energy level 1
 -267.36                            %Core level energy level 2
   -4.876 -0.0022  0.0000  0.0000   %Unocc orbs on atom 1 (5 in this case)
   -4.188  0.0000  0.0040  0.0096
   -3.956  0.0000  0.0021 -0.0011
   -3.685  0.0000  0.0080  0.0013
   -3.495  0.0000 -0.0073 -0.0114
  -10.991  0.0000  0.0052 -0.0113   %Occ orbs on atom 1 (2 in this case)
   -5.648  0.0000 -0.0028 -0.0047
   -4.876 -0.0011  0.0000  0.0000   %Unocc orbs on atom 2 (5 in this case)
   -4.188  0.0000  0.0030  0.0044
   -3.956  0.0000  0.0011 -0.0021
   -3.685  0.0000  0.0080  0.0023
   -3.495  0.0000  0.0073  0.0104
  -10.994  0.0010  0.0000  0.0000   %Occ orbs on atom  (2 in this case)
   -5.648  0.0000  0.0028  0.0037

--------------------------------------------------------------------------



<a name="2.7.5."><b>2.7.5.</a>  TOTAL/PARTIAL DENSITIES-OF-STATES (DOSCALC)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

Utility doscalc (executable doscalc.x) allows you to use output files from
StoBe runs to generate arrays of (projected) densities-of-states, (P)DOS, for
graphical output or for further processing. Total DOSs are generated by
gaussian level broadening where the broadening width (FWHM) can be chosen
freely. PDOSs are also generated by gaussian level broadening where different
projections are available based on the Mulliken analysis. The projections allow
you to select atoms, orbitals, orbital angular components, spin, and symmetry
in any combination.

File output of (P)DOSs consists of array listings combining each energy of a
given range with one or three (spin polarized case) (P)DOS values. Each array
listing is saved in a separate file dosT(k).out (for total DOS's) or
dosP(k).out (for partial DOS's) where k numbers the (P)DOS curves according to
their sequence given in the input and '(k)' is a 3-digit version of k padded
with leading zeros. The (P)DOS listings can also be printed, see option PRINt
below.

The utility requires input (unit 1) from StoBe runs (StoBe output unit 96,
created by option DOSO) as well as ASCII input (unit 5) consisting of a series
of keywords analogous to the original StoBe input and described in the
following. The keyword input has to be finished by a line reading 'END'.


-----------------------------------------------------------------------------
 1)  TITLe
-----------------------------------------------------------------------------

Brief descriptive title of the present doscalc run on the line following the
keyword. This title appears in the output file(s). If no title is given doscalc
takes the title of the StoBe input file (unit 1)

Example:

     &gt;TITLE
     &gt;h2o local opt


-----------------------------------------------------------------------------
 2)  RANGe  [opt]  ebot  etop
-----------------------------------------------------------------------------

Range of energies [ebot, etop] (in eV) for which (P)DOSs are to be calculated.
The optional keyword opt is any combination of the three characters h, lg g.
For option

  opt =   h     Ehomo is used as only reference energy:
                                          range = [Ehomo+ebot, Ehomo+etop]
      =   hg    same as h with exact zero (P)DOS inside HOMO-LUMO gap

      =   l     Elumo is used as only reference energy:
                                          range = [Elumo+ebot, Elumo+etop]
      =   lg    same as l with exact zero (P)DOS inside HOMO-LUMO gap

      =   lh    Elumo and Elumo are used as reference energies:
                                          range = [Ehomo+ebot, Elumo+etop]
      =   lhg   same as lh with exact zero (P)DOS inside HOMO-LUMO gap

      =   g     absolute range [ebot, etop], exact zero (P)DOS inside
                HOMO-LUMO gap

Omitting keyword RANGe correponds to the default
range = [Ehomo - 20, Ehomo + 10] with exact zero (P)DOS inside HOMO-LUMO gap

Examples:

     &gt;RANGE  -100.0  .5     : range between -100.0 eV and +0.5 eV

     &gt;RANGE  hlg -20 10     : range between Ehomo - 20 eV and Elumo + 10 eV
                                   density inside HOMO-LUMO gap suppressed


-----------------------------------------------------------------------------
 3)  POINts  npts
-----------------------------------------------------------------------------

Number of energies within the range [ebot, etop] for which (P)DOSs are to be
calculated. The energy sequence is equidistant, given by
           e = ebot + (etop-ebot)/(npts-1)*(i-1), i = 1, npts
If this keyword is omitted the default value npts = 1000 is used.

Example:

     &gt;POINTS 500


-----------------------------------------------------------------------------
 4)  WIDTh  broad1  [ broad2  ewid1  ewid2 ]
-----------------------------------------------------------------------------

Width (full-width-at-half-maximum, FWHM) (in eV) used in the gaussian level
broadening. The short version uses only a global broadening of width broad1.
The full version uses an energy dependent broadening where a width broad1 is
used for level energies &lt; ewid1, width broad2 is used for level energies &gt;
ewid2 ( &gt; ewid1), and for level energies between ewid1 and ewid2 a linear
interpolation

      broad(E) = broad1 + (broad2-broad1)*(E-ewid1)/ewid2-ewid1)

is used. If this keyword is omitted the default value broad = 1 eV is used.

Examples:

     &gt;WIDTH .5
     &gt;WIDTH .5 .8 -10.0 -5.0

-----------------------------------------------------------------------------
 5)  PRINt
-----------------------------------------------------------------------------

This keyword includes lists of the (P)DOS arrays in the standard printout in
addition to file output.


-----------------------------------------------------------------------------
 6)  TOTAldos  [SPIN]
-----------------------------------------------------------------------------

This keyword initializes a total DOS calculation. By default ALL atoms,
orbitals, orbital angular components, and symmetries are selected. Up to 10
total and partial DOSs can be calculated in one doscalc run. The file (and
print) output lists one DOS array (for combined spin up/down).

If the optional keyword SPIN is included, the total DOS is evaluated for spin
up and spin down orbitals separately. The file (and print) output lists three
DOS arrays (for combined spin up/down, for spin up, for spin down orbitals).


-----------------------------------------------------------------------------
 7)  PARTialdos  [SPIN]
-----------------------------------------------------------------------------

This keyword initializes a partial (projected) DOS calculation. By default NO
atoms, orbitals, orbital angular components, and symmetries are selected and
have to be selected separately (with keywords ALL, ATOMs, ORBItal, COMPonent,
SYMMetry). Up to 10 total and partial DOSs can be calculated in one doscalc
run. The file (and print) output lists one DOS array (for combined spin
up/down).

If the optional keyword SPIN is included, the PDOS is evaluated for spin up and
spin down orbitals separately. The file (and print) output lists three PDOS
arrays (for combined spin up/down, for spin up, for spin down orbitals).


-----------------------------------------------------------------------------
 8)  ALL
-----------------------------------------------------------------------------

This keyword (not needed in total DOS calculations, see keyword TOTAldos)
selects all atoms, orbitals, orbital angular components, and symmetries in a
PDOS calculation.


-----------------------------------------------------------------------------
 9)  NONE
-----------------------------------------------------------------------------

This keyword (not needed in total DOS calculations, see keyword TOTAldos)
deselects all atoms, orbitals, orbital angular components, and symmetries in a
PDOS calculation.


-----------------------------------------------------------------------------
 10)  ATOMselect  {ALL, NONE, INCLude, EXCLude}
-----------------------------------------------------------------------------

This keyword (not needed in total DOS calculations, see keyword TOTAldos)
selects or deselects atoms in a PDOS calculation. Several keyword lines can be
added and will be evaluated sequentially to achieve the final atom selection.
This keyword line comes with different versions

    ATOMselect  ALL  [weight]
        selects all atoms available from the StoBe input file. The optional
        parameter weight uses a scaling factor to scale atom contributions. If
        no weight value is given, a default weight = 1.0 is used.

    ATOMselect  NONE
        deselects all atoms available from the StoBe input file.

    ATOMselect  INCLude  elmnt   [weight]
        selects all atoms of a given element name elmnt (e.g. H, O, V, Na)
        available from the StoBe input file. The optional parameter weight uses
        a scaling factor to scale the atom contributions. If no weight value is
        given, a default weight = 1.0 is used.

    ATOMselect  INCLude  n1  n2  n3  ...   weight
        selects atoms no. n1  n2  n3  ... (up to 10 atom numbers are allowed)
        available from the StoBe input file. The parameter weight uses a
        scaling factor to scale the atom contributions. Note that with this
        keyword choice the parameter weight MUST be given at the end of the
        list. This option line can be repeated if more than 10 atom numbers
        are requested.

    ATOMselect  EXCLude  elmnt
        deselects all atoms of a given element name elmnt (e.g. H, O, V, Na)
        from the present atom list.

    ATOMselect  EXCLude  n1  n2  n3  ...
        deselects atoms no. n1  n2  n3  ... (up to 10 atom numbers are allowed)
        from the present atom list. This option line can be repeated if more
        than 10 atom numbers are requested.

Examples:

     &gt;ATOM ALL
     &gt;ATOM NONE
     &gt;ATOM INCL V .5
     &gt;ATOM INCL 1 2 3 .8
     &gt;ATOM EXCL O
     &gt;ATOM EXCL 12 1 5


-----------------------------------------------------------------------------
 11)  ORBItalselect  {ALL, NONE, INCLude, EXCLude}
-----------------------------------------------------------------------------

This keyword (not needed in total DOS calculations, see keyword TOTAldos)
selects or deselects orbitals in a PDOS calculation. Several keyword lines can
be added and will be evaluated sequentially to achieve the final orbital
selection. This keyword line comes with different versions

    ORBItalselect  ALL  [ALFA, BETA]
        selects all orbitals available from the StoBe input file. The optional
        keywords ALFA, BETA allow you to select only alpha or beta spin
        orbitals.

    ORBItalselect  NONE
        deselects all orbitals available from the StoBe input file.

    ORBItalselect  INCLude  n1  n2  n3  ...
        selects orbitals no. n1  n2  n3  ... (up to 10 orbital numbers are
        allowed) available from the StoBe input file. This option line can be
        repeated if more than 10 orbital numbers are requested.

    ORBItalselect  EXCLude  n1  n2  n3  ...
        deselects orbitals no. n1  n2  n3  ... (up to 10 orbital numbers are
        allowed) from the present orbital list. This option line can be
        repeated if more than 10 orbital numbers are requested.

Examples:

     &gt;ORBITAL ALL
     &gt;ORBITAL NONE
     &gt;ORBITAL INCL 1 13 124
     &gt;ORBITAL EXCL 1 2 3


-----------------------------------------------------------------------------
 12)  COMPonentselect  {ALL, NONE, INCLude, EXCLude}
-----------------------------------------------------------------------------

This keyword (not needed in total DOS calculations, see keyword TOTAldos)
selects or deselects orbital angular components in a PDOS calculation. Several
keyword lines can be added and will be evaluated sequentially to achieve the
final component selection. This keyword line comes with different versions

    COMPonentselect  ALL
        selects all orbital angular components available from the StoBe input
        file. For atoms with s, p, d functions this includes altogether 10
        components: s, x, y, z, xx, xy, xz, yy, yz, zz.

    COMPonentselect  NONE
        deselects all orbital angular components available from the StoBe input
        file.

    COMPonentselect  INCLude  c1  c2  c3  ...
        selects orbital angular components available from the StoBe input file
        using their generic names ci = S, P (combines x,y,z), D (combines xx,
        xy, xz, yy, yz, zz), X, Y, Z, XX, XY, XZ, YY, YZ, ZZ. Note that entries
        ci have to be given by upper case characters. The definition of d
        components depends also on the choice of the d representation in the
        preceding StoBe run (5d vs. 6d). For a 5d representation 'XX' is
        meaningless, 'YY' refers to dz2, and 'ZZ' refers to dx2-y2.

    COMPonentselect  EXCLude  c1  c2  c3  ...
        deselects orbital angular components from the present component list
        using their generic names ci = S, P (combines x,y,z), D (combines xx,
        xy, xz, yy, yz, zz), X, Y, Z, XX, XY, XZ, YY, YZ, ZZ. Note that entries
        ci have to be given by upper case characters. The definition of d
        components depends also on the choice of the d representation in the
        preceding StoBe run(5d vs. 6d). For a 5d representation 'XX' is
        meaningless, 'YY' refers to dz2, and 'ZZ' refers to dx2-y2.

Examples:

     &gt;COMPONENT ALL
     &gt;COMPONENT NONE
     &gt;COMPONENT INCL S P XX YY ZZ
     &gt;COMPONENT EXCL D Z


-----------------------------------------------------------------------------
 13)  SYMMetryselect  {ALL, NONE, INCLude, EXCLude}
-----------------------------------------------------------------------------

This keyword (not needed in total DOS calculations, see keyword TOTAldos)
selects or deselects symmetry components in a PDOS calculation. Several keyword
lines can be added and will be evaluated sequentially to achieve the final
symmetry component selection. This keyword line comes with different versions

    SYMMetryselect  ALL
        selects all symmetry components available from the StoBe input
        file (e.g. A1, A2, E  for NH3 in C3v symmetry).

    SYMMetryselect  NONE
        deselects all symmetry components available from the StoBe input
        file (e.g. A1, A2, E  for NH3 in C3v symmetry).

    SYMMetryselect  INCLude  s1  s2  s3  ...
        selects symmetry components available from the StoBe input file using
        their generic names si (e.g. A1, A2, E  for NH3 in C3v symmetry). Note
        that entries ci have to conform with the notation used in StoBe.

    SYMMetryselect  EXCLude  s1  s2  s3  ...
        deselects symmetry components from the present component list using
        their generic names si (e.g. A1, A2, E  for NH3 in C3v symmetry). Note
        that entries ci have to conform with the notation used in StoBe.

Examples:

     &gt;SYMMETRY ALL
     &gt;SYMMETRY NONE
     &gt;SYMMETRY INCL A1 E
     &gt;SYMMETRY EXCL A1


-----------------------------------------------------------------------------
 14)  NOOCcupations
-----------------------------------------------------------------------------

This keyword (used in both total and partial DOS calculations) ignores level
occupations given with the StoBe file (input unit 1) and sets all
orbitals occupations to 1.0. This allows to calculate (P)DOS's for any energy
range including occupied as well as empty (virtual) orbitals. By default, level
occupations are taken into account in the (P)DOS calculations.


-----------------------------------------------------------------------------
 15)  VIRTualorbitalsonly
-----------------------------------------------------------------------------

This keyword (used in both total and partial DOS calculations) includes only
unoccupied levels (referring to virtual orbitals) of the StoBe file (input unit
1) in the (P)DOS calculation, setting occupations of all virtual orbital to 1.0
and of all occupied orbitals to 0.0. By default, the level occupations of the
input file are taken into account in the (P)DOS calculations.


-----------------------------------------------------------------------------
 16)  BALPopulation
-----------------------------------------------------------------------------

This keyword initiates BALSAC [H00] format file output to visualize and analyze
atom populations determined in total and partial DOS calculations, see also
<a href="#e.4)">e.4)</a>. The output files can be used as input to BALSAC where the atoms of a
cluster/ molecule are displayed as shaded balls. The ball radii are defined by
the actual atom populations where positive/negative populations are shown by
different colors (red/blue by default) in the plot. The selection of Mulliken
or Loewdin populations is determined by the DOS constraints, see above.

If spin selection in the DOS output is defined, see keyword SPIN in options 6),
7), the present option generates three files, popAxxx.plt (spin alpha result),
popBxxx.plt (spin beta result), popTxxx.plt (total (spin alpha + beta) result).
Here xxx is the sequence number of the total / partial DOS calculation in the
present DOSCALC run. If no spin selection is defined, only file output on
popTxxx.plt (total (spin alpha + beta) result) is made. By default, no BALSAC
file output is generated.


The following full example starts from a NH3 calculation and calculates a total
DOS with spin resolution together with BALSAC file output on file popA001.plt,
popB001.plt, popT001.plt, followed by a PDOS calculation including only
hydrogen s contributions in all symmetry representations.

     &gt;TITLE
     &gt;NH3 local opt   density of states
     &gt;RANGE -386 0
     &gt;POINTS 2000
     &gt;WIDTH .7
     &gt;PRINT
     &gt;TOTAL SPIN
     &gt;BALPOP
     &gt;PARTIAL
     &gt;ATOM INCL H
     &gt;ORBITAL ALL
     &gt;COMP INCL S
     &gt;SYMM ALL
     &gt;END



<a name="2.7.6."><b>2.7.6.</a>  TOTAL/ANGLE-RESOLVED XRAY SPECTRA (XRAYSPEC)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

Utility xrayspec (executable xrayspec.x) allows you to use output files from
StoBe runs to generate total and angle-resolved Xray (XAS, XES, RIXS) spectra
for graphical output or for further processing. The spectra include gaussian
broadening where the broadening width (FWHM) can be chosen freely.
Angle-resolved spectra can be computed for any polarization direction or
incident/exit beam given by angles theta, phi.

File output of spectra consists of array listings combining each transition
energy with the corresponding absorption (given in a.u.). Each spectrum is
saved in a separate file XrayTnnn.out (for total spectra), XrayAnnn.out
(angle-resolved spectra), or XrayPnnn.out (polarization- resolved spectra)
where 'nnn' is a 3-digit number (padded with leading zeros id needed) counting
the sequence of spectra defined by the input. For example, the second total
spectrum file is named XrayT002.out. The spectra listings can also be printed,
see option PRINt below.

The utility requires input (unit 1) from StoBe runs (StoBe output unit 11,
created by option XRAY) as well as ASCII input (unit 5) consisting of a series
of keywords analogous to the original StoBe input and described in the
following. The keyword input has to be finished by a line reading 'END'.


-----------------------------------------------------------------------------
 1)  TITLe
-----------------------------------------------------------------------------

Brief descriptive title of the present xrayspec run on the line following the
keyword. This title appears in the output file(s).

Example:

     &gt;TITLE
     &gt;H2O O1s -&gt; virt  Xray spectrum


-----------------------------------------------------------------------------
 2)  XRAY  [type]
-----------------------------------------------------------------------------

Type of spectrum to be calculated where

        type =  'XAS'   refers to an Xray absorption spectrum. This is the
                        default if no spectrum type is defined.

             =  'XES'   refers to an Xray emission spectrum.

             =  'RIXS'  refers to a RIXS (resonant ionization Xray spectrum)
                        spectrum. NOTE that so far only the two RIXS steps,
                        core-&gt;unocc. excitation, valence-&gt;core deexcitation,
                        can be accounted for in separate spectra. Spectra of
                        the complete RIXS process are not available.

                        The RIXS analysis allows an additional keyword (OCC,
                        VIRT, ALL) where

                           XRAY  RIXS  OCC
                                 includes only valence-&gt;core deexcitations in
                                 the spectrum.

                           XRAY  RIXS  VIRT
                                 includes only core-&gt;unocc. excitations in the
                                 spectrum.

                           XRAY  RIXS  ALL
                                 superimposes core-&gt;unocc. as well as
                                 valence-&gt;core transitions in the spectrum.
                                 This is the default if the additional keyword
                                 is omitted.

The program checks the data input (unit 1) for consistency with the spectrum
type, see also option XRAY, <a href="#e.7)">e.7)</a>. NOTE that this keyword line must appear
before any spectrum definition (TOTAlspectrum, ANGLeresolvedspectrum,
POLArizedspectrum), see below.


-----------------------------------------------------------------------------
 3)  TOTAlspectrum  [ipos]
-----------------------------------------------------------------------------

This spectrum keyword initializes the evaluation of a total (angle-averaged
and unpolarized) Xray spectrum calculation using data from previous StoBe runs.

The spectral weight of each transition is given by

   (a) dipole transitions

         W(i) = 2/3*f * E(i) * (Dx**2 + Dy**2 + Dz**2)

       where D(i) = (Dx, Dy, Dz) are dipole transition matrix elements of
       transition i, E(i) is the transition energy, and f (= 1000) is an
       empirical scaling factor.

   (b) quadrupole transitions

         W(i) = 1/15*f * E(i) * [  3*(Qxx + Qyy + Qzz)**2
                                 - 4*(Qxx*Qyy + Qxx*Qzz + Qyy*Qzz)
                                 + 4*(Qxy**2 + Qxz**2 + Qyz**2)    ]

       where Q(i) = (Qxx, Qxy, Qxz, Qyy, Qyz, Qzz) are quadrupole transition
       matrix elements of transition i, E(i) is the transition energy, and
       f (= 1000) is an empirical scaling factor.

Set no. ipos of the StoBe spectrum file (output unit 65) is used for input (as
file unit 1). If ipos is omitted, ipos = 1 is assumed. Corresponding spectrum
parameters (keywords RANGe, POINts, WIDTh, PRINt, SCALe, OFFSet), if different
from default values, have to be given immediately after the keyword line.
Output files are named XrayTnnn.out where nnn = 001, 002, ...

Example:

     &gt;TOTAL  1


-----------------------------------------------------------------------------
 4)  ANGLeresolvedspectrum  theta  phi  [ipos]

     ANGLeresolvedspectrum  xx  yy  zz  ipos             (alternative format)
-----------------------------------------------------------------------------

This keyword initializes the evaluation of an angle-resolved Xray spectrum using
data from a previous StoBe run. The spectrum refers to a given direction of the
incident/exciting light beam where the absorption is an average over all
possible polarization vectors perpendicular to the beam direction e given by

        e = ( sin(theta)*cos(phi), sin(theta)*sin(phi), cos(theta) )  .

Here theta, phi (in degrees) are correponding polar and azimuthal angles. The
alternative input uses a vector R = (xx, yy, zz) which is converted to angles
theta, phi according to

        R = |R| ( sin(theta)*cos(phi), sin(theta)*sin(phi), cos(theta) ) .

The spectral weight of each transition is given by

   (a) dipole transitions

         W(i) = f * E(i) * 1/2 [  (Dx**2 + Dy**2 + Dz**2)
                                - (Dx*ex + Dy*ey + Dz*ez)**2 ]

       where D(i) = (Dx, Dy, Dz) are dipole transition matrix elements of
       transition i, E(i) is the transition energy, and f (= 1000) is an
       empirical scaling factor.

   (b) quadrupole transitions

         W(i) = f * E(i) *
            1/8 { 3 [ Qxx*(1-ex**2) + Qyy*(1-ey**2) + Qzz*(1-ez**2)
                        - 2*Qxy*ex*ey - 2*Qxz*ex*ez - 2*Qyz*ey*ez ]**2
                + 4 [ (Qyz**2-Qyy*Qzz)*ex**2 + (Qxz**2-Qxx*Qzz)*ey**2
                    + (Qxy**2-Qxx*Qyy)*ez**2 - 2*(Qxz*Qyz-Qxy*Qzz)*ex*ey
                    - 2*(Qxy*Qyz-Qxz*Qyy)*ex*ez - 2*(Qxy*Qxz-Qxx*Qyz)*ey*ez ] }

       where Q(i) = (Qxx, Qxy, Qxz, Qyy, Qyz, Qzz) are quadrupole transition
       matrix elements of transition i, E(i) is the transition energy, and
       f (= 1000) is an empirical scaling factor.

Set no. ipos of the StoBe spectrum file is used for input (unit 1). If ipos is
omitted, ipos = 1 is assumed. Note that for direction input in Cartesian
coordinates xx, yy, zz the position index ipos MUST be given. Corresponding
spectrum parameters (keywords RANGe, POINts, WIDTh, PRINt, SCALe), if different
from default values,  have to be given immediately after the keyword line.
Output files are named XrayAnnn.out where nnn = 001, 002, ...

Examples:

     &gt;ANGLE  50 20


-----------------------------------------------------------------------------
 5)  POLArizedspectrum  theta  phi  [ipos]

     POLArizedspectrum  xx  yy  zz  ipos               (alternative format)
-----------------------------------------------------------------------------

This keyword initializes the evaluation of an polarization-resolved Xray spectrum
using data from a previous StoBe run. The spectrum refers to a given direction
of the polarization vector of the incident/exciting light. The polarization
direction is defined by two angles, theta, phi of a direction vector e with
(angles in degrees)

        e = ( sin(theta)*cos(phi), sin(theta)*sin(phi), cos(theta) )

where theta, phi (in degrees) are correponding polar and azimuthal angles. The
spectrum can be averaged over all angles theta for given phi or phi for given
theta by using keyword 'AVG' instead of an explict numerical value for the
angles, see example below.

The alternative input uses a vector R = (xx, yy, zz) which is converted to
angles theta, phi according to

        R = |R| ( sin(theta)*cos(phi), sin(theta)*sin(phi), cos(theta) ) .

Note that with this input format angle averaging is not available.

The spectral weight of each transition is given by

   (a) dipole transitions

         W(i) = f * E(i) * (Dx*ex + Dy*ey + Dz*ez)**2

       where D(i) = (Dx, Dy, Dz) are dipole transition matrix elements of
       transition i, E(i) is the transition energy, and f (= 1000) is an
       empirical scaling factor.

   (b) quadrupole transitions

         W(i) = f * E(i) * [  Qxx*ex**2 + Qyy*ey**2 + Qzz*ez**2
                            + 2*Qxy*ex*ey + 2*Qxz*ex*ez + 2*Qyz*ey*ez) ]**2

       where Q(i) = (Qxx, Qxy, Qxz, Qyy, Qyz, Qzz) are quadrupole transition
       matrix elements of transition i, E(i) is the transition energy, and
       f (= 1000) is an empirical scaling factor.

Set no. ipos of the StoBe spectrum file is used for input (unit 1).  If ipos is
omitted, ipos = 1 is assumed. Note that for direction input in Cartesian
coordinates xx, yy, zz the position index ipos MUST be given. Corresponding
spectrum parameters (keywords RANGe, POINts, WIDTh, PRINt, SCALe), if different
from default values,  have to be given immediately after the keyword line.
Output files are named XrayPnnn.out where nnn = 001, 002, ...

Examples:

     &gt;POLAR   70 10
     &gt;POLAR   AVG 45
     &gt;POLAR   39 AVG


-----------------------------------------------------------------------------
 6)  MULTipole  [type] [ratio]
-----------------------------------------------------------------------------

Definition of multipole transitions to be included in the spectrum. If this
keyword line is omitted a default transition type is used. If the keyword line
appears before any spectrum task (see keywords TOTAlspectrum,
ANGLeresolvedspectrum, POLArizedspectrum) the initial default transition type
will be reset and applied to all spectrum tasks without an explicit MULTipole
line. Otherwise, the multipole keyword applies to the spectrum (TOTAl, ANGLe,
POLArized) defined before. Options are

        multipole  =  'DIPL'          refers to an Xray spectrum where only
                                      dipole transition are evaluated. This is
                                      the default if no multipole type is
                                      defined.

                   =  'QUAD'          refers to an Xray spectrum where only
                                      quadrupole transition are evaluated.

                   =  'DIPQ' [fmix]   refers to an Xray spectrum where both
                                      dipole and quadrupole transition are
                                      evaluated and corresponding intensities
                                      are superimposed. Parameter fmix defines
                                      the mixing of dipole and quadrupole
                                      intensities in the superposition

                                         I(tot) = I(dip) + fmix * I(quad)

                                      where fmix = 1.0 is the default.


Example:

     &gt;MULTIPOLE  DIPQ  100.

-----------------------------------------------------------------------------
 7)  RANGe  ebot  etop
-----------------------------------------------------------------------------

Range of energies [ebot, etop] (in eV) for which the spectrum of the present
spectrum task is to be evaluated. If this keyword line is omitted a default
range is used. If the keyword line appears before any spectrum task (see
keywords TOTAlspectrum, ANGLeresolvedspectrum, POLArizedspectrum) the initial
default values [500.0, 1000.0] will be reset to [ebot, etop] and applied to all
spectrum tasks without an explicit RANGe line.

Example:

     &gt;RANGE  530 600


-----------------------------------------------------------------------------
 8)  POINts  npts
-----------------------------------------------------------------------------

Number of energies within the range [ebot, etop] for which the spectrum of the
present spectrum task is to be evaluated. The energy sequence is equidistant,
given by

           e = ebot + (etop-ebot)/(npts-1)*(i-1), i = 1, npts

If this keyword line is omitted a default value is used. If the keyword line
appears before any spectrum task (see keywords TOTAlspectrum,
ANGLeresolvedspectrum, POLArizedspectrum) the initial default value (= 1000)
will be reset to npts and applied to all spectrum tasks without an explicit
POINts line.

Example:

     &gt;POINTS 2000


-----------------------------------------------------------------------------
 9)  WIDTh  broad1  [ broad2  ewid1  ewid2 ]
-----------------------------------------------------------------------------

Width (full-width-at-half-maximum, FWHM) (in eV) used for the gaussian
broadening of the spectrum of the present spectrum task. The short version uses
only a global broadening of width broad1. The full version uses an energy
dependent broadening where a width broad1 is used for level energies &lt; ewid1,
width broad2 is used for level energies &gt; ewid2 ( &gt; ewid1), and for level
energies between ewid1 and ewid2 a linear interpolation

      broad(E) = broad1 + (broad2-broad1)*(E-ewid1)/ewid2-ewid1)

is applied. If this keyword line is omitted default values are used. If the
keyword line appears before any spectrum task (see keywords TOTAlspectrum,
ANGLeresolvedspectrum, POLArizedspectrum) the initial defaults (broad1 = broad2
= 1 eV, ewid1 = ewid2= 1.D30) will be reset and applied to all spectrum tasks
without an explicit WIDTh line.

Examples:

     &gt;WIDTH .5
     &gt;WIDTH 0.2 2.5 544.09 554.09


-----------------------------------------------------------------------------
 10)  SCALe  scalfac
-----------------------------------------------------------------------------

Definition of a factor used to scale the spectrum of the present spectrum task.
All intensities will be enhanced/reduced by a factor scalfac. If this keyword
line is omitted a default factor scalfac is used. If the keyword line appears
before any spectrum task (see keywords TOTAlspectrum, ANGLeresolvedspectrum,
POLArizedspectrum) the initial default (scalfac = 1.0) will be reset and
applied to all spectrum tasks without an explicit SCALe line.

Example:

     &gt;SCALE 3.0


-----------------------------------------------------------------------------
 11)  OFFSetenergy  eoffst
-----------------------------------------------------------------------------

Definition of an energy offset (in eV) used to shift the spectrum of the
present spectrum task. All spectral energies will be shifted by adding the
offset eoffst. If the keyword line appears before any spectrum task (see
keywords TOTAlspectrum, ANGLeresolvedspectrum, POLArizedspectrum) the initial
default (eoffst = 0.0) will be reset and applied to all spectrum tasks without
an explicit OFFSetenergy line.

Example:

     &gt;OFFSET 1.54


-----------------------------------------------------------------------------
 12)  PRINt  [ON, OFF]
-----------------------------------------------------------------------------

This keyword allows to include lists of the spectrum curves in the standard
printout in addition to file output (option ON). If this keyword line is
omitted a default setting is used (no spectrum listing in printout). If the
keyword line appears before any spectrum task (see keywords TOTAlspectrum,
ANGLeresolvedspectrum, POLArizedspectrum) the initial default (no print output,
file output only) will be reset and applied to all spectrum tasks without an
explicit PRINt line.

Examples:

     &gt;PRINT ON       includes spectrum listing   (same as line &gt;PRINT)
     &gt;PRINT OFF      omits spectrum listing (but saves spectra to files)


The following example starts from an H2O transition state calculation for an
O1s hole and evaluates four spectra with 2000 points in the energy range (eV)
[530, 600] for a variable (energy dependent) broadening:

  1) a total Xray absorption spectrum, where the absorption is reduced to 50%,
     yielding spectrum file XrayT001.out. The spectrum is also printed.

  2) a polarized Xray absorption spectrum with polarization angle theta = 35,
     phi = 10, yielding spectrum file XrayP002.out. The spectrum is not
     printed.

  3) a polarized Xray absorption spectrum with polarization angle theta = 20,
     phi = 75, where the absorption is enhanced to 200%, yielding spectrum
     file XrayP003.out. The spectrum is also printed.

  4) an angle-resolved Xray absorption spectrum with incident angle theta = 10,
     phi = 55, yielding spectrum file XrayA004.out. The spectrum is also
     printed.

        &gt;TITLE
        &gt;H2O O1s -&gt; virt  Xray absorption spectrum
        &gt;RANGE 530 600
        &gt;POINTS 2000
        &gt;WIDTH 0.2 2.5 544.09 554.09
        &gt;PRINT
        &gt;XRAY XAS
        &gt;TOTAL
        &gt;SCALE .5
        &gt;POLAR  35 10
        &gt;NOPRINT
        &gt;POLAR  20 75
        &gt;SCALE 2
        &gt;ANGLE   10 55
        &gt;END


The spectrum output files (XrayTnnn.out, XrayAnnn.out, XrayPnnn.out, nnn = 001,
002, ...) are ASCII type and of the general format

Lines 1 ... N   (F20.8,D20.8)   E(I),SPEC(I), I=1, ... N

               E(I)      energy inside the spectrum range (in eV)
               SPEC(I)   intensity/absorption for energy E(I)

where N denotes the number of energies requested for the spectrum.



<a name="2.7.7."><b>2.7.7.</a>  TOTAL/ANGLE-RESOLVED INFRARED SPECTRA (IRSPEC)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

Utility irspec (executable irspec.x) allows you to use output files from StoBe
runs (see <a href="#e.11)">e.11)</a> to generate total and angle-resolved vibrational (infrared, IR)
spectra for graphical output or for further processing. The spectra include
gaussian broadening where the broadening width (FWHM) can be chosen freely.
Angle-resolved spectra can be computed for any polarization direction or
incident/exit beam given by polar angles theta, phi. Further, filters may be
applied to extract spectra of specific types or mixtures of vibrational
symmetry modes.

File output of spectra consists of array listings combining each vibrational
excitation energy with the corresponding intensity (given in a.u.). Each
spectrum is saved in a separate file IrTnnn.out (for total spectra), IrAnnn.out
(angle-resolved spectra), or IrPnnn.out (polarization- resolved spectra) where
'nnn' is a 3-digit number (padded with leading zeros id needed) counting the
sequence of spectra defined by the input. For example, the second total
spectrum file is named IrT002.out. The spectra listings can also be printed,
see option PRINt below.

The utility requires input (unit 1) from StoBe runs (StoBe output unit 65,
created by option RUNType VIBTations) as well as ASCII input (unit 5)
consisting of a series of keywords analogous to the original StoBe input and
described in the following. The keyword input has to be finished by a line
reading 'END'.


-----------------------------------------------------------------------------
 1)  TITLe
-----------------------------------------------------------------------------

Brief descriptive title of the present irspec run on the line following the
keyword. This title appears in the output file(s).

Example:

     &gt;TITLE
     &gt;H2O vibrational (IR) spectrum


-----------------------------------------------------------------------------
 2)  TOTAlspectrum
-----------------------------------------------------------------------------

This spectrum keyword initializes the evaluation of a total (angle-averaged
and unpolarized) IR spectrum using data from a previous StoBe run.

The spectral weight of each vibrational excitation is given by

         W(i) = 2/3*f * E(i) * (Dx**2 + Dy**2 + Dz**2)

where D(i) = (Dx, Dy, Dz) are dynamical dipole moments of excitations i, E(i)
is the excitation energy, and f (= 1.0) is an empirical scaling factor.

The StoBe vibrational spectrum file (output unit 65) is used for input (as file
unit 1). Corresponding spectrum parameters (keywords SYMFilter, RANGe, POINts,
WIDTh, PRINt, SCALe, OFFSet), if different from default values, have to be
given immediately after the keyword line. Output files are named IrTnnn.out
where nnn = 001, 002, ...

Example:

     &gt;TOTAL


-----------------------------------------------------------------------------
 3)  ANGLeresolvedspectrum  theta  phi

     ANGLeresolvedspectrum  xx  yy  zz               (alternative format)
-----------------------------------------------------------------------------

This keyword initializes the evaluation of an angle-resolved IR spectrum using
data from a previous StoBe run. The spectrum refers to a given direction of the
incident/exciting light beam where the absorption is an average over all
possible polarization vectors perpendicular to the beam direction e given by

        e = ( sin(theta)*cos(phi), sin(theta)*sin(phi), cos(theta) ) .

Here theta, phi (in degrees) are correponding polar and azimuthal angles. The
alternative input uses a vector R = (xx, yy, zz) which is converted to angles
theta, phi according to

        R = |R| ( sin(theta)*cos(phi), sin(theta)*sin(phi), cos(theta) ) .

The spectral weight of each vibrational excitation is given by

         W(i) = f * E(i) * 1/2 [  (Dx**2 + Dy**2 + Dz**2)
                                - (Dx*ex + Dy*ey + Dz*ez)**2 ]

where D(i) = (Dx, Dy, Dz) are dynamical dipole moments of excitations i, E(i)
is the excitation energy, and f (= 1.0) is an empirical scaling factor.

The StoBe vibrational spectrum file (output unit 65) is used for input (as file
unit 1). Corresponding spectrum parameters (keywords SYMFilter, RANGe, POINts,
WIDTh, PRINt, SCALe, OFFSet), if different from default values, have to be
given immediately after the keyword line. Output files are named IrAnnn.out
where nnn = 001, 002, ...

Examples:

     &gt;ANGLE  50 20
     &gt;ANGLE  1. 1. 0.


-----------------------------------------------------------------------------
 4)  POLArizedspectrum  theta  phi

     POLArizedspectrum  xx  yy  zz               (alternative format)
-----------------------------------------------------------------------------

This keyword initializes the evaluation of an polarization-resolved IR spectrum
using data from a previous StoBe run. The spectrum refers to a given direction
of the polarization vector of the incident/exciting light. The polarization
direction is defined by two angles, theta, phi of a direction vector e with
(angles in degrees)

        e = ( sin(theta)*cos(phi), sin(theta)*sin(phi), cos(theta) )

where theta, phi (in degrees) are correponding polar and azimuthal angles. The
spectrum can be averaged over all angles theta for given phi or phi for given
theta by using keyword 'AVG' instead of an explict numerical value for the
angles, see example below.

The alternative input uses a vector R = (xx, yy, zz) which is converted to
angles theta, phi according to

        R = |R| ( sin(theta)*cos(phi), sin(theta)*sin(phi), cos(theta) ) .

Note that with this input format angle averaging is not available.

The spectral weight of each vibrational excitation is given by

         W(i) = f * E(i) * (Dx*ex + Dy*ey + Dz*ez)**2

where D(i) = (Dx, Dy, Dz) are dynamical dipole moments of excitations i, E(i)
is the excitation energy, and f (= 1.0) is an empirical scaling factor.

The StoBe vibrational spectrum file (output unit 65) is used for input (as file
unit 1). Corresponding spectrum parameters (keywords SYMFilter, RANGe, POINts,
WIDTh, PRINt, SCALe, OFFSet), if different from default values, have to be
given immediately after the keyword line. Output files are named IrPnnn.out
where nnn = 001, 002, ...

Examples:

     &gt;POLAR   70 10
     &gt;POLAR   AVG 45
     &gt;POLAR   39 AVG
     &gt;POLAR   3. 5. 4.


-----------------------------------------------------------------------------
 5)  SYMFilter  ff1 ff2 ff3 ...
-----------------------------------------------------------------------------

Filter of vibrational levels to be used for the present spectrum calculation.
In the StoBe output file (see <a href="#e.11)">e.11)</a> each vibrational level is characterized by
a symmetry label SYLBL, e.g. nA1u (nA if the system has no symmetry),
describing the its energetical sequence n and the irreducible representation of
the corresponding symemtry group. These lables can be used to select specific
sets of modes for which vibrationional spectra are to be evaluated.

The sequence of ASCII labels ff1, ff2, ff3, ... allows to select vibrational
levels (symmetry filter) for the present spectrum calculation as follows

  - All levels whose symmetry label SYLBL includes the character group given by
    ff1, or by ff2, etc. will be selected. Note that the character comparison
    is not case sensitive.

  - For ffi = 'NONE' no levels will be selected irrespective of the previous
    ffk k &lt; i filters. However, subsequent filters ffk k &gt; i will be evaluated.

  - For ffi = 'ALL' all levels will be selected irrespective of the previous
    ffk k &lt; i filters. Subsequent filters ffk k &gt; i will be ignored.

If this keyword line is omitted the symmetry filter defined for the previous
spectrum of the present run (or a default filter selecting all vibrational
levels if the present spectrum is the first) will be applied.

Examples:

   Assume CO2 with partial D4h symmetry:
     &gt;SYMFILTER  A                (selects all A1g, A2g, A1u, A2u modes)
     &gt;SYMFILTER  eu               (selects all Eu modes)
     &gt;SYMFILTER  a1g eu           (selects all A1g and Eu modes)
     &gt;SYMFILTER  1A1g             (selects only the 1A1g mode)
     &gt;SYMFILTER  all              (all modes: 1Eu, 2Eu, 1A1g, 1A2u)


-----------------------------------------------------------------------------
 5)  RANGe  ebot  etop
-----------------------------------------------------------------------------

Range of energies [ebot, etop] (in cm-1) for which the present spectrum  is to
be evaluated. If this keyword line is omitted the range defined for the
previous spectrum of the present run (or a default range [500.0, 1000.0] if
the present spectrum is the first) will be used.

Example:

     &gt;RANGE  500 2500


-----------------------------------------------------------------------------
 6)  POINts  npts
-----------------------------------------------------------------------------

Number of energies within the range [ebot, etop] for which the present spectrum
is to be evaluated. The energy sequence is equidistant, given by

           e = ebot + (etop-ebot)/(npts-1)*(i-1), i = 1, npts

If this keyword line is omitted the number of energies defined for the previous
spectrum of the present run (or a default value, 1000, if the present spectrum
is the first) will be used.

Example:

     &gt;POINTS 2000


-----------------------------------------------------------------------------
 7)  WIDTh  broad1  [ broad2  ewid1  ewid2 ]
-----------------------------------------------------------------------------

Width (full-width-at-half-maximum, FWHM) (in eV) used for the gaussian
broadening of the present spectrum to be evaluated. The short version uses only
a global broadening of width broad1. The full version uses an energy dependent
broadening where a width broad1 is used for level energies &lt; ewid1, width
broad2 is used for level energies &gt; ewid2 ( &gt; ewid1), and for level energies
between ewid1 and ewid2 a linear interpolation

      broad(E) = broad1 + (broad2-broad1)*(E-ewid1)/ewid2-ewid1)

is applied. If this keyword line is omitted the broadening parameters defined
for the previous spectrum of the present run (or default values, broad1 =
broad2 = 5 cm-1, ewid1 = ewid2= 1.D30, if the present spectrum is the first)
will be used.

Examples:

     &gt;WIDTH 10.0
     &gt;WIDTH 5.0 10.0 1000.0 1200.0


-----------------------------------------------------------------------------
 8)  SCALe  scalfac
-----------------------------------------------------------------------------

Definition of a factor used to scale the present spectrum to be evaluated.
All intensities will be enhanced/reduced by a factor scalfac. If this keyword
line is omitted the scaling factor defined for the previous spectrum of
the present run (or a default value, 1.0 (no scaling), if the present spectrum
is the first) will be used.

Example:

     &gt;SCALE 3.0


-----------------------------------------------------------------------------
 9)  OFFSetenergy  eoffst
-----------------------------------------------------------------------------

Definition of an energy offset (in cm-1) used to shift the present spectrum to
be evaluated. All spectral energies will be shifted by adding the offset
eoffst. If this keyword line is omitted the offset defined for the previous
spectrum of the present run (or a default value, 0.0 cm-1 (no offset), if the
present spectrum is the first) will be used.

Example:

     &gt;OFFSET 100


-----------------------------------------------------------------------------
 10)  PRINt  [ON, OFF]
-----------------------------------------------------------------------------

This keyword includes lists of the spectrum curves in the standard printout in
addition to file output (option ON). If this keyword line is omitted the print
setting defined for the previous spectrum of the present run (or the default
setting (PRINT OFF), if the present spectrum is the first) will be used.

Examples:

     &gt;PRINT ON       includes spectrum listing   (same as line &gt;PRINT)
     &gt;PRINT OFF      omits spectrum listing (but saves spectra to files)


The following example starts from an StoBe calculation of vibrational modes of
a linear CO2 molecule (with its symmetry axis along the z direction) using D4h
symmetry. This yields four non-trivial symmetry modes, 1Eu, 2Eu, 1A1g, 1A2u in
energetic order. In the input below vibrational (IR) spectra are requested for

  1) a total IR absorption spectrum in the range between 500 and 2500 cm-1 with
     2001 energies on an equidistant mesh, a broadening width (FWHM) of 10
     cm-1, and no offset. All intensities are to be increased by 50% and the
     spectrum is to be printed.

  2) a total IR absorption spectrum with parameters as in 1) but selecting only
     the two energetically highest modes 1A1g, 1A2u.

  3) an angle-resolved IR absorption spectrum with parameters as in 1) with
     the beam direction along the molecular axis (z axis) and selecting only
     the two energetically lowest modes 1Eu, 2Eu.

  4) a polarization-resolved IR absorption spectrum with parameters as in 1)
     with the photon polarization direction along the molecular axis (z axis)
     and selecting only the two energetically lowest modes 1Eu, 2Eu.

        &gt;title
        &gt;CO2, D4h symmetry, vibrational (IR) spectrum
        &gt;total
        &gt;range  500 2500
        &gt;points 2001
        &gt;width 10.0
        &gt;scale 1.5
        &gt;offset 0.0
        &gt;print on
        &gt;total
        &gt;symfilter a
        &gt;angle 0 0 1
        &gt;symfilter e
        &gt;pola 0 0 1
        &gt;end


The spectrum output files (IrTnnn.out, IrAnnn.out, IrPnnn.out, nnn = 001, 002,
...) are ASCII type and of the general format

Lines 1 ... N   (F20.8,D20.8)   E(I),SPEC(I), I=1, ... N

               E(I)      energy inside the spectrum range (in cm-1)
               SPEC(I)   intensity/absorption for energy E(I)

where N denotes the number of energies requested for the spectrum.



<a name="2.7.8."><b>2.7.8.</a>  SYMMETRY OPERATIONS (SYMFIND, SYMGEN)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

(A) Utility symfind (executable symfind.x) allows you to identify symmetry
elements (inversion, mirror planes, rotation and roto-reflection axes) and
point symmetry groups (axial and cubic groups only) of a given set of atoms
forming a cluster or molecule.

The calling sequence is

       symfind.x  &lt; infile  &gt; outfile

where ASCII file infile lists the atom coordinates and element names using
format

Line    1
   (I5)          NATOM        number of atoms to be listed in the following
   (F20.10)      ACCU         (optional) tolerance used to determine coinciding
                              atom positions and symmetry elements. Default
                              value is 1.D-5.

  NOTE that inside StoBe this tolerance is set to 1.D-3 (0.529177D-3) for
  coordinate input in atomic (Angstrom) units. Thus, ACCU has to be set
  accordingly to comply with StoBe coordinate input.

Line(s) 2
   (A4)          ELMNT(I)          atom label of center no. I.
   (3F20.10)     X(I),Y(I),Z(I)    cartesian coordinates of atom center no. I.

where NATOM lines 2 appear in the file. The output lists

  - all atom coordinates indicating symmetry non-equivalent atoms by "#"
  - the symmetry center of the cluster/molecule
  - all symmetry elements and corresponding direction vectors
  - angles between mirror plane normals em(i) and rotation axis
    directions er(i)
  - the full point symmetry group name including C1, Ci, Cs,
       axial groups (C%v, D%h (% = infinity), Cn, Cnv, Cnh, Dn, Dnd, Dnh, Sn),
       cubic groups (O, Oh, T, Th, Td), and icosahedral groups (I, Ih)

In addition, a StoBe format list of all non-equivalent atoms is saved on output
unit 4. This file complies with the group definitions in the symmetry library
of StoBe can, thus, be used as a basis to generate a StoBe input file.

Example input file

   &gt;4       1.D-6
   &gt;V   0.000000000    0.000000000    0.000000000
   &gt;V   1.000000000    1.000000000    0.000000000
   &gt;V   1.000000000    0.000000000    1.000000000
   &gt;V   0.000000000    1.000000000    1.000000000

resulting in a output listing

   &gt; ATOM COORDINATES (   4 atoms,    1 inequivalent (#) ) :
   &gt; -------------------------------------------------------------
   &gt;     Atom         x             y             z       ref
   &gt; -------------------------------------------------------------
   &gt;   1) V         0.000000      0.000000      0.000000    1  #
   &gt;   2) V         1.000000      1.000000      0.000000    1
   &gt;   3) V         1.000000      0.000000      1.000000    1
   &gt;   4) V         0.000000      1.000000      1.000000    1
   &gt; -------------------------------------------------------------
   &gt;
   &gt; SYMMETRY CENTER :
   &gt;    Rsym= (    0.500000,     0.500000,     0.500000 )
   &gt;
   &gt; 3-DIM. MOLECULE, SYMMETRY OPERATIONS (accuracy =  1.0000D-06 ):
   &gt;  A)     unit operation
   &gt;  B)     no inversion
   &gt;  C)   6 mirror plane(s) :
   &gt;    1)          n= (  0.707107, -0.707107,   0.000000 ), err.=  3.1402D-16
   &gt;    2)          n= (  0.707107,  0.707107,   0.000000 ), err.=  3.1402D-16
   &gt;    3)          n= (  0.707107,  0.000000,  -0.707107 ), err.=  3.1402D-16
   &gt;    4)          n= (  0.707107,  0.000000,   0.707107 ), err.=  3.1402D-16
   &gt;    5)          n= (  0.000000,  0.707107,  -0.707107 ), err.=  3.1402D-16
   &gt;    6)          n= (  0.000000,  0.707107,   0.707107 ), err.=  3.1402D-16
   &gt;  D)   7 rotation axis(axes) :
   &gt;    1)  3-fold, n= (  0.577350,  0.577350,   0.577350 ), err.=  4.9651D-16
   &gt;    2)  3-fold, n= (  0.577350,  0.577350,  -0.577350 ), err.=  4.9651D-16
   &gt;    3)  3-fold, n= (  0.577350, -0.577350,   0.577350 ), err.=  4.9651D-16
   &gt;    4)  3-fold, n= (  0.577350, -0.577350,  -0.577350 ), err.=  4.9651D-16
   &gt;    5)  2-fold, n= (  1.000000,  0.000000,   0.000000 ), err.=  1.7554D-16
   &gt;    6)  2-fold, n= (  0.000000,  1.000000,   0.000000 ), err.=  1.7554D-16
   &gt;    7)  2-fold, n= (  0.000000,  0.000000,   1.000000 ), err.=  1.7554D-16
   &gt;  E)   3 roto-refl. axis(axes) :
   &gt;    1)  4-fold, n= (  0.000000,  0.000000,   1.000000 ), err.=  2.2204D-16
   &gt;    2)  4-fold, n= (  0.000000,  1.000000,   0.000000 ), err.=  2.2204D-16
   &gt;    3)  4-fold, n= (  1.000000,  0.000000,   0.000000 ), err.=  2.2204D-16
   &gt;
   &gt; ANGLES BETWEEN SYMMETRY AXES
   &gt; Angles em(i)/em(k),  i,k= 1 -  6 :
   &gt;    1    0.0000
   &gt;    2   90.0000    0.0000
   &gt;    3   60.0000   60.0000    0.0000
   &gt;    4   60.0000   60.0000   90.0000    0.0000
   &gt;    5   60.0000   60.0000   60.0000   60.0000    0.0000
   &gt;    6   60.0000   60.0000   60.0000   60.0000   90.0000    0.0000
   &gt; Angles er(i)/er(k),  i,k= 1 -  7 :
   &gt;    1    0.0000
   &gt;    2   70.5288    0.0000
   &gt;    3   70.5288   70.5288    0.0000
   &gt;    4   70.5288   70.5288   70.5288    0.0000
   &gt;    5   54.7356   54.7356   54.7356   54.7356    0.0000
   &gt;    6   54.7356   54.7356   54.7356   54.7356   90.0000    0.0000
   &gt;    7   54.7356   54.7356   54.7356   54.7356   90.0000   90.0000    0.0000
   &gt; Angles em(i)/er(k),  i=1 -  6, k= 1 -  7 :
   &gt;    1   90.0000   90.0000   35.2644   35.2644   45.0000   45.0000   90.0000
   &gt;    2   35.2644   35.2644   90.0000   90.0000   45.0000   45.0000   90.0000
   &gt;    3   90.0000   35.2644   90.0000   35.2644   45.0000   90.0000   45.0000
   &gt;    4   35.2644   90.0000   35.2644   90.0000   45.0000   90.0000   45.0000
   &gt;    5   90.0000   35.2644   35.2644   90.0000   90.0000   45.0000   45.0000
   &gt;    6   35.2644   90.0000   90.0000   35.2644   90.0000   45.0000   45.0000
   &gt;
   &gt; Total of 17 symmetry operations,  order = 24
   &gt;
   &gt; Symmetry group = Td
   &gt;
   &gt; SYMMETRY-ADAPTED COORDINATE SYSTEM
   &gt; Origin at Rsym= (    0.500000,     0.500000,     0.500000 )
   &gt; Unit vectors:
   &gt;    e1= (    1.000000,     0.000000,     0.000000 )
   &gt;    e2= (    0.000000,     1.000000,     0.000000 )
   &gt;    e3= (    0.000000,     0.000000,     1.000000 )
   &gt;
   &gt; Symmetry-adapted atom coordinates
   &gt;   4 atoms,    1 non-equivalent (#) :
   &gt; -------------------------------------------------------------
   &gt;     Atom         x             y             z       ref
   &gt; -------------------------------------------------------------
   &gt;   1) V        -0.500000     -0.500000     -0.500000    1  #
   &gt;   2) V         0.500000      0.500000     -0.500000    1
   &gt;   3) V         0.500000     -0.500000      0.500000    1
   &gt;   4) V        -0.500000      0.500000      0.500000    1
   &gt; -------------------------------------------------------------

and an output file fort.4 reading

   &gt; SYMM TD
   &gt; V       -0.5000000000    -0.5000000000    -0.5000000000    zz   ngrid
   &gt; END


(B) Utility symgen (executable symgen.x) allows you to take a set of atoms and
generate all symmetry equivalents according to a given point symmetry group
completing a cluster or molecule. The symmetrization procedure is also used
inside StoBe to complete a molecule with symmetry. At present, the following 47
point symmetry groups are supported (see also file symbasis):

  C1, CI, CS, CSXZ, CSY, CSYZ, CSX, CSXY, CSZ, S4, S6, C2VB,
  Cn, CnV, CnH, Dn, DnH, DnD, n=2-6,  T, TH, TD, O, OH

This utility requires the symmetry library file to be present as unit 4 in
addition to ASCII file input. The calling sequence is

       symgen.x  &lt; infile  &gt; outfile

where ASCII file infile lists the atom coordinates and element names using
format

Line    1
   (A4)          SYMLAB            label of the symmetry group as given above.

Lines   2
   (A4)          ELMNT(I)          atom label of center no. I.
   (3F20.10)     X(I),Y(I),Z(I)    cartesian coordinates of atom center no. I.

where the atom list is terminated with end-of-file. The output lists the full
set of symmetrized atom coordinates including all atoms where symmetry
non-equivalent atoms (given in the input) are labelled by "#".

Example input file

   &gt;C3V
   &gt;N   0.000000000    0.000000000    0.000000000
   &gt;H   1.801764605    0.000000000    0.705656897

resulting in output

   &gt; Spatial symmetry = C3V
   &gt;
   &gt; INPUT ATOM COORDINATES (   2 non-equivalent atoms ) :
   &gt; -----------------------------------------------------
   &gt;     Atom         x             y             z
   &gt; -----------------------------------------------------
   &gt;   1)   N       0.000000      0.000000      0.000000
   &gt;   2)   H       1.801765      0.000000      0.705657
   &gt; -----------------------------------------------------

   &gt; SYMMETRIZED ATOM COORDINATES (   4 atoms ) :
   &gt; -------------------------------------------------------------
   &gt;     Atom         x             y             z       ref
   &gt; -------------------------------------------------------------
   &gt;   1) N         0.000000      0.000000      0.000000    1  #
   &gt;   2) H         1.801765      0.000000      0.705657    2  #
   &gt;   3) H        -0.900882      1.560374      0.705657    2
   &gt;   4) H        -0.900882     -1.560374      0.705657    2
   &gt; -------------------------------------------------------------



<a name="2.7.9."><b>2.7.9.</a>  COMBINE RESTART FILES (COMBINE)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

This utility allows you to combine restart files of two molecules to yield a
restart file of the compound system. This combined restart file can provide a
very good starting guess for the compound system, in particular, if the
interaction between the components is weak and/or if the second component is
only a small addition to the first. Examples are small molecules attached to
large substrate clusters (e. g. Cu49 + CO --&gt; Cu49CO).

The restart file of the compound system is of short format, see option SHRT,
<a href="#f.12)">f.12)</a> and Sec. 2.5, and is truncated (including only recs. 1-19, see Sec. 2.5).
It can be used as input for single point SCF runs of the compound system as
well as for geometry optimizations (with keyword line RUNT OPT NEWG, see <a href="#c.1)">c.1)</a>)

The utility requires restart files (StoBe output unit 2) of the two component
systems as input (file units 1/2 for the first/second components) while the
restart file of the compound system is saved on file unit 3. Additional ASCII
input (unit 5) consists of a series of keywords analogous to the original StoBe
input and described in the following. The keyword input has to be finished by a
line reading 'END'.


-----------------------------------------------------------------------------
 1)  TITLe
-----------------------------------------------------------------------------

Brief descriptive title of the compound system on the line following the
keyword. This title appears in the output file(s).

Example:

     &gt;TITLE
     &gt;NH3CO: combination of NH3 with CO


-----------------------------------------------------------------------------
 2)  AUXBasissize  nbchs1  nbxcs1  nbchs2  nbxcs2
-----------------------------------------------------------------------------

Number of aux. s basis functions (separate s functions only, of all atoms
including symmetry equivalents) for charge density and XC potential fits
referring to component 1 (nbchs1, nbxcs1) and component 2 (nbchs2, nbxcs2).
These numbers are included with the latest StoBe restart file format (rec. 3,
see Sec. 2.5.) and need not be given explicitly. They are, however, required if
truncated or old format restart files are to be combined. Correct values of
nbchs, nbxcs can be determined from the aux. basis set titles (given by
(ns(CD), ns(XC)) in the StoBe output listing, see also Sec. 2.3

Example:

     &gt;AUXBASIS  16 16  8 8


-----------------------------------------------------------------------------
 3)  ORBBasissize  nnns1  nnnp1  nnnd1  nnns2  nnnp2  nnnd2
-----------------------------------------------------------------------------

Number of orbital basis functions (s, p, d components) referring to component 1
(nnns1, nnnp1, nnnd1) and component 2 (nnns2, nnnp2, nnnd2). These numbers are
included with the latest StoBe restart file format (rec. 25, see Sec. 2.5.) and
need not be given explicitly. They are, however, required if truncated restart
files are to be combined. The StoBe output listing of each molecular component
shows correct values for nnns, nnnp, nnnd.

Example:

     &gt;ORBBASIS  9  2  1  6  4  2


-----------------------------------------------------------------------------
 4)  SHIFt  xs  ys  zs
-----------------------------------------------------------------------------

Cartesian components of vector R = (xs, ys, zs) used to shift the origin of the
second molecular component with respect to that of the first. If (identical)
symmetry is applied to both molecular components the vector shift must not
destroy the symmetry of the compound system. For example, if both components
are of C3v symmetry then only shift vectors (0, 0, z) are allowed.

Example:

     &gt;SHIFT  0.0  0.0  -10.0


NOTE that this utility is still experimental and is not guaranteed to work in
all cases.

  - At present, the restart file of the first molecular component must refer to
    a singlet state.

  - Combinations of components with model potentials have not been testet so
    far.

  - If the molecular components allow for symmetry their symmetry group must be
    identical and the vector shift must not destroy the symmetry of the
    compound system.



<a name="2.7.10."><b>2.7.10.</a>  EXPAND MOLECULAR ORBITALS (EXPAND)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

This utility allows you to expand cluster orbitals of one configuration
(contained in restart file of unit #2) by those of another (restart file of
unit #1) of the same system. Examples are excited configurations where the
orbitals are expanded by ground state orbitals to find out about excitation
induced hybridization. Another example is a compound cluster AB where orbitals
of the separate subunits A, B (after being combined with utility combine, see
Sec. 2.7.8) are projected onto the orbitals of AB.

The utility requires restart files (StoBe output unit #2) of the configuration
whose orbitals are to be expanded (input file file2, unit #2) and of the
restart file containing the expansion orbitals (input file file1, unit #1). The
calling sequence is

       expand.x  &gt; expand.out

where the ASCII file expand.out lists all orbitals of file1 and file2 by their
LCAO basis components as well as those of file2 by their expansion by orbitals
of file1.



<a name="2.7.11."><b>2.7.11.</a>  REMOVE SYMMETRY IN RESTART FILE (DESYMM)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

This utility allows you to reduce the symmetry group used in the restart file
(orbital classification, etc.) of a given system to C1 (no symmetry). The
removal of symmetry can be necessary in calculations of vibrational
excitations, see <a href="#c.1)">c.1)</a>, <a href="#e.11)">e.11)</a>, of the polarizability, see c.1), <a href="#e.6)">e.6)</a>, or in
geometry optimizations where optimization constraints are relaxed. Only binary
restart files are accepted for input and the output files will be binary.

The calling sequence is

       desymm.x  symmfile  nosymmfile

where "symmfile" denotes a complete binary restart file describing the
molecule/cluster using symmetry group X, see 2.4.). This file will be used as
input to generate a new restart file "nosymmfile" describing the system
without using symmetry (the symmetry group will be set to C1) where all
electronic parameters such as multiplicity, occupations etc. will be
maintained. The restart format of file nosymmfile will be short, see <a href="#f.12)">f.12)</a>.
Note that the transformation affects only records no. 2, 4 - 9, 11, 12, 17 -
19 of the restart file, see section 2.5.



<a name="2.7.12."><b>2.7.12.</a>  GENERATE POINT CHARGE SETS (LATSPH, PCFILT)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

Utility LATSPH calculates coordinates of all atom centers in a 3-dim. lattice
(defined by lattice vectors and lattice basis vectors with atom charges) which
lie inside a sphere of given center and radius. In addition, a planar
constraint may be imposed to include only those centers which lie below a plane
of given normal direction and distance from the sphere center.

This utility can be used to generate a point charge environment about a cluster
based on a crystal lattice in studies where surface or bulk clusters with a
point charge embedding are considered, see also option <a href="#c.14)">c.14)</a>. Lattice centers
which coincide with cluster centers can be identified and removed from the list
of lattice centers with utility PCFILT, see below.

All calculated centers (ordered according to distance from sphere origin) are
output on unit

   unit # 1   in a format ready to be used as an external file for point charge
              input to StoBe, see keywords 'FILE' and 'FIL&' of option <a href="#c.14)">c.14)</a>.
              Here cordinates are given in absolute units of the lattice.

   unit # 2   in a format ready to be used as an external file for point charge
              input to StoBe, see keywords 'FILE' and 'FIL&' of option <a href="#c.14)">c.14)</a>.
              Here cordinates are given with respect to the sphere center.

   unit # 3   in PLOT3D type format, see BALSAC manual at
              http://www.fhi-berlin.mpg.de/KHsoftware/Balsac/index.html.

   unit # 4   XYZ type format.

The calling sequence is

       latsph.x  &lt; inputfile

where "inputfile" denotes a valid file describing the lattice input and control
parameters defined by 6 lines given as follows:

Line  1.      (A80)  TITLE

   TITLE    := Title of the LATSPH run.


Lines  2.     (3(3F15.9/))  ((R(I,J),I=1,3),J=1,3)

   R(I,J)   := Lattice vectors (Ith component if Jth vector in cartesian
               coordinates).


Line  3.      (I5)  NBG

   NBG      := The absolute value |NBG| defines the number of lattice basis
               vectors while positive and negative NBG values distinguish
               between absolute and relative vector coordinates, see lines 4.
               For primitive lattices set NBG = 1.


Line(s)  4.   (A4,4F15.9) (ELNM(J),(RBG(I,J),I=1,3),CHG(J),J=1,|NBG|)

   ELNM(J)  := Element name of center J.

   RBG(I,J) := Lattice basis vector Rj of center J.

               NBG &gt; 0 :  lattice basis vectors are given in absolute cartesian
                          coordinates where RBG(I,J) denotes the Ith component
                          of Jth lattice basis vector, J=1,NBG. For primitive
                          lattices set RBG(I,1) = 0.0.

               NBG &lt; 0 :  lattice basis vectors are given by linear
                          combinations of lattice vectors where RBG(I,J)
                          denotes the weight of the Ith lattice vector
                          contributing to the Jth lattice basis vector,
                          J = 1,NBG.

   CHG(J)   := Atom (element) charge of atoms assigned to center J.


Line  5.      (I5,5F15.9) ICENT,(CENT(J),J=1,3),RADMX,EPS,IPLAN

   ICENT    := Index of atom center J = ICENT to act as center of the spherical
               crystal section.

   CENT(J)  := Absolute cartesian coordinates C = (X1, X2, X3) of the
               center of the spherical crystal section.

               ICENT = 0 :  coordinates CENT(J) are used for the section
                            center.


               0 &lt; ICENT &lt;= |NBG| :
                            coordinates CENT(J) are ignored and replaced by
                            those of center ICENT (given above) defining the
                            section center.

   RADMX    := Radius of the center of the spherical crystal section.

   EPS      := Accuracy to define atom shells (determined internally) about the
               sphere center.

   IPLAN    := Flag to set additional planar constraint, see line 6.

               = 0      no additional planar constraint. Without planar
                        constraint all atom centers enclosed by the sphere
                        about center CENT(J) and of radius RADMX are calculated
                        and saved on an output file.

               &gt; 0      additional planar constraint defined by line 6.


Line 6 is required only for IPLAN &gt; 0, see above.

Line  6.      (4F15.9) (PLAN(J),J=1,3),DPLAN

   PLAN(J)  := Absolute cartesian coordinates P = (X(1), X(2), X(3)) of the
               plane normal vector used for lattice building with a planar
               constraint, see below. Vector P does not need to be normalized.

   DPLAN    := Pseudo-distance D of plane from sphere center to confine lattice
               building, see below.

With a planar constraint only those atom centers of the sphere are calculated
which are below the plane of plane normal PLAN(J) at a distance |DPLAN| of the
plane from the sphere center. The mathematical condition for an atom center to
be included is

       (Rj - C)(P/|P|) &lt;= D

where Rj is the position vector of atom center j, C is the position vector of
the sphere center, P is the plane normal vector, and D denotes the
pseudo-distance. Note that D can assume both positive and negative values.


As an example we list below an input file for the quasi-rhombohedral (0001)
oriented V2O3 crystal

================= input starts ==============================================
V2O3 quasi-rhombohedral (0001) oriented, Angstrom units
    2.852449000    0.000000000    4.655656000
   -1.426225000    2.470209400    4.655656000
   -1.426225000   -2.470209400    4.655656000
  -10
V        .346300000     .346300000     .346300000    3.000000000
V        .653700000     .653700000     .653700000    3.000000000
V        .846300000     .846300000     .846300000    3.000000000
V        .153700000     .153700000     .153700000    3.000000000
O        .565000000     .935000000     .250000000   -2.000000000
O        .935000000     .250000000     .565000000   -2.000000000
O        .250000000     .565000000     .935000000   -2.000000000
O        .435000000     .065000000     .750000000   -2.000000000
O        .065000000     .750000000     .435000000   -2.000000000
O        .750000000     .435000000     .065000000   -2.000000000
   1     .000000000     .000000000     .000000000   11.000000000   .01   1
         .000000000     .000000000    1.000000000     .800000000
================= input ends ================================================


In many cases the list of lattice centers has to be reduced by removing atom
centers which appear in a cluster (whose electronic structure is evaluated with
StoBe) and coincide with lattice centers. This is possible using utility
PCFILT. This utility reads a list of lattice centers generated by LATSPH as
well as a list of cluster atom centers. By comparing the two lists coinciding
centers (defined by inter-atomic distances &lt; 1.D-8) are removed and a reduced
list of lattice centers is produced.

The following input/output files are required

   unit # 1   (input) list of lattice centers (cartesian coordinates, charges)
              generated by latsph (latsph output units # 1, 2) or using the
              corresponding ASCII file format given by

                 Line  1.      (I10,A)  NPTC, TITLEL

                    NPTC        := Number of lattice centers.

                    TITLEL      := (optional title of the lattice center list.

                 Lines 2.      (4F15.9)  X(I), Y(I), Z(I), Q(I), I = 1, NPTC

                    X(I),Y(I),  := Cartesian coordinates of lattice center I.
                         Z(I)

                    Q(I)        := Atom charge of lattice center I.

   unit # 2   (input) list of cluster centers (cartesian coordinates, charges)
              in Plot3D format (see balsac manual at
              http://www.fhi-berlin.mpg.de/KHsoftware/Balsac/index.html) or
              using the corresponding ASCII file format given by

                 Line  1.      (A)  TITLEC

                    TITLEC      := Title of the cluster (can be an empty line).

                 Line  2.      (I5) NKTOT

                    NKTOT       := Number of cluster centers.

                 Lines 3.      (4F15.9)  (X(I), Y(I), Z(I), R(I), Q(I)),
                                          I = 1, NKTOT

                    X(I),Y(I),  := Cartesian coordinates of cluster center I.
                         Z(I)

                    RAD(I)      := Atom radius of cluster center I (can be
                                   zero).

                    Q(I)        := Atom charge of cluster center I.

   unit # 3   (output) list of lattice centers (cartesian coordinates, charges)
              of the input list on unit # 1 (using the same ASCII format)
              reduced by those coinciding with cluster centers of unit # 2. The
              removed cluster centers are added at the end of the list on unit
              # 3. If not all cluster centers coincided with lattice centers a
              warning will be issued.


The calling sequence is

       pcfilt.x

where input files on units # 1, 2 have to be provided with the call.



<a name="2.7.13."><b>2.7.13.</a>  LINEAR PATHS BETWEEN IMAGES (LINPATH)</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

Utility LINPATH calculates coordinates of all atom centers in a cluster along
a linear path connecting a set of Nini initial geometric structures (initial
images, up to 100) and generates a final set of Nfin &lt; 1000 images. These
images refer to a linear interpolation between initial images on an
equidistant distance along the path where a 3n-dimensional Cartesian length (n
denotes the number of cluster atoms) is used as a measure.

Atom coordinates of the initial images are provided by single- or multi-image
StoBe files, see also <a href="#a.1)">a.1)</a>, and the final interpolation images can be saved
both as single- or multi-image StoBe files for subsequent StoBe runs. The
interpolation files can be used for multi-image SCF calculations or as a first
step of a nudged-elastic-band (NEB) optimization. The algorithm is used also
inside StoBe if a NEB optimization is started from scratch, see <a href="#c.1)">c.1)</a> and
<a href="#e.12)">e.12)</a>.

Utility LINPATH can also be used to generate a set of Nfin image files by
linear interpolation from a set of Nini initial image files where both input
and output files are of Balsac or XYZ format.

The utility requires either a set of Nini StoBe restart files (single-image
type) or a multi-image restart file, or Nini Balsac or XYZ format files
describing all Nini images. The output file format is always identical to that
of the input files.

Additional ASCII input (unit 5) consists of a series of keywords analogous to
the original StoBe input and described in the following. The keyword input has
to be finished by a line reading 'END'.

-----------------------------------------------------------------------------
 1)  NINPutimages  Nini
-----------------------------------------------------------------------------

Definition of the number Nini &lt; 1000 of initial images (StoBe single-image,
Balsac, or XYZ format) used for the linear interpolation. If a StoBe
multi-image format file is provided as input, Nini must agree with the number
of images of that file.

Example:

     &gt;NINPUTIMAGES  3      (3 images provided by input file(s))


-----------------------------------------------------------------------------
 2)  NPATh  Nfin
-----------------------------------------------------------------------------

Definition of the number Nfin of final images (StoBe single- or multi-image,
Balsac, or XYZ format) calculated by linear interpolation. The default value
of Nfin is set equal to Nini. Thus final and initial images agree.

Example:

     &gt;NPATH  7             (7 images calculated and saved in output file(s))


-----------------------------------------------------------------------------
 3)  OFFSet  Noffi  Noffo
-----------------------------------------------------------------------------

Noffi   Definition of the offset used for file unit numbers pointing to the
        initial StoBe restart, Balsac, or XYZ format file(s). For StoBe
        single-image, Balsac, or XYZ format input with Nini images, units Noffi,
        Noffi+1, ... Noffi+Nini-1 have to be assigned to existing StoBe
        restart, Balsac, or XYZ files.

        For StoBe multi-image input unit Noffi has to be assigned to one StoBe
        restart file containing all Nini images.

Noffo   Definition of the offset used for file unit numbers pointing to final
        StoBe restart, Balsac, or XYZ format file(s). For StoBe single-image,
        Balsac, or XYZ format output with Nfin images, units Noffo, Noffo+1,
        ... Noffo+Nfin-1 will be used for file output.

        For StoBe multi-image output, only unit Noffo will be used for file
        output where the StoBe restart file contains all Nfin images. For
        named file output, see keyword FNAMe below, only unit Noffo will be
        used.

Values of Noffi, Noffo must be larger than 10 where default values are
Noffi = 10, Noffo = 100. Unit numbers starting with Noffi and those starting
with Noffo must not overlap.

Example:

     &gt;OFFSET 10 20


-----------------------------------------------------------------------------
 4)  MULTi-image
-----------------------------------------------------------------------------

This keyword defines StoBe multi-image output of the Nfin interpolated images
in one Stobe restart file (unit Noffo). If the keyword is missing (default
setting) the output refers to Nfin different Stobe restart files (units Noffo,
Noffo+1, ... Noffo+Nfin-1). This keyword is ignored for Balsac and XYZ format
file output.

Example:

     &gt;MULTI-IMAGE


-----------------------------------------------------------------------------
 5)  FTYPe  [StoBe, Balsac, XYZ]
-----------------------------------------------------------------------------

Utility LINPATH can calculate sequences of images by linear interpolation
where input and output refer to (multi- and single-image) StoBe,
(single-image) Balsac [H00], and XYZ format files. Balsac output files are
used as input to BALSAC, a visualization and graphical analysis software
[H00]. XYZ format output files are accepted as input to other graphics
software. The present keyword FTYPe defines the corresponding format. The
default format (omitting keyword FTYPe) refers to StoBe restart file handling.

NOTE that input and output files refer always the the same file format.

Examples:

     &gt;FTYPE STOBE           (default if keyword is omitted)
     &gt;ftype Balsac
     &gt;FTYP XYZ


-----------------------------------------------------------------------------
 5)  FNAMe  Ftemplate
-----------------------------------------------------------------------------

Named file output is an an alternative way to define output files. This is
very useful for handling large numbers of interpolation files where file
output on different file units becomes impractical. This output option uses
only output unit Noffo together with explicit file names generated internally
and based on a text template Ftemplate.

The output of Nfin interpolation files will be saved on files

     Ftemplate_001.xxx, Ftemplate_002.xxx, ..., Ftemplate_{Nfin}.xxx

where the numbers 1, 2, ..., Nfin are padded to 3 digits and xxx gives the
file format,

     xxx = stb for (single-image) StoBe format files,
         = plt for Balsac format files,
         = xyz for XYZ format files.

StoBe multi-image output with the named file option saves the interpolation
data on file Ftemplate_000.stb .

Example:

     &gt;FTYPE StoBe
     &gt;FNAME KHout
             (saves files KHout_001.stb, KHout_002.stb, KHout_003.stb, ... )


-----------------------------------------------------------------------------
 6)  PRINt  [NONE, INPUT, OUTPUT, ALL]
-----------------------------------------------------------------------------

This keyword determines whether and which coordinates are included in the
output listing. Option

     NONE     does not list any coordinates but includes headers of each in-
              and output structure file.

     INPUT    lists all coordinates of the input structure files but only
              headers of the output structure files.

     OUTPUT   lists only headers of the input structure files but all
              coordinates of the output structure files.

     ALL      (default setting) lists coordinates of all in- and output
              structure files.



<a name="2.8."><b>2.8.</a>  PROGRAM STRUCTURE AND DIMENSIONS</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The main driver of StoBe is the CRAYCP routine from which all main calls are
performed.

The input is processed in DECODE where also some additional comments on input
options etc may be found.

The SCF procedure is controlled by SCFRUN which in turn calls SCFDOO for the
actual construction and diagonalization of the K-S matrices. The numerical grid
work is handled by DENSTY with allocations done in the control routine CPGRSCF.

Geometry optimization is controlled by DYNNRM.

All relevant dimensions are controlled by parameter statements and separated
from the code in two include files: workvec.h and param.h

workvec.h : gives the size, NDIM, of the requested work area A(NDIM). This
            is used for all dynamical allocations in the program. Two suggested
            sizes are included (small and big). Only included in CRAYCP.

param.h   : gives sizes for a number of different arrays and vectors stored
            in common blocks throughout the program. Two suggested sizes are
            included (small and big). The program will check that the given
            size is sufficient and will inform which parameter needs to be
            increased if necessary. If param.h is modified the entire
            program must be recompiled.



<a name="2.9."><b>2.9.</a>  COMPILATION AND ERROR HANDLING</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The executables (StoBe.x and the different utility programs) are generated by
running the Makefile located in the appropriate directories (Source,
Utilities). Compilation commands for a number of systems are included, but not
guaranteed to work (systems tested include DEC Alpha and IBM RS, SUN, SGI).

Below are a few hints concerning the compilation on Compaq Alpha workstations
running True64unix.

     The subroutine tag.f causes errors when the compiler optimization level O3
     is used. Compile separately using

          &gt;f77 -r8 -O1 -c tag.f

     before the overall make (as included in the Makefile).

     The executable that is generated tends to be quite big and requires
     substantial (virtual) memory. For interactive runs use the command

          &gt;unlimit

     to increase the allowed heap. Otherwise an error similar to that below can
     occur:

          29625:../Source/StoBe.x: /sbin/loader:
          Fatal Error: set_program_attributes failed to set heap start



<a name="3."><b>3.</a>  BIBLIOGRAPHY</b>   (Goto <a href="#toc">TOC</a>, <a href="#2.1.1.1.">KEYW</a>, <a href="#2.1.1.2.">KEYA</a>)

The following bibliography is rather incomplete and is given in alphabetical
order.

[A92]     A. St-Amant, Ph.D. Thesis Universit'e de Montreal, 1992.

[B86]     A. D. Becke, J. Chem. Phys. 84 (1986) 4524.

[B86a]    A. D. Becke, J. Chem. Phys. 85 (1986) 7184.

[B95]     R. F. W. Bader, "ATOMS IN MOLECULES, A Quantum Theory", Intern.
          Series of Monographs on Chemistry, Vol. 22, Clarendon Press, Oxford
          1990.

[BE88]    A.D. Becke, Phys. Rev. A 38 (1988) 3098.

[BH72]    U. von Barth and L. Hedin, J. Phys. C 5 (1972) 1629.

[BHB84a]  P.S. Bagus, K. Hermann, and C.W. Bauschlicher, J. Chem. Phys. 80
          (1984) 4378.

[BHB84b]  P.S. Bagus, K. Hermann, and C.W. Bauschlicher, J. Chem. Phys. 81
          (1984) 1966.

[D30]     P. A. M. Dirac, Proc. Cambridge Phil. Soc. 26 (1930) 376.

[D94]     C. Daul, Int. J. Quant. Chem. 52 (1994) 867.

[DD82]    P. Fuentealba, H. Preuss, H. Stoll, L. v. Szentpaly, Chem. Phys.
          Lett. 89 (1982) 418.

[DD87]    M. Dolg, U. Wedig, H. Stoll, H. Preuss, J. Chem. Phys. 86 (1987) 866.

[DD89]    M. Dolg, H. Stoll, A. Savin, H. Preuss, Theor. Chim. Acta 75 (1989)
          173.

[DD90]    D. Andrae, U. Haeussermann, M. Dolg, H. Stoll, H. Preuss, Theor.
          Chim. Acta 77 (1990) 123.

[DD91a]   M. Kaupp, P. v. R. Schleyer, H. Stoll, H. Preuss, J. Chem. Phys. 94
          (1991) 1360.

[DD91b]   M. Dolg, M. Fischer, H. Preuss, A. Alex, T. Clark, J. Chem. Phys. 94
          (1991) 3011.

[DD91c]   W. Kuechle, M. Dolg, H. Stoll, H. Preuss, Mol. Phys. 74 (1991) 1245;
          J. Chem. Phys. 94 (1991) 3011.

[DD93]    A. Bergner, M. Dolg, W. Kuechle, H. Stoll, H. Preuss, Mol. Phys. 80
          (1993) 1431.

[DD95]    A. Nicklass, M. Dolg, H. Stoll, H. Preuss, J. Chem. Phys. (1995) ???

[DD95]    X. Cao, M. Dolg, H. Stoll, J. Chem. Phys. 118 (2003) 487.

[DGS93]   C. Daul, A. Goursot, and D.R. Salahub in "NUMERICAL GRID METHODS AND
          THEIR APPLICATION TO SCHRODINGER'S EQUATION", C. Cerjan, Ed., NATO
          ASI series, vol 412, p. 153, 1993. "Numerical Calculation of
          Multicentre Integrals for Polyatomic Molecules".

[FBH00]   A. Foehlisch, P. Bennich, J. Hasselstroem, O. Karis, A. Nilsson,
          L. Triguero, M. Nyberg and L.G.M Pettersson,
          Phys. Rev. B 61 (2000) 16229.

[Fxx]     R. Fournier, private communication.

[GDZ86]   J. N. Gex, C. Daul, A. von Zelewsky, Chem. Phys. Lett. 132 (1986) 276.

[GL76]    O. Gunnarsson and x. Lundqvist, Phys. Rev. B 13 (1976) 4274.

[GSA92]   N. Godbout, D.R. Salahub, J. Andzelm and E. Wimmer, Can. J. Chem.
          v.70, p.560 (1992).

[H00]     BALSAC (Build and Analyze Lattices, Surfaces, and Clusters), software
          package by K. Hermann, distributed by  Garching Innovation GmbH,
          Munich (Germany), see also
          http://www.fhi-berlin.mpg.de/KHsoftware/Balsac/index.html.

[H03]     T. Heine, 2003, private communication.

[HHN99]   B. Hammer, L. B. Hansen, and J. K. Norskov,  Phys. Rev. B 59 (1999)
          7413.

[HL71]    L. Hedin and B. Lundqvist, J. Phys. C 2064 (1971). ???

[HUJ00]   G. Henkelman, B. P. Uberuaga, and H. Jonsson, J. Chem. Phys. 113
          (2000) 9901.

[JMJ98]   H. Jonsson, G. Mills, and K. W. Jacobson, Nudged elastic band method
          for finding minimum energy paths and transitions, in Classical and
          Quantum Dynamics in Condensed Phase Simulations, edited by B. J.
          Berne, G. Ciccotti, and D. F. Coker (World Scientific Publishing
          Company, 1998).

[KH01]    A. Koester, T. Heine, 2001, unpublished.

[KLS96]   A. M. Koester, M. Leboeuf and D. R. Salahub in "MOLECULAR
          ELECTROSTATIC POTENTIALS: CONCEPTS AND APPLICATIONS", Ed. J. S.
          Murray and K. Sen, Theor. and Comp. Chem., Vol. 3, (Elsevier,
          Amsterdam, 1996), p. 105.

[KPP01]   C. Kolczewski, R. Puettner, O. Plashkevych, H. Agren,
          V. Staemmler, M. Martins, G. Snell, M. Sant'anna, G. Kaindl
          and L.G.M. Pettersson, J. Chem. Phys. 115 (2001) 6426.

[L75]     V. I. Lebedev, Zh. Vychisl. Mat. Fiz. 15 (1975) 48.

[MJ94]    G. Mills and H. Jonsson, Phys. Rev. Lett. 72 (1994) 1124.

[MJG95]   G. Mills, H. Jonsson, and G. K. Schenter, Surf. Sci. 324 (1995) 305.

[MOD03]   The interactive graphics package Molden can be downloaded from the
          web at http://www.cmbi.kun.nl/~schaft/molden/molden.html.

[MOL03]   The interactive graphics package Molekel can be downloaded from the
          web at http://www.cscs.ch/molekel.

[P82]     P. Pulay, J. Comp. Chem. 3 (1982) 556.

[P86]     J.P. Perdew, Phys. Rev. B 33 (1986) 8822.

[P91]     J. P. Perdew, in "Electronic Structure of Solids '91", edited by
          P. Ziesche and H. Eschrig (Akademie Verlag, 1991), p. 11;
          J. P. Perdew, J. A. Chevary, S. H. Vosko, K. A. Jackson, M. R.
          Pederson, D. J. Singh, and C. Fiolhais, Phys. Rev. B 46 (1992) 6671.

[PAK00]   O. Plashkevych, H. Agren, L. Karlsson and L.G.M. Pettersson,
          J. Electron Spec. Rel. Phen. 106 (2000) 51.

[PBE96]   J. P. Perdew, K. Burke, M. Ernzerhof, Phys. Rev. Lett 77 (1996)
          3865.

[PRV95]   E.I. Proynov, E.Ruiz, A. Vela, and D.R. Salahub, Int. J. Quant.
          Chem. Symp. 29 (1995) 61.

[PVS94]   E.I. Proynov, A. Vela, and D.R. Salahub, Phys. Rev. A 50 (1994) 3766.

[PW86]    J.P. Perdew and Y. Wang, Phys. Rev. B 33 (1986) 8800.

[PW91]    J. P. Perdew and Y. Wang, Phys. Rev. B 45, 13244 (1992).

[PWG87]   L.G.M. Pettersson, U. Wahlgren and O. Gropen, J. Chem. Phys. 86
          (1987) 2176.

[PY84]    R. G. Parr and W. Yang, J. Am. Chem. Soc. 106 (1984) 4049.

[PY89]    R. G. Parr and W. Yang, "DENSITY FUNCTIONAL THEORY OF ATOMS AND
          MOLECULES", Oxford University Press, New York 1989.

[S95]     A. Savin, in RECENT ADVANCES IN DENSITY FUNCTIONAL METHODS, PART I,
          D.P. Chong, Ed. (World Scientific, Singapore, 1995), p. 129.
          "Beyond the Kohn-Sham Determinant".

[SCF+95]  D.R. Salahub, M.E. Castro, R. Fournier, P. Calaminici, N. Godbout,
          A. Goursot, C. Jamorski, H. Kobayashi, A. Martinez, I. Papai, E.
          Proynov, N. Russo, S. Sirois, J. Ushio, and A. Vela in "THEORETICAL
          AND COMPUTATIONAL APPROACHES TO INTERFACE PHENOMENA", H. Sellers
          and J.T. Golab, Eds. (Plenum Press, New York, 1995), p.187.

[SCP93]   D. R. Salahub, M. E. Castro and E. I. Proynov in "RELATIVISTIC
          AND ELECTRON CORRELATION EFFECTS IN MOLECULES AND SOLIDS", vol.318
          of NATO ASI Series B: Physics, ed. G. L. Malli (Plenum Press, New
          York, 1994), p.411. "Principles and Applications of DFT".

[TLP99]   L. Triguero, Y. Luo, L.G.M. Pettersson, H. Agren, P. Vaeterlein,
          M. Weinelt, A. Foehlisch, J. Hasselstroem, O. Karis and A. Nilsson,
          Phys. Rev. B 59 (1999) 5189.

[TPA98]   L. Triguero, L.G.M. Pettersson and H. Agren,
          Phys. Rev. B 58 (1998) 8097; J. Phys. Chem. 102 (1998) 10599.

[VWN80]   S.H. Vosko, L. Wilk, and M. Nusair, Can. J. Phys. 58 (1980) 1200.

[VZ88]    L. Versluis and T. Ziegler, J. Chem. Phys. 88 (1988) 322.

[ZY98]    Y. Zhang and W. Yang, Phys. Rev. Lett. 80 (1998) 890; see also
          Perdew, Burke, Ernzerhof, PRL 80 (1998) 891.





</pre>
</body>
</html>
